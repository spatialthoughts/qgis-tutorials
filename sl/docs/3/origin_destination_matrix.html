<!DOCTYPE html>

<html lang="sl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Iskanje najbližjega objekta z matriko izvor-destinacija (QGIS3) &#8212; QGIS Tutorials and Tips</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/translations.js"></script>
    <link rel="search" title="Išči" href="../../search.html" />
    <link rel="next" title="Analiza storitvenih območij z uporabo storitve Openrouteservice (QGIS3)" href="service_area_analysis.html" />
    <link rel="prev" title="Osnove vizualizacije in usmerjanja omrežja (QGIS3)" href="basic_network_analysis.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>


<!-- Cookie Notice -->
<!-- Script from https://github.com/AOEpeople/cookie-notice -->
<script type="text/javascript" src="../../_static/cookie.notice.min.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1WQ7B80XJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B1WQ7B80XJ');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Uvod</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">Ustvarjanje karte (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Delo z atributi (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">Uvoz podatkov preglednic ali datotek CSV (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">Osnovno oblikovanje vektorskih slojev (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">Izračunavanje dolžin in statistike linij (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">Osnovne analize in prikazi rastrov (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Mozaičenje in obrezovanje rastrov (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Delo s podatki o reliefu (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Delo s podatki prek vmesnika WMS (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">Delo s projekcijami (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">Georeferenciranje skeniranih topografskih kart (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">Georeferencing Aerial Imagery (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">Digitalizacija podatkov (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins.html">Združevanje tabel (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">Prostorsko združevanje podatkov (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">Izvajanje prostorskih poizvedb (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Analiza najbližjih sosedov (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Vzorčenje rastrskih podatkov z uporabo točk ali poligonov (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_raster_area.html">Izračun površine rastra (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">Ustvarjanje kart zgostitev (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="animating_time_series.html">Prikazovanje podatkov časovnih vrst (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="handling_invalid_geometries.html">Ravnanje z neveljavnimi geometrijami (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_raster_analysis.html">Advanced Raster Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">Interpolating Point Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_intersection_density.html">Calculating Street Intersection Density (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">Batch Processing using Processing Framework (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">Avtomatizacija zapletenih delovnih postopkov z orodjem Processing Modeler (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">Avtomatizacija ustvarjanja zemljevidov s programom Print Layout Atlas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_criteria_overlay.html">Analiza prekrivanja po več kriterijih (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_network_analysis.html">Osnove vizualizacije in usmerjanja omrežja (QGIS3)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Iskanje najbližjega objekta z matriko izvor-destinacija (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="service_area_analysis.html">Analiza storitvenih območij z uporabo storitve Openrouteservice (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="travel_time_analysis.html">Analiza potovalnega časa z gibanjem Uberja (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="areal_mean_rainfall.html">Calculating Areal Mean Rainfall (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Getting Started With Python Programming (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_algorithms_pyqgis.html">Running Processing Algorithms via Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">Using Custom Python Expression Functions (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">Writing Python Scripts for Processing Framework (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_a_python_plugin.html">Building a Python Plugin (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_plugin.html">Building a Processing Plugin (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_qgis_jobs.html">Running and Scheduling QGIS Processing Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">Web Mapping with QGIS2Web (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_basemaps_with_qtiles.html">Creating Basemaps with QTiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Uporaba vtičnikov (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloading_osm_data.html">Iskanje in prenos podatkov OpenStreetMap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning_resources.html">Učni viri QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Data Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_processing.html">Batch Processing using Processing Framework (QGIS2)</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="basic_network_analysis.html" title="Previous Chapter: Osnove vizualizacije in usmerjanja omrežja (QGIS3)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Osnove vizual...</span>
    </a>
  </li>
  <li>
    <a href="service_area_analysis.html" title="Next Chapter: Analiza storitvenih območij z uporabo storitve Openrouteservice (QGIS3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Analiza stori... &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>
<hr>
<p>Want to learn QGIS in a structured way? Check out <a href="https://spatialthoughts.com/" target="_blank">Spatial Thoughts</a> for more learning materials and instructor-led online programs with QGIS.org certification.</p>


<h4>Change Language</h4>
<form role="form" class="sidebar-form sidebar-left">
<select id="languages" class="form-control select-mini">
  <option value="en">English</option>
  <option value="zh_TW">Chinese (Taiwan)</option>
  <option value="nl">Dutch</option>
  <option value="fi_FI">Finnish</option>
  <option value="fr">French</option>
  <option value="de">German</option>
  <option value="el">Greek</option>
  <option value="id">Indonesian</option>
  <option value="it">Italian</option>
  <option value="ko">Korean</option>
  <option value="fa">Persian</option>
  <option value="pt_BR">Portuguese</option>
  <option value="ro">Romanian</option>
  <option value="ru">Russian</option>
  <option value="sl">Slovenian</option>
  <option value="es">Spanish</option>
  <option value="th">Thai</option>
  <option value="tr">Turkish</option>
  <option value="uk">Ukrainian</option>
  <option value="vi">Vietnamese</option>
</select>
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      

  <section id="locating-nearest-facility-with-origin-destination-matrix-qgis3">
<h1>Iskanje najbližjega objekta z matriko izvor-destinacija (QGIS3)<a class="headerlink" href="#locating-nearest-facility-with-origin-destination-matrix-qgis3" title="Permalink to this heading">¶</a></h1>
<p>V prejšnji vadnici, <a class="reference internal" href="basic_network_analysis.html"><span class="doc">Osnove vizualizacije in usmerjanja omrežja (QGIS3)</span></a>, smo se naučili, kako zgraditi omrežje in izračunati najkrajšo pot med dvema točkama. To tehniko lahko uporabimo pri številnih različnih vrstah analiz, ki temeljijo na omrežju. Ena takih aplikacij je izračun <strong>matrike izvora in destinacije</strong> ali <strong>matrike OD</strong>. Če imamo množico izvornih točk in drugo množico ciljnih točk, lahko izračunamo najkrajšo pot med vsakim parom izvor-cilj in ugotovimo potovalno razdaljo/čas med njima. Takšna analiza je uporabna za iskanje najbližjega objekta do katere koli točke. Logistično podjetje lahko na primer uporabi to analizo za iskanje najbližjega skladišča svojim strankam, da bi optimiziralo dostavne poti. Tukaj uporabljamo algoritem Distance Matrix iz vtičnika <strong>QGIS Network Analysis Toolbox (QNEAT3)</strong> za iskanje najbližje zdravstvene ustanove vsakega naslova v mestu.</p>
<div class="admonition note">
<p class="admonition-title">Opomba</p>
<p>V tej vadnici je prikazano, kako za izračun matrike izvora in destinacije uporabite lastne omrežne podatke. Če nimate lastnih omrežnih podatkov, lahko uporabite <strong>ORS Tools Plugin</strong> in algoritem <span class="menuselection">ORS Tools ‣ Matrix ‣ Matrix from Layers</span> za izvedbo podobne analize z uporabo podatkov OpenStreetMap. Če želite izvedeti, kako uporabljati vtičnik ORS Tools, glejte <a class="reference internal" href="service_area_analysis.html"><span class="doc">Analiza storitvenih območij z uporabo storitve Openrouteservice (QGIS3)</span></a>.</p>
</div>
<section id="overview-of-the-task">
<h2>Pregled naloge<a class="headerlink" href="#overview-of-the-task" title="Permalink to this heading">¶</a></h2>
<p>Vzamemo dva sloja za Washington DC - enega s točkami, ki predstavljajo naslove, in drugega s točkami, ki predstavljajo ustanove za duševno zdravje - in poiščemo ustanovo z najkrajšo potovalno razdaljo od vsakega naslova.</p>
<section id="other-skills-you-will-learn">
<h3>Druga znanja, ki se jih boste naučili<a class="headerlink" href="#other-skills-you-will-learn" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Izbor naključnega vzorca iz točkovnega sloja.</p></li>
<li><p>Uporabite virtualne sloje za izvajanje poizvedbe SQL na sloju QGIS.</p></li>
</ul>
</section>
</section>
<section id="get-the-data">
<h2>Pridobivanje podatkov<a class="headerlink" href="#get-the-data" title="Permalink to this heading">¶</a></h2>
<p>Vlada okrožja Columbia prosto deli na stotine podatkovnih nizov na portalu <a class="reference external" href="https://opendata.dc.gov/">Open Data Catalog</a>.</p>
<p>Prenesite naslednje podatkovne sloje kot shapefile.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://opendata.dc.gov/datasets/roadway-block">Roadway Block</a></p></li>
<li><p><a class="reference external" href="https://opendata.dc.gov/datasets/address-points">Address Points</a></p></li>
<li><p><a class="reference external" href="https://opendata.dc.gov/datasets/adult-mental-health-providers">Adult Mental Health Providers</a></p></li>
</ul>
<p>Zaradi priročnosti lahko kopijo zbirk podatkov neposredno prenesete s spodnjih povezav:</p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/Roadway_Block-shp.zip">Roadway_Block-shp.zip</a></p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/Address_Points.zip">Address_Points.zip</a></p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/Adult_Mental_Health_Providers.zip">Adult_Mental_Health_Providers.zip</a></p>
<p>Vir podatkov: <a class="reference internal" href="../credits.html#dcopendata" id="id1"><span>[DCOPENDATA]</span></a></p>
</section>
<section id="setup">
<h2>Nastavitve<a class="headerlink" href="#setup" title="Permalink to this heading">¶</a></h2>
<p>Obiščite <span class="menuselection">Plugins ‣ Manage and Install plugins</span>. Izberite <span class="guilabel">Vse</span> Poiščite vtičnik <strong>QNEAT3</strong> in ga namestite. Kliknite <span class="guilabel">Close</span>.</p>
<img alt="../../_images/setup11.png" class="align-center" src="../../_images/setup11.png" />
</section>
<section id="procedure">
<h2>Postopek<a class="headerlink" href="#procedure" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Na plošči <span class="guilabel">Browser</span> poiščite preneseno datoteko <code class="docutils literal notranslate"><span class="pre">Roadway_Block-shp.zip</span></code>. Razširite jo in povlecite <code class="docutils literal notranslate"><span class="pre">Roadway_Block.shp</span></code> datoteko na delovno površino. Podobno poiščite datoteko <code class="docutils literal notranslate"><span class="pre">Adult_Mental_Health_Providers.zip</span></code>, razširite jo in jo dodajte na platno (<code class="docutils literal notranslate"><span class="pre">Adult_Mental_Health_Providers.shp</span></code>).</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1101.png" class="align-center" src="../../_images/1101.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Nato poiščite datoteko <code class="docutils literal notranslate"><span class="pre">Address_Points.zip</span></code>, razširite jo in dodajte datoteko <code class="docutils literal notranslate"><span class="pre">Address_Points.shp</span></code>. Po mestu boste videli boste veliko točk. Vsaka točka predstavlja veljavni naslov. Naključno bomo izbrali 1000 točk. Ta tehnika se imenuje naključno vzorčenje. Pojdite v <span class="menuselection">Processing ‣ Toolbox</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/260.png" class="align-center" src="../../_images/260.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Poiščite in najdite algoritem <span class="menuselection">Vector Selection ‣ Random extract</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/335.png" class="align-center" src="../../_images/335.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Izberite <code class="docutils literal notranslate"><span class="pre">Address_Points</span></code> kot <span class="guilabel">Input layer</span>, <code class="docutils literal notranslate"><span class="pre">Number</span> <span class="pre">of</span> <span class="pre">feature</span></code> kot <span class="guilabel">Method</span> in vnesite <code class="docutils literal notranslate"><span class="pre">1000</span></code> v <span class="guilabel">Number/percentage of features</span>. V polju <span class="guilabel">Extracted (random)</span> izberite <code class="docutils literal notranslate"><span class="pre">...</span></code> in kliknite <span class="guilabel">Save to a file</span>. Zdaj izberite imenik in vnesite ime kot <code class="docutils literal notranslate"><span class="pre">address_point_subset.shp</span></code> ter kliknite <span class="guilabel">Run</span></p></li>
</ol>
<blockquote>
<div><img alt="../../_images/415.png" class="align-center" src="../../_images/415.png" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Opomba</p>
<p>Ker bo algoritem iz danega nabora podatkov pridobil 1000 naključnih točk, lahko za ponovitev vaje, tu uporabljenih točk, prenesete datoteko nabora, ki smo jo dobili med izvajanjem algoritma, tukaj <a class="reference external" href="https://www.qgistutorials.com/downloads/address_point_subset.zip">address_point_subset.zip</a> . Po prenosu naložite sloj <code class="docutils literal notranslate"><span class="pre">address_point_subset.shp</span></code> v QGIS.</p>
</div>
<ol class="arabic simple" start="5">
<li><p>Na ploščo <span class="guilabel">Layers</span> bo dodan nov sloj <code class="docutils literal notranslate"><span class="pre">address_point_subset</span></code>, prikaz sloja <code class="docutils literal notranslate"><span class="pre">Address_Points</span></code> naslovnih točk lahko izklopite.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/515.png" class="align-center" src="../../_images/515.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>Z desno tipko miške kliknite na sloj <code class="docutils literal notranslate"><span class="pre">address_point_subset</span></code> in izberite <span class="guilabel">Rename layer</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/615.png" class="align-center" src="../../_images/615.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>Preimenujmo ta sloj v <code class="docutils literal notranslate"><span class="pre">origin_points</span></code>. Podobno preimenujmo plast <code class="docutils literal notranslate"><span class="pre">Adult_Mental_Health_Providers</span></code>, ki predstavlja zdravstvene ustanove, v <code class="docutils literal notranslate"><span class="pre">destination_points</span></code>. Tako poimenovanje slojev olajša njihovo prepoznavanje pri nadaljnji obdelavi.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/714.png" class="align-center" src="../../_images/714.png" />
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>Poiščite algoritem <span class="menuselection">QNEAT3 ‣ Distance matrices ‣ OD Matrix from Layers as Line (m:n)</span>. Če tega algoritma ne vidite v orodjarni, se prepričajte, da ste namestili vtičnik <strong>QNEAT3</strong>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/814.png" class="align-center" src="../../_images/814.png" />
</div></blockquote>
<ol class="arabic simple" start="9">
<li><p>Ta algoritem pomaga poiskati razdalje skupaj z omrežjem med izbranima izvornim in ciljnim slojem. Izberite <code class="docutils literal notranslate"><span class="pre">Roadway_Block</span></code> kot <span class="guilabel">Mrežni sloj</span>. Izberite <code class="docutils literal notranslate"><span class="pre">origin_points</span></code> kot sloj <span class="guilabel">From-Points</span> in <code class="docutils literal notranslate"><span class="pre">OBJECTID_1</span></code> kot polje <span class="guilabel">Unique Point ID</span>. Podobno nastavite <code class="docutils literal notranslate"><span class="pre">destination_points</span></code> kot <span class="guilabel">To-Points Layer</span> in <code class="docutils literal notranslate"><span class="pre">OBJECTID</span></code> kot <span class="guilabel">Unique Point ID field</span>. Nastavite <span class="guilabel">Optimization Criterion</span> kot <code class="docutils literal notranslate"><span class="pre">Shortest</span> <span class="pre">Path</span> <span class="pre">(distance</span> <span class="pre">optimization)</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/914.png" class="align-center" src="../../_images/914.png" />
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>Ker je veliko ulic v omrežju enosmernih, je treba nastaviti <span class="guilabel">Advanced parameters</span> za določitev smeri. Za več podrobnosti o strukturi teh atributov glej <a class="reference internal" href="basic_network_analysis.html"><span class="doc">Osnove vizualizacije in usmerjanja omrežja (QGIS3)</span></a>. Za polje <span class="guilabel">SUMMARYDIR`</span> izberemo <code class="docutils literal notranslate"><span class="pre">SUMMARYDIR</span></code>. Vnesite <code class="docutils literal notranslate"><span class="pre">OB</span></code> kot <span class="guilabel">Value for the forward direction</span>, <code class="docutils literal notranslate"><span class="pre">IB</span></code> kot <span class="guilabel">Value for backward direction</span> in <code class="docutils literal notranslate"><span class="pre">BD</span></code> kot <span class="guilabel">Value for the both direction</span>. Nastavite <span class="guilabel">Topology tolerance</span> kot <code class="docutils literal notranslate"><span class="pre">0,0000150</span></code>. Ostale možnosti pustite na privzetih vrednostih in kliknite <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1021.png" class="align-center" src="../../_images/1021.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>Na ploščo <span class="guilabel">Layers</span> bo dodan nov sloj tabele z imenom <code class="docutils literal notranslate"><span class="pre">Output</span> <span class="pre">OD</span> <span class="pre">Matrix</span></code>. Kliknite z desno tipko miške in izberite <span class="guilabel">Open Attributes Table</span>. Videli boste, da tabela vsebuje <em>13000</em> vrstic. Imeli smo 13 izvornih točk in 1000 ciljnih točk - zato izhodna tabela vsebuje <em>13x1000 = 13000</em> parov izvornih in ciljnih točk. Stolpec <code class="docutils literal notranslate"><span class="pre">total_cost</span></code> vsebuje razdaljo v metrih med vsako izvorno točko in vsako ciljno točko.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1124.png" class="align-center" src="../../_images/1124.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>V tej vadnici nas zanima le ciljna točka z najkrajšo razdaljo. Ustvarimo lahko poizvedbo SQL, s katero med vsemi destinacijami izberemo destinacijo z najmanjšimi <code class="docutils literal notranslate"><span class="pre">skupnimi_stroški</span></code>. Pojdite v <span class="menuselection">Processing ‣ Toolbox</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1222.png" class="align-center" src="../../_images/1222.png" />
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>Poiščite in najdite <span class="menuselection">Vector general ‣ Execute SQL</span>, izberite <code class="docutils literal notranslate"><span class="pre">...</span></code> v <span class="guilabel">Additional input data sources</span> (Dodatni viri vhodnih podatkov), označite <span class="guilabel">Output OD Matrix</span> in kliknite <span class="guilabel">OK</span>. Zdaj kliknite <span class="guilabel">Summation</span> pod <span class="guilabel">SQL query</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1320.png" class="align-center" src="../../_images/1320.png" />
</div></blockquote>
<ol class="arabic simple" start="14">
<li><p>V pogovorno okno <span class="guilabel">SQL query</span> vnesite naslednjo poizvedbo. Kot <span class="guilabel">Geometry field</span> vnesite <code class="docutils literal notranslate"><span class="pre">geometry</span></code> in kot <span class="guilabel">Geometry type`</span> izberite <code class="docutils literal notranslate"><span class="pre">LineString</span></code>. Kliknite <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>select origin_id, destination_id, min(total_cost) as shortest_distance, geometry
from input1 group by origin_id
</pre></div>
</div>
<img alt="../../_images/1418.png" class="align-center" src="../../_images/1418.png" />
</div></blockquote>
<ol class="arabic simple" start="15">
<li><p>Med <span class="guilabel">Layers</span> bo dodan nov virtualni sloj <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Output</span></code>. Ta sloj vsebuje rezultate naše analize. Najbližji center za duševno zdravje odraslih za vsako od 1000 izvornih točk. Preizkusimo več različnih načinov za vizualizacijo in potrditev teh rezultatov.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1516.png" class="align-center" src="../../_images/1516.png" />
</div></blockquote>
<ol class="arabic simple" start="16">
<li><p>Da bi slednje potrdili, sestavimo najkrajšo pot. Točka <em>(OBJECTID_1 = 853046)</em> je vizualno blizu zdravstvenega centra <em>(OBJECTID = 3)</em>, vendar je po poizvedbi SQL povezana z zdravstvenim centrom <em>(OBJECTID = 9)</em>. To potrdimo z ugotavljanjem dejanske razdalje med temi izvori in cilji. Najprej zaženimo algoritem najkrajše poti za prvi par. Poiščite <span class="menuselection">QNEAT3 ‣ Routing ‣ Shortest path (point to point)</span> algoritem in ga zaženite.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1615.png" class="align-center" src="../../_images/1615.png" />
</div></blockquote>
<ol class="arabic simple" start="17">
<li><p>Izberite <code class="docutils literal notranslate"><span class="pre">Roadway_Block</span></code> kot <span class="guilabel">Network Layer`</span>. Izberite začetno in končno točko. Kliknite gumb <span class="guilabel">…</span> poleg <span class="guilabel">Start point</span> in kliknite na začetno točko <em>(OBJECTID_1 = 853046)</em> na delovni površini. Podobno izberite ciljno točko <em>(OBJECTID = 3)</em> kot <span class="guilabel">End point</span>. Ohranite <span class="guilabel">Optimization Criterion</span> kot <code class="docutils literal notranslate"><span class="pre">Shortest</span> <span class="pre">Path</span> <span class="pre">(distance</span> <span class="pre">optimization)</span></code>. Razširite razdelek <span class="guilabel">Advanced parameter</span>. Izberite <code class="docutils literal notranslate"><span class="pre">SUMMARYDIR</span></code> kot polje <span class="guilabel">Direction`</span>. Vnesite <code class="docutils literal notranslate"><span class="pre">OB</span></code> kot <span class="guilabel">Vrednost za smer naprej</span> in <code class="docutils literal notranslate"><span class="pre">IB</span></code> kot <span class="guilabel">Vrednost za smer nazaj</span>. V polje <span class="guilabel">Topology tolerance</span> nastavite <code class="docutils literal notranslate"><span class="pre">0,000015</span></code>. Ostale možnosti pustite na privzetih vrednostih in kliknite <span class="guilabel">Run</span>. Zdaj spremenite ciljno točko <em>(OBJECTID = 9)</em> v polju <span class="guilabel">End point</span> in kliknite <span class="guilabel">Run</span></p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1716.png" class="align-center" src="../../_images/1716.png" />
</div></blockquote>
<ol class="arabic simple" start="18">
<li><p>Med <span class="guilabel">Layers</span> bosta dodana dva nova sloja <code class="docutils literal notranslate"><span class="pre">Shortest</span> <span class="pre">Path</span> <span class="pre">Layer</span></code>. Videli boste, da je ciljna točka <em>(OBJECTID = 9)</em> sicer vizualno blizu izhodiščni točki, vendar je dejanska razdalja v primerjavi s ciljno točko <em>(OBJECTID = 3)</em> daljša.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1814.png" class="align-center" src="../../_images/1814.png" />
</div></blockquote>
<ol class="arabic simple" start="19">
<li><p>Upoštevajte, da čeprav je črta, ki povezuje izvor in cilj, ravna črta, je bil cilj najden s pomočjo razdalje in omrežja. Veliko uporabnejša vizualizacija bo prikaz dejanske najkrajše poti med vsakim izvorom in ciljem. Ne poznamo enostavnega načina za kreiranje najkrajše poti med večimi pari izvor-destinacija na način, kot smo prej ustvarili matriko razdalj. Prikazal pa bom način, kako z uporabo nekaterih skript v Pythonu ustvariti tako vizualizacijo. Najprej zaženimo algoritem najkrajše poti na enem paru. Poiščite <span class="menuselection">QNEAT3 ‣ Routing ‣ Shortest path (point to point)</span> algoritem in ga zaženite.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1912.png" class="align-center" src="../../_images/1912.png" />
</div></blockquote>
<ol class="arabic simple" start="20">
<li><p>V pogovornem oknu <span class="guilabel">Shortest Path (Point to Point)</span> izberite <code class="docutils literal notranslate"><span class="pre">Roadway_Block</span></code> kot <span class="guilabel">Network Layer`</span>. Ohranite <span class="guilabel">Optimization criteria</span> kot Shortest Path (distance optimization). Nato moramo izbrati začetno in končno točko. Kliknite gumb <span class="guilabel">…</span> poleg <span class="guilabel">Start point</span> in kliknite na začetno točko na platnu. Podobno izberemo ciljno točko kot <span class="guilabel">Končna točka</span>. Razširite razdelek <span class="guilabel">Advanced parameter</span>. Izberite <code class="docutils literal notranslate"><span class="pre">SUMMARYDIR</span></code> kot <span class="guilabel">Direction field</span>. Vnesite <code class="docutils literal notranslate"><span class="pre">OB</span></code> kot <span class="guilabel">Vrednost za smer naprej</span> in <code class="docutils literal notranslate"><span class="pre">IB</span></code> kot <span class="guilabel">Vrednost za smer nazaj</span>. V polje <span class="guilabel">Topology tolerance</span> vnesite <code class="docutils literal notranslate"><span class="pre">0,000015</span></code>. Ostale možnosti pustite na privzetih vrednostih in kliknite <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2012.png" class="align-center" src="../../_images/2012.png" />
</div></blockquote>
<ol class="arabic simple" start="21">
<li><p>Med <span class="guilabel">Layers</span> bo dodan nov sloj <code class="docutils literal notranslate"><span class="pre">Shortest</span> <span class="pre">Path</span></code>. Videli boste, da ta pot sledi omrežju in ne povezuje izvora in cilja z ravno črto. Algoritem smo izvedli na enem paru zato, da smo lažje določili vrednosti parametrov, ki jih lahko uporabimo v naši skripti. Izberite sloj <code class="docutils literal notranslate"><span class="pre">Shortest</span> <span class="pre">Path</span></code>, kliknite z desno tipko miške in izberite <span class="guilabel">Remove Layer</span> (Odstrani sloj). Kliknite gumb <span class="guilabel">History</span> v orodjarni <span class="guilabel">Processing Toolbox</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2115.png" class="align-center" src="../../_images/2115.png" />
</div></blockquote>
<ol class="arabic simple" start="22">
<li><p>V pogovornem oknu <span class="guilabel">History</span> (Zgodovina) izberite zadnji ukaz (ukaz, uporabljen za najkrajšo pot). Ta ukaz prikaže vse parametre in njihove vrednosti, ki smo jih uporabili. Zdaj lahko te vrednosti prevzamemo in jih vstavimo v skripto, ki nam lahko omogoči izvajanje ukaza na številnih parih izvor-destinacija. Kliknite <span class="guilabel">Close</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2214.png" class="align-center" src="../../_images/2214.png" />
</div></blockquote>
<ol class="arabic simple" start="23">
<li><p>V orodjarni <span class="guilabel">Processing Toolbox</span> kliknite gumb <span class="guilabel">scripts</span> in izberite <span class="guilabel">Create New script</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2313.png" class="align-center" src="../../_images/2313.png" />
</div></blockquote>
<ol class="arabic simple" start="24">
<li><p>V <span class="guilabel">Processing Script Editor</span> kopirajte/prilepite spodnjo kodo. Datoteko shranite kot <code class="docutils literal notranslate"><span class="pre">get_routes_from_matrix.py</span></code>. Zdaj zaprite <span class="guilabel">Processing Script Editor</span>. Če uporabljate drugačen nabor podatkov, kot je bil uporabljen v tej vadnici boste morali posodobiti skripto z vrednostmi parametrov iz koraka 22.</p></li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">processing</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">QCoreApplication</span>
<span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QgsProcessing</span><span class="p">,</span> <span class="n">QgsProcessingAlgorithm</span><span class="p">,</span> 
    <span class="n">QgsProcessingParameterFeatureSource</span><span class="p">,</span> <span class="n">QgsProcessingParameterFeatureSink</span><span class="p">,</span>
    <span class="n">QgsFeatureSink</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MatrixToRoutes</span><span class="p">(</span><span class="n">QgsProcessingAlgorithm</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creats Routes from Distance Matrix&quot;&quot;&quot;</span>
    <span class="n">NETWORK</span> <span class="o">=</span> <span class="s1">&#39;NETWORK&#39;</span>
    <span class="n">MATRIX</span> <span class="o">=</span> <span class="s1">&#39;MATRIX&#39;</span>
    <span class="n">OUTPUT</span> <span class="o">=</span> <span class="s1">&#39;OUTPUT&#39;</span>

    
    <span class="k">def</span> <span class="nf">initAlgorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addParameter</span><span class="p">(</span>
            <span class="n">QgsProcessingParameterFeatureSource</span><span class="p">(</span>
                <span class="s1">&#39;NETWORK&#39;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s1">&#39;Network Layer&#39;</span><span class="p">),</span>
                <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="n">QgsProcessing</span><span class="o">.</span><span class="n">TypeVectorLine</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">addParameter</span><span class="p">(</span>
            <span class="n">QgsProcessingParameterFeatureSource</span><span class="p">(</span>
                <span class="s1">&#39;MATRIX&#39;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s1">&#39;Distance Matrix Layer&#39;</span><span class="p">),</span>
                <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="n">QgsProcessing</span><span class="o">.</span><span class="n">TypeVectorLine</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">addParameter</span><span class="p">(</span>
            <span class="n">QgsProcessingParameterFeatureSink</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">OUTPUT</span><span class="p">,</span>
                <span class="s1">&#39;Network Routes&#39;</span><span class="p">,</span>
                <span class="n">QgsProcessing</span><span class="o">.</span><span class="n">TypeVectorLine</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">processAlgorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">feedback</span><span class="p">):</span>
        <span class="n">network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterAsString</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NETWORK</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterAsSource</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MATRIX</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        
        <span class="n">sink</span><span class="p">,</span> <span class="n">dest_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterAsSink</span><span class="p">(</span>
            <span class="n">parameters</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OUTPUT</span><span class="p">,</span>
            <span class="n">context</span><span class="p">,</span>
            <span class="n">matrix</span><span class="o">.</span><span class="n">fields</span><span class="p">(),</span>
            <span class="n">matrix</span><span class="o">.</span><span class="n">wkbType</span><span class="p">(),</span>
            <span class="n">matrix</span><span class="o">.</span><span class="n">sourceCrs</span><span class="p">()</span>
            <span class="p">)</span>
        
        <span class="c1"># Compute the number of steps to display within the progress bar and</span>
        <span class="c1"># get features from source</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">/</span> <span class="n">matrix</span><span class="o">.</span><span class="n">featureCount</span><span class="p">()</span> <span class="k">if</span> <span class="n">matrix</span><span class="o">.</span><span class="n">featureCount</span><span class="p">()</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">()</span>
        
        <span class="n">coordinate_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">current</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
            <span class="c1"># Stop the algorithm if cancel button has been clicked</span>
            <span class="k">if</span> <span class="n">feedback</span><span class="o">.</span><span class="n">isCanceled</span><span class="p">():</span>
                <span class="k">break</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">asPolyline</span><span class="p">()</span>
            <span class="n">origin_coords</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
            <span class="n">destination_coords</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>

            <span class="n">feedback</span><span class="o">.</span><span class="n">setProgress</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">current</span> <span class="o">*</span> <span class="n">total</span><span class="p">))</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">network</span><span class="p">,</span>
            <span class="s1">&#39;START_POINT&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">origin_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">origin_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="s1">&#39;END_POINT&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">destination_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">destination_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="s1">&#39;STRATEGY&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;ENTRY_COST_CALCULATION_METHOD&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;DIRECTION_FIELD&#39;</span><span class="p">:</span><span class="s1">&#39;SUMMARYDIR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;VALUE_FORWARD&#39;</span><span class="p">:</span><span class="s1">&#39;OB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;VALUE_BACKWARD&#39;</span><span class="p">:</span><span class="s1">&#39;IB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;VALUE_BOTH&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DEFAULT_DIRECTION&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;SPEED_FIELD&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;DEFAULT_SPEED&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;TOLERANCE&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="s1">&#39;memory:&#39;</span><span class="p">}</span>
            
            <span class="n">route_layer</span> <span class="o">=</span> <span class="n">processing</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;qneat3:shortestpathpointtopoint&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)[</span><span class="s1">&#39;OUTPUT&#39;</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="n">route_layer</span><span class="p">:</span>
                <span class="c1"># We expect only 1 feature in the output, so use next() to get the first item</span>
                <span class="n">route_f</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">route_layer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">())</span>
                <span class="n">output_geom</span> <span class="o">=</span> <span class="n">route_f</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
                <span class="n">f</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">output_geom</span><span class="p">)</span>
                <span class="n">sink</span><span class="o">.</span><span class="n">addFeature</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">QgsFeatureSink</span><span class="o">.</span><span class="n">FastInsert</span><span class="p">)</span>
            <span class="n">feedback</span><span class="o">.</span><span class="n">setProgressText</span><span class="p">(</span><span class="s1">&#39;Processed feature </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>

  
        <span class="k">return</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">OUTPUT</span><span class="p">:</span> <span class="n">sink</span><span class="p">}</span> 

    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;routes_from_matrix&#39;</span>

    <span class="k">def</span> <span class="nf">displayName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s1">&#39;Get Routes from Matrix&#39;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">shortHelpString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s1">&#39;Creates Route Layer from the result of Distance Matrix algorithm&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupId</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">groupId</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s1">&#39;Processing&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">createInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MatrixToRoutes</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/2412.png" class="align-center" src="../../_images/2412.png" />
</div></blockquote>
<ol class="arabic simple" start="25">
<li><p>Sedaj lahko skripto preizkusimo. Izberite nekaj povezav za sloj <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Output</span></code>, za katere želite izračunati dejanske poti. V oknu <span class="guilabel">Processing Toolbox</span> bo dodana nova spustna vrstica <span class="guilabel">Scripts</span>. Kliknite nanjo in izberite <code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Routes</span> <span class="pre">from</span> <span class="pre">Matrix</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2510.png" class="align-center" src="../../_images/2510.png" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Opomba</p>
<p>Ta skripta mora izračunati graf omrežja za vsako iteracijo in je zato precej počasna. Če imate veliko parov izvor-destinacija, lahko to traja dolgo.</p>
</div>
<ol class="arabic simple" start="26">
<li><p>V oknu <span class="guilabel">Network Layer</span> izberite <code class="docutils literal notranslate"><span class="pre">Roadway_Block</span></code> in v oknu <span class="guilabel">Distance Matrix layer</span> izberite <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Output</span></code> ter preverite samo izbrane funkcije. Kliknite <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/269.png" class="align-center" src="../../_images/269.png" />
</div></blockquote>
<ol class="arabic simple" start="27">
<li><p>Med <span class="guilabel">Layers</span> bo dodan nov sloj <code class="docutils literal notranslate"><span class="pre">Network</span> <span class="pre">Routes</span></code>. Ta bo vseboval dejansko pot do cilja.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2710.png" class="align-center" src="../../_images/2710.png" />
</div></blockquote>
</section>
</section>





  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, Ujaval Gandhi.<br/>
      Zadnjič posodobljeno jul. 08, 2023.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.0.1.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/3/origin_destination_matrix.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>