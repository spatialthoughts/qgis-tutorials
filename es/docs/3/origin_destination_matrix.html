<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Localizando la Instalación Más Cercana con Matriz Origen-Destino (QGIS3) &#8212; QGIS Tutorials and Tips</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/translations.js"></script>
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Análisis de Área de Servicio usando Openrouteservice (QGIS3)" href="service_area_analysis.html" />
    <link rel="prev" title="Visualización y Enrutamiento Básico de Red (QGIS3)" href="basic_network_analysis.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>


<!-- Cookie Notice -->
<!-- Script from https://github.com/AOEpeople/cookie-notice -->
<script type="text/javascript" src="../../_static/cookie.notice.min.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1WQ7B80XJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B1WQ7B80XJ');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introducción</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">Haciendo un Mapa (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Trabajando con atributos (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">Importar Hojas de Cálculo o archivos CSV (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">Estilo Básico Vectorial (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">Calcular Longitudes y Estadísticas de Línea (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">Estilos y Análisis Básicos Ráster (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Mosaicar y Recortar Ráster (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Trabajar con Datos de Terreno (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Trabajar con Datos WMS (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">Trabajar con Proyecciones (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">Georeferenciar Hojas Topográficas y Mapas Escaneados (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">Georeferenciar Imágenes Aéreas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">Digitalizar Datos del Mapa (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins.html">Realizar Uniones de Tablas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">Realizar Uniones Espaciales (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">Realizar Consultas Espaciales (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Análisis del Vecino Más Cercano (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Muestrear Datos Ráster usando Puntos o Polígonos (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_raster_area.html">Calculating Raster Area (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">Crear Mapas de Calor (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="animating_time_series.html">Animar Datos de Series de Tiempo (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="handling_invalid_geometries.html">Manejar Geometrías No Válidas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_raster_analysis.html">Análisis Avanzado de Ráster (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">Interpolar Datos Punto (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_intersection_density.html">Calcular Densidad de Intersección de Calle (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">Procesamiento por Lotes usando el Marco de Procesamiento (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">Automatizar Flujos de Trabajo Complejos usando el Modelador de Procesos (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">Automatización de la creación de mapas con el Atlas de diseñador de impresiones  (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_criteria_overlay.html">Análisis de Sobreposición Multicriterio (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_network_analysis.html">Visualización y Enrutamiento Básico de Red (QGIS3)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Localizando la Instalación Más Cercana con Matriz Origen-Destino (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="service_area_analysis.html">Análisis de Área de Servicio usando Openrouteservice (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="travel_time_analysis.html">Análisis del tiempo de viaje con el movimiento de Uber (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="areal_mean_rainfall.html">Calcular la Precipitación Media de Área (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Iniciándote con la Programación Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_algorithms_pyqgis.html">Ejecutar Algoritmos de Procesamiento vía Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">Usando Funciones de Expresión Python Personalizadas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">Escribir Scripts Python para el Marco de Procesamiento (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_a_python_plugin.html">Construyendo un Complemento Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_plugin.html">Construyendo un Complemento de Procesamiento (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_qgis_jobs.html">Ejecutar y Programar Trabajos de Procesamiento QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">Mapeo Web con QGIS2Web (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_basemaps_with_qtiles.html">Creando Mapas Base con QTiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Usar Complementos (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloading_osm_data.html">Buscando y descargando datos de OpenStreetMap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning_resources.html">Recursos de Aprendizaje QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Créditos de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_processing.html">Procesamiento por Lotes usando el Marco de Procesamiento (QGIS2)</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="basic_network_analysis.html" title="Previous Chapter: Visualización y Enrutamiento Básico de Red (QGIS3)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Visualización...</span>
    </a>
  </li>
  <li>
    <a href="service_area_analysis.html" title="Next Chapter: Análisis de Área de Servicio usando Openrouteservice (QGIS3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Análisis de Á... &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>
<hr>
<p>Want to learn QGIS in a structured way? Check out <a href="https://spatialthoughts.com/" target="_blank">Spatial Thoughts</a> for more learning materials and instructor-led online programs with QGIS.org certification.</p>

<hr>
<p>These tutorials are also available in many other languages. Please see <a href="https://www.qgistutorials.com/en/docs/introduction.html#translations" target="_blank">translations</a> page.
</p>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      

  <section id="locating-nearest-facility-with-origin-destination-matrix-qgis3">
<h1>Localizando la Instalación Más Cercana con Matriz Origen-Destino (QGIS3)<a class="headerlink" href="#locating-nearest-facility-with-origin-destination-matrix-qgis3" title="Enlace permanente a este encabezado">¶</a></h1>
<p>En el tutorial previo, <a class="reference internal" href="basic_network_analysis.html"><span class="doc">Visualización y Enrutamiento Básico de Red (QGIS3)</span></a>, aprendimos como construir una red y calcular la ruta más corta entre 2 puntos. Podemos aplicar esa técnica para varios tipos diferentes de análisis basado en red. Una de esas aplicaciones es el cálculo <strong>Matriz Origen-Destino</strong> o <strong>Matriz OD</strong>. Dado un conjunto de puntos de origen y otro conjunto de puntos destino, podemos calcular la ruta más corta entre cada par de origen-destino y averiguar la distancia/tiempo de viaje entre ellos. Tal análisis es útil para ubicar la instalación más cercana a un punto dado. Por ejemplo, la empresa de logística puede usar este análisis para encontrar el almacen más cercano a sus clientes para optimizar las rutas de entrega. Aquí usaremos el algoritmo Matriz de Distancia del complemento <strong>QGIS Network Analysis Toolbox (QNEAT3)</strong> para encontrar la instalación de salud más cercana a cada dirección en la ciudad.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Este tutorial muestra como usar tus propios datos de red para calcular una matriz origen-destino. Si no tienes tus propios datos de red, puedes usar <strong>Complemento ORS Tools</strong> y el algoritmo <span class="menuselection">ORS Tools ‣ Matriz ‣ Matriz desde Capas</span> para hacer el análisis similar usando datos OpenStreetMap. Vea  <a class="reference internal" href="service_area_analysis.html"><span class="doc">Análisis de Área de Servicio usando Openrouteservice (QGIS3)</span></a> para aprender como usar el complemento ORS Tools.</p>
</div>
<section id="overview-of-the-task">
<h2>Vista general de la tarea<a class="headerlink" href="#overview-of-the-task" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Tomaremos 2 capas para Washington DC - una con puntos que representan direcciones y otra con puntos que representan instalaciones de salud mental - y averiguaremos la instalación con la menor distancia de viaje para cada dirección.</p>
<section id="other-skills-you-will-learn">
<h3>Otras habilidades que aprenderá<a class="headerlink" href="#other-skills-you-will-learn" title="Enlace permanente a este encabezado">¶</a></h3>
<ul class="simple">
<li><p>Extraer una muestra aleatoria de una capa punto.</p></li>
<li><p>Usar Capas Virtuales para ejecutar una consulta SQL en una capa QGIS.</p></li>
</ul>
</section>
</section>
<section id="get-the-data">
<h2>Obtener los datos<a class="headerlink" href="#get-the-data" title="Enlace permanente a este encabezado">¶</a></h2>
<p>El gobierno del Distrito de Columbia comparte libremente cientos de conjuntos de datos en el <a class="reference external" href="https://opendata.dc.gov/">Catálogo de Datos Abiertos</a>.</p>
<p>Descargue las siguientes capas de datos como archivos shape.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://opendata.dc.gov/datasets/roadway-block">Roadway Block</a></p></li>
<li><p><a class="reference external" href="https://opendata.dc.gov/datasets/address-points">Puntos de Direcciones</a></p></li>
<li><p><a class="reference external" href="https://opendata.dc.gov/datasets/adult-mental-health-providers">Proveedores de Salud Mental para Adultos</a></p></li>
</ul>
<p>Para su comodidad, puede descargar directamente una copia de los conjuntos de datos de los enlaces abajo:</p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/Roadway_Block-shp.zip">Roadway_Block-shp.zip</a></p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/Address_Points.zip">Address_Points.zip</a></p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/Adult_Mental_Health_Providers.zip">Adult_Mental_Health_Providers.zip</a></p>
<p>Fuente de Datos: <a class="reference internal" href="../credits.html#dcopendata" id="id1"><span>[DCOPENDATA]</span></a></p>
</section>
<section id="setup">
<h2>Configuración<a class="headerlink" href="#setup" title="Enlace permanente a este encabezado">¶</a></h2>
<p>Visite <span class="menuselection">Complementos ‣ Administrar e Instalar complementos</span>. Seleccione :guilabel:` Todos` Busque el complemento <strong>QNEAT3</strong> e instálelo. Clic en <span class="guilabel">Cerrar</span>.</p>
<img alt="../../_images/setup11.png" class="align-center" src="../../_images/setup11.png" />
</section>
<section id="procedure">
<h2>Procedimiento<a class="headerlink" href="#procedure" title="Enlace permanente a este encabezado">¶</a></h2>
<ol class="arabic simple">
<li><p>Localice el archivo descargado <code class="docutils literal notranslate"><span class="pre">Roadway_Block-shp.zip</span></code> en el panel <span class="guilabel">Explorador</span>. Expándalo y arrastre el archivo <code class="docutils literal notranslate"><span class="pre">Roadway_Block.shp</span></code> al lienzo. De forma similar, localice el archivo <code class="docutils literal notranslate"><span class="pre">Adult_Mental_Health_Providers.zip</span></code>, expándalo y agregue <code class="docutils literal notranslate"><span class="pre">Adult_Mental_Health_Providers.shp</span></code> al lienzo.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1101.png" class="align-center" src="../../_images/1101.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>A continuación, localice el archivo <code class="docutils literal notranslate"><span class="pre">Address_Points.zip</span></code>, expándalo y agregue <code class="docutils literal notranslate"><span class="pre">Address_Points.shp</span></code>. Verá bastantes puntos alrededor de la ciudad. Cada punto representa una dirección válida. Seleccionaremos 1000 puntos al azar. Esta técnica es llamada muestreo aleatorio. Vaya a <span class="menuselection">Procesos ‣ Caja de Herramientas</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/260.png" class="align-center" src="../../_images/260.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Busque y localice el algoritmo <span class="menuselection">Selección de Vector ‣ Extracción aleatoria</span></p></li>
</ol>
<blockquote>
<div><img alt="../../_images/335.png" class="align-center" src="../../_images/335.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Seleccione <code class="docutils literal notranslate"><span class="pre">Address_Points</span></code> como la <span class="guilabel">Capa de Entrada</span>, <code class="docutils literal notranslate"><span class="pre">Number</span> <span class="pre">of</span> <span class="pre">feature</span></code> como el <span class="guilabel">Método</span> e, ingrese <code class="docutils literal notranslate"><span class="pre">1000</span></code> en <span class="guilabel">Número/porcentaje de objetos espaciales</span>. En el <span class="guilabel">Extraído (aleatorio)</span> elija el <code class="docutils literal notranslate"><span class="pre">...</span></code> y clic <span class="guilabel">Guardar a un archivo</span>. Ahora elija el directorio e ingrese el nombre <code class="docutils literal notranslate"><span class="pre">address_point_subset.shp</span></code> y clic <span class="guilabel">Ejecutar</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/415.png" class="align-center" src="../../_images/415.png" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Como el algoritmo extraerá 1000 puntos aleatorios del conjunto de datos dado, para replicar los puntos exactos usados en este ejercicio puede descargar el archivo de subconjunto que obtuvimos durante la ejecución del algoritmo aquí <a class="reference external" href="https://www.qgistutorials.com/downloads/address_point_subset.zip">address_point_subset.zip</a>. Después de descargar, cargue la capa <code class="docutils literal notranslate"><span class="pre">address_point_subset.shp</span></code> en QGIS.</p>
</div>
<ol class="arabic simple" start="5">
<li><p>Se agregará una nueva capa <code class="docutils literal notranslate"><span class="pre">address_point_subset</span></code> al panel <span class="guilabel">Capas</span>, pueden deshabilitar la visibilidad de la capa de puntos de direcciones <code class="docutils literal notranslate"><span class="pre">Address_Points</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/515.png" class="align-center" src="../../_images/515.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>Clic-derecho en la capa <code class="docutils literal notranslate"><span class="pre">address_point_subset</span></code> y seleccione <span class="guilabel">Renombrar capa</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/615.png" class="align-center" src="../../_images/615.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>Renombremos esta capa como <code class="docutils literal notranslate"><span class="pre">origin_points</span></code>. De forma similar, renombre la capa <code class="docutils literal notranslate"><span class="pre">Adult_Mental_Health_Providers</span></code> que representa las instalaciones sanitarias como <code class="docutils literal notranslate"><span class="pre">destination_points</span></code>. Nombrando de esta manera las capas facilita identificarlas en el procesamiento posterior.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/714.png" class="align-center" src="../../_images/714.png" />
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>Localice el algoritmo <span class="menuselection">QNEAT3 ‣ Matrices de distancia ‣ OD Matrix from Layers as Line (m:n)</span>. Si no ve este algoritmo en la caja de herramientas, asegúrese que tiene instalado el complemento <strong>QNEAT3</strong>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/814.png" class="align-center" src="../../_images/814.png" />
</div></blockquote>
<ol class="arabic simple" start="9">
<li><p>Este algoritmo ayuda a encontrar las distancias a lo largo de la red entre el origen seleccionado y las capas destino. Seleccione <code class="docutils literal notranslate"><span class="pre">Roadway_Block</span></code> como la <span class="guilabel">Capa de red</span>. Seleccione <code class="docutils literal notranslate"><span class="pre">origin_points</span></code> como la <span class="guilabel">Capa de puntos Desde</span> y <code class="docutils literal notranslate"><span class="pre">OBJECTID_1</span></code> como el <span class="guilabel">Campo ID único de punto</span>. De forma similar, defina <code class="docutils literal notranslate"><span class="pre">destination_points</span></code> como la <span class="guilabel">Capa de punto Hacia</span> y <code class="docutils literal notranslate"><span class="pre">OBJECTID</span></code>  como el <span class="guilabel">Campo ID único de punto</span>. Defina el <span class="guilabel">Criterio de Optimización</span> como <code class="docutils literal notranslate"><span class="pre">Ruta</span> <span class="pre">más</span> <span class="pre">corta</span> <span class="pre">(optimización</span> <span class="pre">de</span> <span class="pre">distancia)</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/914.png" class="align-center" src="../../_images/914.png" />
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>Como muchas calles en la red son de un solo sentido, necesitamos definir los <span class="guilabel">Parámetros avanzados</span> para especificar la dirección. Vea <a class="reference internal" href="basic_network_analysis.html"><span class="doc">Visualización y Enrutamiento Básico de Red (QGIS3)</span></a> para más detalles sobre cómo están estructurados estos atributos. Elija <code class="docutils literal notranslate"><span class="pre">SUMMARYDIR</span></code>  como el <span class="guilabel">Campo dirección</span>. Ingrese <code class="docutils literal notranslate"><span class="pre">OB</span></code> como el <span class="guilabel">Valor para la dirección adelante</span>, <code class="docutils literal notranslate"><span class="pre">IB</span></code> como el <span class="guilabel">Valor para dirección atrás</span>, y <code class="docutils literal notranslate"><span class="pre">BD</span></code> como el <span class="guilabel">Valor para ambas direcciones</span>. Defina la <span class="guilabel">Tolerancia de topología</span> como <code class="docutils literal notranslate"><span class="pre">0.0000150</span></code>. Mantenga las otras opciones en sus valores predeterminados y clic en <span class="guilabel">Ejecutar</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1021.png" class="align-center" src="../../_images/1021.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>Será agregada una nueva tabla llamada <code class="docutils literal notranslate"><span class="pre">Output</span> <span class="pre">OD</span> <span class="pre">Matrix</span></code> al panel <span class="guilabel">Capas</span>. Clic-derecho y seleccione <span class="guilabel">Abrir Tabla de Atributos</span>. Verá que la tabla contiene <em>13000</em> filas. Teníamos 13 puntos de origen y 1000 puntos destino - por lo que la salida contiene <em>13x1000 = 13000</em> pares de orígenes y destinos. La columna <code class="docutils literal notranslate"><span class="pre">total_cost</span></code> contiene distancia en metros entre cada punto de origen y cada punto destino.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1124.png" class="align-center" src="../../_images/1124.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>Para este tutorial, estamos interesados sólo en el punto de destino con la distancia más corta. Podemos crear una consulta SQL para escoger el destino con el <code class="docutils literal notranslate"><span class="pre">total_cost</span></code> menor entre todos los destinos. Vaya a <span class="menuselection">Procesos ‣ Caja de Herramientas</span></p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1222.png" class="align-center" src="../../_images/1222.png" />
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>Busque y localice <span class="menuselection">Vector general ‣ Ejecutar SQL</span>, seleccione <code class="docutils literal notranslate"><span class="pre">...</span></code> en <span class="guilabel">Fuentes de entrada de datos adicionales</span> marque el <span class="guilabel">Matriz OD Saluda</span> y, clic <span class="guilabel">Aceptar</span>. Ahora clic el <span class="guilabel">Summation</span> bajo <span class="guilabel">Consulta SQL</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1320.png" class="align-center" src="../../_images/1320.png" />
</div></blockquote>
<ol class="arabic simple" start="14">
<li><p>Ingrese la siguiente consulta en la caja de diálogo <span class="guilabel">consulta SQL</span>. Ingrese <code class="docutils literal notranslate"><span class="pre">geometry</span></code> como el <span class="guilabel">Campo geometría</span> y, seleccione <code class="docutils literal notranslate"><span class="pre">LineString</span></code> como el <span class="guilabel">Tipo de Geometría</span>. Clic en <span class="guilabel">Ejecutar</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>select origin_id, destination_id, min(total_cost) as shortest_distance, geometry
from input1 group by origin_id
</pre></div>
</div>
<img alt="../../_images/1418.png" class="align-center" src="../../_images/1418.png" />
</div></blockquote>
<ol class="arabic simple" start="15">
<li><p>Se agregará una capa virtual <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Output</span></code> al panel <span class="guilabel">Capas</span>. Esta Capa tiene el resultado de nuestro análisis. El centro de salud de adultos más cercano para cada uno de los 1000 puntos de origen. Intentemos unas pocas maneras diferentes de visualizar y validar estos resultados.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1516.png" class="align-center" src="../../_images/1516.png" />
</div></blockquote>
<ol class="arabic simple" start="16">
<li><p>Para validar esto construyamos la ruta Más Corta. El punto <em>(OBJECTID_1 = 853046)</em> está visualmente cerca al Centro de salud <em>(OBJECTID = 3)</em>, pero de la consulta SQL está conectada al centro de salud <em>(OBJECTID = 9)</em>. Validemos esto encontrando la distancia real entre estos orígenes y destino. Primero, ejecutemos el algoritmo de ruta más corta en 1 par. Localice el algoritmo <span class="menuselection">QNEAT3 ‣ Enrutamiento ‣ Ruta más corta (punto a punto)</span> y inícielo.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1615.png" class="align-center" src="../../_images/1615.png" />
</div></blockquote>
<ol class="arabic simple" start="17">
<li><p>Seleccione <code class="docutils literal notranslate"><span class="pre">Roadway_Block</span></code> como la <span class="guilabel">Capa de Red</span>. Para elegir un punto de inicio y final. Puedes hacer clic en el botón <span class="guilabel">…</span> junto al <span class="guilabel">Punto de inicio</span> y clic en el punto origen <em>(OBJECTID_1 = 853046)</em> en el lienzo. Similarmente, seleccione el punto de inicio <em>(OBJECTID = 3)</em> como el <span class="guilabel">Punto final</span>. Mantenga el <span class="guilabel">Criterio de optimización</span> como <code class="docutils literal notranslate"><span class="pre">Ruta</span> <span class="pre">más</span> <span class="pre">corta</span> <span class="pre">(optimización</span> <span class="pre">de</span> <span class="pre">distancia)</span></code>. Expanda la sección <span class="guilabel">Parámetro avanzado</span>. Elija <code class="docutils literal notranslate"><span class="pre">SUMMARYDIR</span></code> como el <span class="guilabel">Campo de dirección</span>. Ingrese <code class="docutils literal notranslate"><span class="pre">OB</span></code> como el <span class="guilabel">Valor para dirección adelante</span> y <code class="docutils literal notranslate"><span class="pre">IB</span></code> como <span class="guilabel">Valor para dirección atrás</span>. Defina la <span class="guilabel">Tolerancia de topología</span> como <code class="docutils literal notranslate"><span class="pre">0,0000150</span></code>. Mantenga las otras opciones en sus valores predeterminados y clic en <span class="guilabel">Ejecutar</span>. Ahora cambie el punto destino <em>(OBJECTID = 9)</em> en el <span class="guilabel">Punto final</span> y clic en <span class="guilabel">Ejecutar</span></p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1716.png" class="align-center" src="../../_images/1716.png" />
</div></blockquote>
<ol class="arabic simple" start="18">
<li><p>Dos nuevas capas <code class="docutils literal notranslate"><span class="pre">Shortest</span> <span class="pre">Path</span> <span class="pre">Layer</span></code> será agregada al panel <span class="guilabel">Capas</span>. Usted verá que aunque el punto destino <em>(OBJECTID = 9)</em> visualmente está cerrado al punto de origen, la distancia actual es mayor cuando se compara al punto destino <em>(OBJECTID = 3)</em>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1814.png" class="align-center" src="../../_images/1814.png" />
</div></blockquote>
<ol class="arabic simple" start="19">
<li><p>Note que a pesar de que las líneas que conectan el origen y el destino son rectas, el destino fue encontrado usando la distancia a lo largo de la red. Será una visualización más útil mostrar la ruta más corta real entre cada origen-destino. Al momento, no existe una manera fácil para general la ruta más corta entre múltiples pares origen-destino de la manera como generamos la matriz de distancia. Pero demostraré una manera para usar algo de script python para generar esta visualización. Primero, ejecutemos el algoritmo de la ruta más corta en 1 par. Localice el algoritmo <span class="menuselection">QNEAT3 ‣ Enrutamiento ‣ Ruta más corta (punto a punto)</span> e inícielo.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1912.png" class="align-center" src="../../_images/1912.png" />
</div></blockquote>
<ol class="arabic simple" start="20">
<li><p>En el diálogo <span class="guilabel">Ruta más corta (Punto a Punto)</span>, seleccione <code class="docutils literal notranslate"><span class="pre">Roadway_Block</span></code> como la <span class="guilabel">Capa de red</span>. Mantenga el <span class="guilabel">Criterio de optimización</span> como Ruta más corta (optimización de distancia). A continuación necesitamos elegir un punto de inicio y final. Puede hacer clic en el botón <span class="guilabel">…</span> junto a <span class="guilabel">Punto de inicio</span> y clic en el punto de origen en el lienzo. De forma similar seleccione el punto de destino como el <span class="guilabel">Punto final</span>. Expanda la sección <span class="guilabel">Parámetro avanzado</span>. Elija <code class="docutils literal notranslate"><span class="pre">SUMMARYDIR</span></code> como el <span class="guilabel">Campo dirección</span>. Ingrese <code class="docutils literal notranslate"><span class="pre">OB</span></code> como el <span class="guilabel">Valor para dirección adelante</span> y <code class="docutils literal notranslate"><span class="pre">IB</span></code> como el <span class="guilabel">Valor para dirección atrás</span>. En la <span class="guilabel">Tolerancia de topología</span> ingrese <code class="docutils literal notranslate"><span class="pre">0,000015</span></code>. Mantenga otras opciones en sus valores predeterminados y clic <span class="guilabel">Ejecutar</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2012.png" class="align-center" src="../../_images/2012.png" />
</div></blockquote>
<ol class="arabic simple" start="21">
<li><p>Una nueva capa <code class="docutils literal notranslate"><span class="pre">Shortest</span> <span class="pre">Path</span> <span class="pre">Layer</span></code> se agregará al panel <span class="guilabel">Capas</span>. Verá que esta ruta sigue la red en vez de conectar el origen y destino con una línea recta. La razón que ejecutamos el algoritmo en 1 para es para identificar fácilemente los valores parámetro que podemos usar en nuestro script. Seleccione <code class="docutils literal notranslate"><span class="pre">Shortest</span> <span class="pre">Path</span> <span class="pre">layer</span></code>, clic-derecho y seleccione <span class="guilabel">Quitar capa</span>. Clic el botón <span class="guilabel">Historia</span> en la <span class="guilabel">Caja de herramientas Procesos</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2115.png" class="align-center" src="../../_images/2115.png" />
</div></blockquote>
<ol class="arabic simple" start="22">
<li><p>En el diálogo <span class="guilabel">Historia</span>, Seleccione el último comando (comando usado para Ruta más corta). Este comando muestra todos los parámetros y los valores que usamos. Ahora podemos tomar estos valores y ponerlos en un script que nos puede permitir ejecutar este comando en muchos pares origen-destino. Clic <span class="guilabel">Cerrar</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2214.png" class="align-center" src="../../_images/2214.png" />
</div></blockquote>
<ol class="arabic simple" start="23">
<li><p>En la <span class="guilabel">Caja de Herramientas Procesos</span>, clic el botón <span class="guilabel">scripts</span> y seleccion <span class="guilabel">Crear Nuevo script</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2313.png" class="align-center" src="../../_images/2313.png" />
</div></blockquote>
<ol class="arabic simple" start="24">
<li><p>En el <span class="guilabel">Editor Script de Procesos</span>, copie/pegue el código de abajo. Guarde el archivo como <code class="docutils literal notranslate"><span class="pre">get_routes_from_matrix.py</span></code>. Ahora cierre el <span class="guilabel">Editor Script de Procesos</span>. Si está usando un conjunto de datos diferente que aquel usado en este tutorial, tendrá que actualizar el script con los valores de parámetro del paso 22.</p></li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">processing</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">QCoreApplication</span>
<span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QgsProcessing</span><span class="p">,</span> <span class="n">QgsProcessingAlgorithm</span><span class="p">,</span> 
    <span class="n">QgsProcessingParameterFeatureSource</span><span class="p">,</span> <span class="n">QgsProcessingParameterFeatureSink</span><span class="p">,</span>
    <span class="n">QgsFeatureSink</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MatrixToRoutes</span><span class="p">(</span><span class="n">QgsProcessingAlgorithm</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creats Routes from Distance Matrix&quot;&quot;&quot;</span>
    <span class="n">NETWORK</span> <span class="o">=</span> <span class="s1">&#39;NETWORK&#39;</span>
    <span class="n">MATRIX</span> <span class="o">=</span> <span class="s1">&#39;MATRIX&#39;</span>
    <span class="n">OUTPUT</span> <span class="o">=</span> <span class="s1">&#39;OUTPUT&#39;</span>

    
    <span class="k">def</span> <span class="nf">initAlgorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addParameter</span><span class="p">(</span>
            <span class="n">QgsProcessingParameterFeatureSource</span><span class="p">(</span>
                <span class="s1">&#39;NETWORK&#39;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s1">&#39;Network Layer&#39;</span><span class="p">),</span>
                <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="n">QgsProcessing</span><span class="o">.</span><span class="n">TypeVectorLine</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">addParameter</span><span class="p">(</span>
            <span class="n">QgsProcessingParameterFeatureSource</span><span class="p">(</span>
                <span class="s1">&#39;MATRIX&#39;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s1">&#39;Distance Matrix Layer&#39;</span><span class="p">),</span>
                <span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="n">QgsProcessing</span><span class="o">.</span><span class="n">TypeVectorLine</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">addParameter</span><span class="p">(</span>
            <span class="n">QgsProcessingParameterFeatureSink</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">OUTPUT</span><span class="p">,</span>
                <span class="s1">&#39;Network Routes&#39;</span><span class="p">,</span>
                <span class="n">QgsProcessing</span><span class="o">.</span><span class="n">TypeVectorLine</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">processAlgorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">feedback</span><span class="p">):</span>
        <span class="n">network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterAsString</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NETWORK</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterAsSource</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MATRIX</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        
        <span class="n">sink</span><span class="p">,</span> <span class="n">dest_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterAsSink</span><span class="p">(</span>
            <span class="n">parameters</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OUTPUT</span><span class="p">,</span>
            <span class="n">context</span><span class="p">,</span>
            <span class="n">matrix</span><span class="o">.</span><span class="n">fields</span><span class="p">(),</span>
            <span class="n">matrix</span><span class="o">.</span><span class="n">wkbType</span><span class="p">(),</span>
            <span class="n">matrix</span><span class="o">.</span><span class="n">sourceCrs</span><span class="p">()</span>
            <span class="p">)</span>
        
        <span class="c1"># Compute the number of steps to display within the progress bar and</span>
        <span class="c1"># get features from source</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">/</span> <span class="n">matrix</span><span class="o">.</span><span class="n">featureCount</span><span class="p">()</span> <span class="k">if</span> <span class="n">matrix</span><span class="o">.</span><span class="n">featureCount</span><span class="p">()</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">()</span>
        
        <span class="n">coordinate_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">current</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
            <span class="c1"># Stop the algorithm if cancel button has been clicked</span>
            <span class="k">if</span> <span class="n">feedback</span><span class="o">.</span><span class="n">isCanceled</span><span class="p">():</span>
                <span class="k">break</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">asPolyline</span><span class="p">()</span>
            <span class="n">origin_coords</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
            <span class="n">destination_coords</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>

            <span class="n">feedback</span><span class="o">.</span><span class="n">setProgress</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">current</span> <span class="o">*</span> <span class="n">total</span><span class="p">))</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;INPUT&#39;</span><span class="p">:</span><span class="n">network</span><span class="p">,</span>
            <span class="s1">&#39;START_POINT&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">origin_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">origin_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="s1">&#39;END_POINT&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">destination_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">destination_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="s1">&#39;STRATEGY&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;ENTRY_COST_CALCULATION_METHOD&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;DIRECTION_FIELD&#39;</span><span class="p">:</span><span class="s1">&#39;SUMMARYDIR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;VALUE_FORWARD&#39;</span><span class="p">:</span><span class="s1">&#39;OB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;VALUE_BACKWARD&#39;</span><span class="p">:</span><span class="s1">&#39;IB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;VALUE_BOTH&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DEFAULT_DIRECTION&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;SPEED_FIELD&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;DEFAULT_SPEED&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;TOLERANCE&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;OUTPUT&#39;</span><span class="p">:</span><span class="s1">&#39;memory:&#39;</span><span class="p">}</span>
            
            <span class="n">route_layer</span> <span class="o">=</span> <span class="n">processing</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;qneat3:shortestpathpointtopoint&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)[</span><span class="s1">&#39;OUTPUT&#39;</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="n">route_layer</span><span class="p">:</span>
                <span class="c1"># We expect only 1 feature in the output, so use next() to get the first item</span>
                <span class="n">route_f</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">route_layer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">())</span>
                <span class="n">output_geom</span> <span class="o">=</span> <span class="n">route_f</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span>
                <span class="n">f</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">output_geom</span><span class="p">)</span>
                <span class="n">sink</span><span class="o">.</span><span class="n">addFeature</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">QgsFeatureSink</span><span class="o">.</span><span class="n">FastInsert</span><span class="p">)</span>
            <span class="n">feedback</span><span class="o">.</span><span class="n">setProgressText</span><span class="p">(</span><span class="s1">&#39;Processed feature </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>

  
        <span class="k">return</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">OUTPUT</span><span class="p">:</span> <span class="n">sink</span><span class="p">}</span> 

    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;routes_from_matrix&#39;</span>

    <span class="k">def</span> <span class="nf">displayName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s1">&#39;Get Routes from Matrix&#39;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">shortHelpString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s1">&#39;Creates Route Layer from the result of Distance Matrix algorithm&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupId</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">groupId</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s1">&#39;Processing&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">createInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MatrixToRoutes</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/2412.png" class="align-center" src="../../_images/2412.png" />
</div></blockquote>
<ol class="arabic simple" start="25">
<li><p>Ahora podemos probar el script. Seleccione unas pocas conexiones para la capa <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Output</span></code> para la que quiere que se calculen las rutas actuales. En la <span class="guilabel">Caja de Herramientas de Procesos</span>, se agregará un nueva lista desplegable <span class="guilabel">Scripts</span>. Clic en ella y seleccione <code class="docutils literal notranslate"><span class="pre">Obtener</span> <span class="pre">Rutas</span> <span class="pre">de</span> <span class="pre">la</span> <span class="pre">Matriz</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2510.png" class="align-center" src="../../_images/2510.png" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Este script necesita calcular el grafo de red para cada iteración y es por lo tanto bastante lento. Si tiene bastantes pares origen-destino, puede tomar tiempo.</p>
</div>
<ol class="arabic simple" start="26">
<li><p>En la <span class="guilabel">Capa de Red</span> seleccione <code class="docutils literal notranslate"><span class="pre">Roadway_Block</span></code> y en la <span class="guilabel">capa Matriz Distancia</span> seleccione <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Output</span></code> luego marque solo objetos seleccionados. Clic <span class="guilabel">Ejecutar</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/269.png" class="align-center" src="../../_images/269.png" />
</div></blockquote>
<ol class="arabic simple" start="27">
<li><p>Una nueva capa <code class="docutils literal notranslate"><span class="pre">Network</span> <span class="pre">Routes</span></code> será agregada al panel <span class="guilabel">Capas</span>. Esto contendrá la ruta actual al destino.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2710.png" class="align-center" src="../../_images/2710.png" />
</div></blockquote>
</section>
</section>





  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, Ujaval Gandhi.<br/>
      Actualizado por última vez en jul 08, 2023.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.0.1.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/3/origin_destination_matrix.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>