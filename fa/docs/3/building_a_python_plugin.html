<!DOCTYPE html>

<html lang="fa" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ساخت پلاگین پایتون (QGIS3) &#8212; QGIS Tutorials and Tips</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=0bf093e7" />
    <script src="../../_static/documentation_options.js?v=40f7bd05"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=35c83baa"></script>
    <link rel="search" title="جستجو" href="../../search.html" />
    <link rel="next" title="Building a Processing Plugin (QGIS3)" href="processing_python_plugin.html" />
    <link rel="prev" title="Writing Python Scripts for Processing Framework (QGIS3)" href="processing_python_scripts.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>


<!-- Cookie Notice -->
<!-- Script from https://github.com/AOEpeople/cookie-notice -->
<script type="text/javascript" src="../../_static/cookie.notice.min.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1WQ7B80XJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B1WQ7B80XJ');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">مقدمه</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">Making a Map (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Working with Attributes (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">Importing Spreadsheets or CSV files (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">استایل برداری پایه (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">محاسبه طول خط و آمار (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">استایل‌سازی و تحلیل شطرنجی پایه (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Raster Mosaicing and Clipping (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Working with Terrain Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Working with WMS Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">کار با پروژکشن</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">زمین مرجع کردن نقشه  شیت توپوگرافی اسکن شده (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">زمین مرجع کردن عکس هوایی (QGIS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">رقومی کردن داده های نقشه (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins.html">اجرای اتصال جدول (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">اجرای اتصال مکانی (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">Performing Spatial Queries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Nearest Neighbor Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Sampling Raster Data using Points or Polygons (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_raster_area.html">Calculating Raster Area (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">Creating Heatmaps (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="animating_time_series.html">متحرک سازی داده های سری زمانی (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="handling_invalid_geometries.html">Handling Invalid Geometries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_raster_analysis.html">تجزیه و تحلیل شطرنجی پیشرفته (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">Interpolating Point Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">Batch Processing using Processing Framework (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">گردش کار خودکار با استفاده از مدل پردازش (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">ایجاد خودکار نقشه با اطلس طرح بندی چاپی (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_criteria_overlay.html">تحلیل همپوشانی چندمعیار­ه (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector_styling_expressions.html">Basic Filtering and Styling with Expressions (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="block_world_styling.html">Creating a Block World Map (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="river_styling_expressions.html">Styling a River Network with Expressions (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="contour_3d_styling.html">Styling Contours in 3D (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="isometric_buildings.html">Creating Isometric Buildings (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_canvas_maps.html">Making Interactive Canvas Maps (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_reveal_maps.html">Making Interactive Reveal Maps (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="cartogram_animation.html">Creating an Animated Cartogram (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_network_analysis.html">تجسم و مسیریابی شبکه پایه (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="origin_destination_matrix.html">Locating Nearest Facility with Origin-Destination Matrix (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="service_area_analysis.html">Service Area Analysis using Openrouteservice (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="travel_time_analysis.html">Travel Time Analysis with Uber Movement (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="areal_mean_rainfall.html">محاسبه منطقه ای میانگین بارش(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="colorized_river_basin_map.html">ایجاد یک نقشه حوضه رودخانه رنگی (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_landuse_map.html">ایجاد نقشه کاربری اراضی(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_intersection_density.html">محاسبه تراکم تقاطع خیابان(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="landuse_buffer.html">تعیین مناطق بافر کاربری اراضی (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="solidwaste_mapping.html">نقشه برداری حجم دفع زباله (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">شروع برنامه نویسی پایتون (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_algorithms_pyqgis.html">Running Processing Algorithms via Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">استفاده از بیان توابع عبارتی پایتون (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">Writing Python Scripts for Processing Framework (QGIS3)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ساخت پلاگین پایتون (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_plugin.html">Building a Processing Plugin (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_qgis_jobs.html">اجرا و برنامه ریزی پردازش وظیفه ای در QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">نقشه برداری وب با QGIS2Web (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_basemaps_with_qtiles.html">Creating Basemaps with QTiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Using Plugins (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloading_osm_data.html">جستجو و دانلود داده های OpenStreetMap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning_resources.html">منابع آموزشی QGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">اعتبار داده ها</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_processing.html">پردازش دسته ای با استفاده از چارچوب پردازش (QGIS2)</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="processing_python_scripts.html" title="Previous Chapter: Writing Python Scripts for Processing Framework (QGIS3)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Writing Pytho...</span>
    </a>
  </li>
  <li>
    <a href="processing_python_plugin.html" title="Next Chapter: Building a Processing Plugin (QGIS3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Building a Pr... &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>
<hr>
<p>Want to learn QGIS in a structured way? Check out <a href="https://spatialthoughts.com/" target="_blank">Spatial Thoughts</a> for more learning materials and instructor-led online programs with QGIS.org certification.</p>

<hr>
<p>These tutorials are also available in many other languages. Please see <a href="https://www.qgistutorials.com/en/docs/introduction.html#translations" target="_blank">translations</a> page.
</p>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      

  <section id="building-a-python-plugin-qgis3">
<h1>ساخت پلاگین پایتون (QGIS3)<a class="headerlink" href="#building-a-python-plugin-qgis3" title="Link to this heading">¶</a></h1>
<p>پلاگین ها یک روش عالی برای توسعه عملیاتی QGIS هستند. با استفاده از پایتون می توانید افزونه هایی را بنویسید که می توانند افزودن یک دکمه ساده تا جعبه ابزارهای غیرمتعارف باشد. این آموزش روند کار ایجاد محیط توسعه ، طراحی رابط کاربری برای یک افزونه و نوشتن کد برای تعامل با QGIS را بیان می کند. لطفاً برای آشنایی با اصول اولیه ، آموزش: doc: <cite>getting_started_with_pyqgis</cite> را مرور کنید.</p>
<div class="admonition note">
<p class="admonition-title">توجه</p>
<p>اگر در حال ساخت یک افزونه جدید هستید ، من اکیداً توصیه می کنم به جای پلاگین GUI که در این مقاله آموزشی توضیح داده شده ، یک پلاگین پردازشProcessing Plugin بسازید. برای جزئیات بیشتر به: Doc: <cite>processing_python_plugin</cite> مراجعه کنید.</p>
</div>
<section id="overview-of-the-task">
<h2>نمای کلی تمرین<a class="headerlink" href="#overview-of-the-task" title="Link to this heading">¶</a></h2>
<p>ما یک پلاگین ساده به نام <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Attributes</span></code> برای ذخیره مشخصات توصیفی ایجاد خواهیم کرد که به کاربران امکان می دهد یک لایه برداری را انتخاب کرده و ویژگی های آن را در یک فایل CSV بنویسند.</p>
</section>
<section id="get-the-tools">
<h2>اخذ داده<a class="headerlink" href="#get-the-tools" title="Link to this heading">¶</a></h2>
<section id="qt-creator">
<h3>ایجادکننده Qt<a class="headerlink" href="#qt-creator" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="http://www.qt.io/">Qt</a> یک چارچوب توسعه نرم افزار است که برای توسعه برنامه هایی که بر روی ویندوز، مک، لینوکس و همچنین سیستم عامل های مختلف تلفن همراه اجرا می شوند، استفاده می شود. خود QGIS با استفاده از چارچوب Qt نوشته شده است. برای توسعه افزونه، ما از برنامه ای به نام «Qt Creator &lt;<a class="reference external" href="https://doc.qt.io/qt-5/qtdesigner-manual.html">https://doc.qt.io/qt-5/qtdesigner-manual.html</a>&gt;`_ برای طراحی رابط برای افزونه خود استفاده خواهیم کرد.</p>
<p>نصب کننده Qt Creator را از «Qt Offline Installers &lt;<a class="reference external" href="https://www.qt.io/offline-installers">https://www.qt.io/offline-installers</a>&gt;» دانلود و نصب کنید. مطمئن شوید که <strong>Qt Creator</strong> را در صفحه دانلود انتخاب کرده اید. توجه داشته باشید که برای نصب بسته باید یک حساب Qt رایگان ایجاد کنید.</p>
<div class="admonition note">
<p class="admonition-title">توجه</p>
<p>نصب کننده OSGeo4w برای QGIS در ویندوز شامل یک کپی از برنامه <strong>Qt Designer</strong> است که یک نسخه سبک از <strong>Qt Creator</strong> است و برای ساخت پلاگین ها کاملاً مناسب است. می توانید دانلود Qt Creator را نادیده بگیرید و به جای آن از :menuselection:<a href="#id1"><span class="problematic" id="id2">`</span></a>C:\OSGeo4W64\bin\qgis-designer استفاده کنید.</p>
</div>
<img alt="../../_images/setup1.png" class="align-center" src="../../_images/setup1.png" />
</section>
<section id="python-bindings-for-qt">
<h3>پیوندهای پایتون برای Qt<a class="headerlink" href="#python-bindings-for-qt" title="Link to this heading">¶</a></h3>
<p>از آنجایی که ما در حال توسعه افزونه در پایتون هستیم، باید پیوندهای پایتون را برای Qt نصب کنیم. روش نصب اینها به پلتفرمی که استفاده می کنید بستگی دارد. برای ساخت پلاگین ها به ابزار خط فرمان «pyrcc5» نیاز داریم.</p>
<p><strong>پنجره ها</strong></p>
<p>پیوندهای پایتون مربوطه در نصب QGIS در ویندوز گنجانده شده است. اما برای استفاده از آنها از پوشه افزونه، باید مسیر نصب QGIS را مشخص کنیم.</p>
<p>یک فایل Windows Batch (پسوند bat.) با محتوای زیر ایجاد کنید و آن را به عنوان &quot;compile.bat&quot; در رایانه خود ذخیره کنید. بعداً این فایل را در پوشه افزونه کپی می کنیم. اگر QGIS را در مسیر دیگری نصب کرده اید، مسیر خود را جایگزین <code class="docutils literal notranslate"><span class="pre">C:\OSGeo4W64\bin\</span></code> کنید.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@echo off
call &quot;C:\OSGeo4W64\bin\o4w_env.bat&quot;
call &quot;C:\OSGeo4W64\bin\qt5_env.bat&quot;
call &quot;C:\OSGeo4W64\bin\py3_env.bat&quot;

@echo on
pyrcc5 -o resources.py resources.qrc
</pre></div>
</div>
<img alt="../../_images/setup2.png" class="align-center" src="../../_images/setup2.png" />
<p><strong>مک</strong></p>
<p>مدیر بسته Homebrew &lt;<a class="reference external" href="http://brew.sh">http://brew.sh</a>&gt;`_ را نصب کنید. با اجرای دستور زیر بسته «PyQt» را نصب کنید</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>brew install pyqt
</pre></div>
</div>
<dl class="simple">
<dt><strong>لینوکس</strong></dt><dd><p>بسته به توزیع خود، بسته «python-qt5» را پیدا و نصب کنید. در توزیع های مبتنی بر اوبونتو و دبیان، می توانید دستور زیر را اجرا کنید:</p>
</dd>
</dl>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo apt-get install python-qt5
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">توجه</p>
<p>ممکن است متوجه شوید که QGIS قبلاً این بسته را نصب کرده است.</p>
</div>
</section>
<section id="a-text-editor-or-a-python-ide">
<h3>یک ویرایشگر متن یا یک IDE پایتون<a class="headerlink" href="#a-text-editor-or-a-python-ide" title="Link to this heading">¶</a></h3>
<p>هر نوع توسعه نرم افزاری نیاز به یک ویرایشگر متن خوب دارد. اگر قبلاً یک ویرایشگر متن مورد علاقه یا یک IDE (محیط توسعه یکپارچه) دارید، می توانید از آن برای این آموزش استفاده کنید. در غیر این صورت، هر پلتفرم طیف گسترده ای از گزینه های رایگان یا پولی را برای ویرایشگرهای متن ارائه می دهد. یکی را انتخاب کنید که متناسب با نیاز شما باشد.</p>
<p>این آموزش از ویرایشگر Notepad++ در ویندوز استفاده می کند.</p>
<p><strong>پنجره ها</strong></p>
<p>Notepad++ &lt;<a class="reference external" href="http://notepad-plus-plus.org/">http://notepad-plus-plus.org/</a>&gt;`_ یک ویرایشگر رایگان خوب برای ویندوز است. ویرایشگر Notepad++ &lt;<a class="reference external" href="https://notepad-plus-plus.org/download/">https://notepad-plus-plus.org/download/</a>&gt;`_ را دانلود و نصب کنید.</p>
<div class="admonition note">
<p class="admonition-title">توجه</p>
<p>اگر از Notepad++ استفاده می کنید، حتماً به <span class="menuselection">Settings ‣ Preferences ‣ Tab Settings</span> بروید و <span class="guilabel">Replace by space</span> را فعال کنید. پایتون در مورد فضای سفید بسیار حساس است و این تنظیم باعث می شود که برگه ها و فضاها به درستی رفتار شوند.</p>
</div>
</section>
<section id="plugin-builder-plugin">
<h3>پلاگین افزونه ساز<a class="headerlink" href="#plugin-builder-plugin" title="Link to this heading">¶</a></h3>
<p>یک پلاگین QGIS مفید به نام &quot;Plugin Builder&quot; وجود دارد که تمام فایل های لازم و کد دیگ بخار را برای یک پلاگین ایجاد می کند. افزونه &quot;Plugin Builder&quot; را پیدا و نصب کنید. برای جزئیات بیشتر در مورد نحوه نصب افزونه ها به <a class="reference internal" href="../using_plugins.html"><span class="doc">استفاده از پلاگین Plugins</span></a> مراجعه کنید.</p>
</section>
<section id="plugins-reloader-plugin">
<h3>افزونه Plugins Reloader<a class="headerlink" href="#plugins-reloader-plugin" title="Link to this heading">¶</a></h3>
<p>این افزونه کمکی دیگری است که امکان توسعه تکراری پلاگین ها را فراهم می کند. با استفاده از این افزونه، می توانید کد پلاگین خود را تغییر دهید و بدون نیاز به راه اندازی مجدد QGIS هر بار، آن را در QGIS منعکس کنید. افزونه «Plugin Reloader» را پیدا و نصب کنید. برای جزئیات بیشتر در مورد نحوه نصب افزونه ها به <a class="reference internal" href="../using_plugins.html"><span class="doc">استفاده از پلاگین Plugins</span></a> مراجعه کنید.</p>
<div class="admonition note">
<p class="admonition-title">توجه</p>
<p>Plugin Reloader یک افزونه آزمایشی است. اگر نمی توانید آن را پیدا کنید، مطمئن شوید که :guilabel: <cite>نمایش افزونه های آزمایشی</cite> در تنظیمات :guilabel:<a href="#id1"><span class="problematic" id="id2">`</span></a>Plugin Manager را علامت زده اید.</p>
</div>
</section>
</section>
<section id="procedure">
<h2>روش<a class="headerlink" href="#procedure" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>QGIS را باز کنید. به <span class="menuselection">Plugins ‣ Plugin Builder ‣ Plugin Builder</span> بروید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/129.png" class="align-center" src="../../_images/129.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>گفتگوی :guilabel:'QGIS Plugin Builder' را با یک فرم مشاهده خواهید کرد. می توانید فرم را با جزئیات مربوط به افزونه ما پر کنید. :guilabel:'Class name' نام کلاس پایتون خواهد بود که حاوی منطق پلاگین است. این نام پوشه حاوی تمام فایل های افزونه نیز خواهد بود. &quot;SaveAttributes&quot; را به عنوان نام کلاس وارد کنید. :guilabel:<a href="#id1"><span class="problematic" id="id2">`</span></a>Plugin name' نامی است که پلاگین شما تحت آن در :guilabel:<a href="#id3"><span class="problematic" id="id4">`</span></a>Plugin Manager ظاهر می شود. نام را به عنوان &quot;ذخیره ویژگی ها&quot; وارد کنید. در قسمت :guilabel:'Description' توضیحاتی اضافه کنید. :guilabel:<a href="#id5"><span class="problematic" id="id6">`</span></a>نام ماژول، نام فایل اصلی پایتون برای افزونه خواهد بود. آن را به عنوان «save_attributes» وارد کنید. شماره نسخه ها را همانطور که هستند بگذارید و نام و آدرس ایمیل خود را در قسمت های مربوطه وارد کنید. روی :guilabel:'Next' کلیک کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/219.png" class="align-center" src="../../_images/219.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>توضیح مختصری از افزونه را برای گفتگوی :guilabel:<a href="#id1"><span class="problematic" id="id2">`</span></a>About وارد کنید و روی :guilabel:<a href="#id3"><span class="problematic" id="id4">`</span></a>Next کلیک کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/317.png" class="align-center" src="../../_images/317.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>&quot;دکمه ابزار با گفتگو&quot; را از انتخابگر :guilabel:&quot;Template&quot; انتخاب کنید. مقدار :guilabel:'Text for menu item' نحوه یافتن افزونه شما توسط کاربران در منوی QGIS خواهد بود. آن را به‌عنوان «ذخیره ویژگی‌ها به‌عنوان CSV» وارد کنید. فیلد <span class="guilabel">Menu</span> تصمیم می‌گیرد که آیتم افزونه شما در QGIS کجا اضافه شود. از آنجایی که افزونه ما برای داده های برداری است، &quot;Vector&quot; را انتخاب کنید. روی :guilabel:'Next' کلیک کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/46.png" class="align-center" src="../../_images/46.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>پلاگین ساز از شما می خواهد که نوع فایل هایی را که باید تولید کنید. انتخاب پیش فرض را نگه دارید و روی :guilabel:<a href="#id1"><span class="problematic" id="id2">`</span></a>Next کلیک کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/56.png" class="align-center" src="../../_images/56.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>از آنجایی که ما قصد انتشار این افزونه را نداریم، می‌توانید مقادیر <span class="guilabel">ردیاب اشکال</span>، <span class="guilabel">Repository و :guilabel:</span> صفحه اصلی را به حالت پیش‌فرض رها کنید. کادر <span class="guilabel">افزونه را به عنوان آزمایشی پرچم گذاری کنید</span> در پایین علامت بزنید و روی :guilabel:<a href="#id1"><span class="problematic" id="id2">`</span></a>بعدی کلیک کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/66.png" class="align-center" src="../../_images/66.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>از شما خواسته می شود که یک دایرکتوری برای افزونه خود انتخاب کنید. در حال حاضر، آن را در دایرکتوری ذخیره کنید که می توانید به راحتی آن را در رایانه خود پیدا کنید و روی :guilabel:'Generate' کلیک کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/76.png" class="align-center" src="../../_images/76.png" />
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>سپس دکمه :guilabel:<a href="#id1"><span class="problematic" id="id2">`</span></a>generate را فشار دهید. پس از ایجاد الگوی افزونه شما یک گفتگوی تایید را مشاهده خواهید کرد.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/86.png" class="align-center" src="../../_images/86.png" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">توجه</p>
<p>ممکن است پیامی دریافت کنید که می گوید pyrcc5 در مسیر یافت نمی شود. شما میتوانید این پیام را نادیده بگیرید.</p>
</div>
<ol class="arabic simple" start="9">
<li><p>قبل از اینکه بتوانیم از افزونه جدید ایجاد شده استفاده کنیم، باید فایل &quot;resources.qrc&quot; را که توسط افزونه ساز ایجاد شده است، کامپایل کنیم. این فایل بخشی از سیستم منبع Qt &lt;<a class="reference external" href="https://doc.qt.io/qt-5/resources.html">https://doc.qt.io/qt-5/resources.html</a>&gt;`_ است که به همه فایل های باینری استفاده شده در افزونه ارجاع می دهد. برای این افزونه، فقط آیکون افزونه را خواهد داشت. کامپایل کردن این فایل کد برنامه ای را تولید می کند که می تواند در پلاگین مستقل از پلتفرمی که پلاگین در حال اجرا است استفاده شود. دستورالعمل مخصوص پلتفرم را برای این مرحله دنبال کنید.</p></li>
</ol>
<p><strong>پنجره ها</strong></p>
<p>اکنون می‌توانید فایل «compile.bat» (که در ابتدا در قسمت <a href="#id1"><span class="problematic" id="id2">*</span></a>Python Bindings for Qt ایجاد شده است) را در پوشه افزونه کپی کنید. پس از کپی کردن، روی فایل دوبار کلیک کنید تا اجرا شود. اگر اجرا با موفقیت انجام شد، یک فایل جدید به نام &quot;resources.py&quot; را در پوشه مشاهده خواهید کرد.</p>
<blockquote>
<div><img alt="../../_images/96.png" class="align-center" src="../../_images/96.png" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">توجه</p>
<p>اگر این مرحله ناموفق بود، می‌توانید «cmd.exe» را راه‌اندازی کنید و با استفاده از دستور «cd» به پوشه افزونه بروید. فایل Batch را با اجرای <code class="docutils literal notranslate"><span class="pre">compile.bat</span></code> اجرا کنید تا خطا را مشاهده کنید.</p>
</div>
<p><strong>مک و لینوکس</strong></p>
<p>ابتدا باید «pb_tool» را نصب کنید. یک ترمینال را باز کنید و از طریق پیپ نصب کنید.</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo pip3 install pb_tool
</pre></div>
</div>
</div></blockquote>
<p>یک ترمینال را باز کنید و به فهرست پلاگین بروید و «pb_tool compile» را تایپ کنید. این دستور &quot;pyrcc5&quot; را که به عنوان بخشی از بخش <em>Python Bindings for Qt</em> نصب کرده بودیم اجرا می کند.</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pb_tool compile
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>پلاگین ها در QGIS در یک پوشه خاص ذخیره می شوند. ما باید دایرکتوری پلاگین خود را در آن پوشه کپی کنیم تا بتوان از آن استفاده کرد. در QGIS، پوشه نمایه فعلی خود را با رفتن به <span class="menuselection">Settings ‣ User Profiles ‣ Open Active Profile Folder</span> پیدا کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/109.png" class="align-center" src="../../_images/109.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>در پوشه پروفایل، پوشه پلاگین را در زیر پوشه <span class="menuselection">python ‣ plugins</span> کپی کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1112.png" class="align-center" src="../../_images/1112.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>اکنون ما آماده ایم تا نگاهی به پلاگین کاملاً جدیدی که ایجاد کرده ایم داشته باشیم. QGIS را ببندید و دوباره راه اندازی کنید. به <span class="menuselection">Plugins ‣ Manage and Install plugins</span> بروید و افزونه <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Attributes</span></code> را در برگه :guilabel:<a href="#id1"><span class="problematic" id="id2">`</span></a>Installed فعال کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1210.png" class="align-center" src="../../_images/1210.png" />
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>متوجه خواهید شد که یک نماد جدید در نوار ابزار افزونه و یک ورودی منوی جدید در زیر <span class="menuselection">Vector ‣ Save Attributes ‣ Save Attributes as CSV`</span> وجود دارد. آن را انتخاب کنید تا گفتگوی افزونه راه اندازی شود.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/138.png" class="align-center" src="../../_images/138.png" />
</div></blockquote>
<ol class="arabic simple" start="14">
<li><p>شما متوجه یک گفتگوی خالی جدید با نام <span class="guilabel">Save Attributes</span> خواهید شد. این گفتگو را ببندید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/148.png" class="align-center" src="../../_images/148.png" />
</div></blockquote>
<ol class="arabic simple" start="15">
<li><p>اکنون کادر محاوره ای خود را طراحی می کنیم و برخی از عناصر رابط کاربری را به آن اضافه می کنیم. برنامه «Qt Creator» را باز کنید و به :menuselection:<a href="#id1"><span class="problematic" id="id2">`</span></a>File --&gt; Open File or Project بروید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/158.png" class="align-center" src="../../_images/158.png" />
</div></blockquote>
<ol class="arabic simple" start="16">
<li><p>به فهرست پلاگین بروید و فایل «save_attributes_dialog_base.ui» را انتخاب کنید. روی :guilabel:'Open' کلیک کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/16.gif" class="align-center" src="../../_images/16.gif" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">توجه</p>
<p>ویندوز پوشه «AppData» را پنهان می کند، بنابراین ممکن است آن را در گفتگوی انتخابگر فایل مشاهده نکنید. می‌توانید «AppData» را در اعلان :guilabel: «نام فایل» از فهرست اصلی آن وارد کنید تا آن را باز کنید.</p>
</div>
<ol class="arabic simple" start="17">
<li><p>دیالوگ خالی افزونه را خواهید دید. می‌توانید عناصر را از پانل سمت چپ در دیالوگ بکشید و رها کنید. ما یک نوع <span class="guilabel">جعبه ترکیبی</span> از نوع :guilabel:<a href="#id1"><span class="problematic" id="id2">`</span></a>ویجت های ورودی را اضافه می کنیم. آن را به گفتگوی افزونه بکشید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/178.png" class="align-center" src="../../_images/178.png" />
</div></blockquote>
<ol class="arabic simple" start="18">
<li><p>اندازه جعبه ترکیبی را تغییر دهید و اندازه آن را تنظیم کنید. اکنون یک <span class="guilabel">Label</span> تایپ کنید:guilabel:<cite>Display Widget</cite> در گفتگو.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/186.png" class="align-center" src="../../_images/186.png" />
</div></blockquote>
<ol class="arabic simple" start="19">
<li><p>روی متن برچسب کلیک کنید و &quot;انتخاب یک لایه&quot; را وارد کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/195.png" class="align-center" src="../../_images/195.png" />
</div></blockquote>
<ol class="arabic simple" start="20">
<li><p>این فایل را با رفتن به <span class="menuselection">File ‣ Save save_attributes_dialog_base.ui</span> ذخیره کنید. توجه داشته باشید که نام شی جعبه ترکیبی &quot;comboBox&quot; است. برای تعامل با این شی با استفاده از کد پایتون، باید به آن با این نام اشاره کنیم.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/205.png" class="align-center" src="../../_images/205.png" />
</div></blockquote>
<ol class="arabic simple" start="21">
<li><p>بیایید افزونه خود را دوباره بارگذاری کنیم تا بتوانیم تغییرات را در پنجره گفتگو مشاهده کنیم. به :menuselection:<a href="#id1"><span class="problematic" id="id2">`</span></a>Plugin --&gt; Plugin Reloader --&gt; Plugin Reloader را انتخاب کنید. &quot;SaveAttributes&quot; را در گفتگوی :guilabel:&quot;Configure Plugin Reloader&quot; انتخاب کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2110.png" class="align-center" src="../../_images/2110.png" />
</div></blockquote>
<ol class="arabic simple" start="22">
<li><p>برای بارگیری آخرین نسخه افزونه، روی دکمه <span class="guilabel">بارگذاری مجدد افزونه کلیک کنید. روی دکمه :guilabel:`Save Attributes as CSV</span> کلیک کنید تا کادر گفتگوی جدید طراحی شده باز شود.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/225.png" class="align-center" src="../../_images/225.png" />
</div></blockquote>
<ol class="arabic" start="23">
<li><p>بیایید مقداری منطق به افزونه اضافه کنیم که باکس ترکیبی را با لایه های بارگذاری شده در QGIS پر می کند. به فهرست پلاگین بروید و فایل «save_attributes.py» را در یک ویرایشگر متن بارگیری کنید. ابتدا، در بالای فایل با وارد کردن های دیگر وارد کنید:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="n">QgsProject</span>
</pre></div>
</div>
<p>سپس تا انتها به پایین اسکرول کنید و روش «run(self)» را پیدا کنید. این روش زمانی فراخوانی می شود که روی دکمه نوار ابزار کلیک کنید یا آیتم منوی افزونه را انتخاب کنید. کد زیر را در ابتدای روش اضافه کنید. این کد لایه‌های بارگذاری شده در QGIS را دریافت می‌کند و آن را به شی «comboBox» از گفتگوی افزونه اضافه می‌کند.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fetch the currently loaded layers</span>
<span class="n">layers</span> <span class="o">=</span> <span class="n">QgsProject</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">layerTreeRoot</span><span class="p">()</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
<span class="c1"># Clear the contents of the comboBox from previous runs</span>
<span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="c1"># Populate the comboBox with names of all the loaded layers</span>
<span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">])</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><img alt="../../_images/23a.png" class="align-center" src="../../_images/23a.png" />
<img alt="../../_images/23b.png" class="align-center" src="../../_images/23b.png" />
</div></blockquote>
<ol class="arabic simple" start="24">
<li><p>به پنجره اصلی QGIS برگردید، با کلیک بر روی دکمه :guilabel:'Reload plugin' دوباره افزونه را بارگیری کنید. برای آزمایش این قابلیت جدید، باید چند لایه در QGIS بارگذاری کنیم. پس از بارگذاری چند لایه، افزونه را با رفتن به مسیر <span class="menuselection">Vector ‣ Save Attributes ‣ Save Attributes as CSV</span> راه اندازی کنید. خواهید دید که جعبه ترکیبی ما اکنون با نام لایه هایی که در QGIS بارگذاری شده اند پر شده است.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/245.png" class="align-center" src="../../_images/245.png" />
</div></blockquote>
<ol class="arabic simple" start="25">
<li><p>بیایید عناصر رابط کاربری باقی مانده را اضافه کنیم. به Qt Creator برگردید و فایل «save_attributes_dialog_base.ui» را بارگیری کنید. یک &quot;Label&quot; :guilabel:&quot;Display Widget&quot; اضافه کنید و متن را به &quot;انتخاب فایل خروجی&quot; تغییر دهید. یک &quot;LineEdit&quot; نوع :guilabel:&quot;Input Widget&quot; اضافه کنید که مسیر فایل خروجی را که کاربر انتخاب کرده را نشان می دهد. در مرحله بعد، یک &quot;Push Button&quot; را تایپ کنید:guilabel:&quot;Button&quot; و برچسب دکمه را به &quot;...&quot; تغییر دهید. به نام اشیاء ویجت‌هایی که باید برای تعامل با آنها استفاده کنیم، توجه کنید. فایل را ذخیره کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/255.png" class="align-center" src="../../_images/255.png" />
</div></blockquote>
<ol class="arabic simple" start="26">
<li><p>اکنون کد پایتون را اضافه می کنیم تا زمانی که کاربر روی دکمه فشاری «...» کلیک می کند، مرورگر فایل را باز می کند و مسیر انتخاب را در ویجت ویرایش خط نشان می دهد. فایل &quot;save_attributes.py&quot; را در یک ویرایشگر متن باز کنید. &quot;QFileDialog&quot; را به &quot;QtWidgets&quot; لیست واردات در بالای فایل اضافه کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/264.png" class="align-center" src="../../_images/264.png" />
</div></blockquote>
<ol class="arabic simple" start="27">
<li><p>یک متد جدید به نام «select_output_file» با کد زیر اضافه کنید. این کد یک مرورگر فایل را باز می کند و ویجت ویرایش خط را با مسیر فایلی که کاربر انتخاب کرده است پر می کند. توجه داشته باشید که «getSaveFileName» چگونه یک تاپل را با نام فایل و فیلتر استفاده شده برمی گرداند.</p></li>
</ol>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">select_output_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">filename</span><span class="p">,</span> <span class="n">_filter</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="p">,</span> <span class="s2">&quot;Select   output file &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;*.csv&#39;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/275.png" class="align-center" src="../../_images/275.png" />
</div></blockquote>
<ol class="arabic simple" start="28">
<li><p>حال باید کدی را اضافه کنیم تا با کلیک روی دکمه «...»، متد «select_output_file» فراخوانی شود. به سمت پایین به روش «run» بروید و خط زیر را در بلوکی که دیالوگ مقداردهی شده است اضافه کنید. این کد روش «select_output_file» را به سیگنال «کلیک شده» ویجت دکمه فشاری متصل می‌کند.</p></li>
</ol>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_output_file</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/285.png" class="align-center" src="../../_images/285.png" />
</div></blockquote>
<ol class="arabic simple" start="29">
<li><p>به QGIS برگردید، افزونه را دوباره بارگیری کنید و آن را اجرا کنید. اگر همه چیز خوب پیش رفت، می‌توانید روی دکمه «...» کلیک کنید و یک فایل متنی خروجی را از دیسک خود انتخاب کنید.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/294.png" class="align-center" src="../../_images/294.png" />
</div></blockquote>
<ol class="arabic" start="30">
<li><p>به QGIS برگردید، افزونه را دوباره بارگیری کنید و آن را اجرا کنید. اگر همه چیز پیش رفت، می‌توانید روی دکمه «...» کلیک کنید و یک فایل متنی را از دیسک خود انتخاب کنید.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
  <span class="n">selectedLayerIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
  <span class="n">selectedLayer</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="n">selectedLayerIndex</span><span class="p">]</span><span class="o">.</span><span class="n">layer</span><span class="p">()</span>
  <span class="n">fieldnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">fields</span><span class="p">()]</span>
  <span class="c1"># write header</span>
  <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fieldnames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
  <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
  <span class="c1"># write feature attributes</span>
  <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
    <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fieldnames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/304.png" class="align-center" src="../../_images/304.png" />
</li>
<li><p>ما آخرین چیزی را برای اضافه کردن داریم. وقتی عملیات با موفقیت تمام شد، باید همان را به کاربر نشان دهیم. روش ارجح برای دادن اعلان به کاربر در QGIS از طریق روش &quot;self.iface.messageBar().pushMessage()&quot; است. &quot;Qgis&quot; را به &quot;qgis.core&quot; لیست واردات در بالای فایل اضافه کنید و کد زیر را در انتهای روش &quot;run&quot; اضافه کنید.</p></li>
</ol>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span>
  <span class="s2">&quot;Success&quot;</span><span class="p">,</span> <span class="s2">&quot;Output file written at &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span>
  <span class="n">level</span><span class="o">=</span><span class="n">Qgis</span><span class="o">.</span><span class="n">Success</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/31a.png" class="align-center" src="../../_images/31a.png" />
<img alt="../../_images/31b.png" class="align-center" src="../../_images/31b.png" />
</div></blockquote>
<ol class="arabic simple" start="32">
<li><p>اکنون افزونه ما آماده است. افزونه را دوباره بارگیری کنید و آن را امتحان کنید. متوجه خواهید شد که فایل متنی خروجی که انتخاب کرده اید دارای ویژگی های لایه برداری است.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/323.png" class="align-center" src="../../_images/323.png" />
</div></blockquote>
<ol class="arabic simple" start="33">
<li><p>می توانید دایرکتوری افزونه را فشرده کرده و با کاربران خود به اشتراک بگذارید. آنها می توانند محتویات را در فهرست پلاگین خود باز کرده و افزونه شما را امتحان کنند. اگر این یک افزونه واقعی بود، آن را در «مخزن پلاگین QGIS &lt;<a class="reference external" href="https://plugins.qgis.org/">https://plugins.qgis.org/</a>&gt;» آپلود می‌کردید تا همه کاربران QGIS بتوانند افزونه شما را پیدا و دانلود کنند.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">توجه</p>
<p>این افزونه فقط برای نمایش است. این افزونه را منتشر نکنید و آن را در مخزن افزونه QGIS آپلود نکنید.</p>
</div>
<p>در زیر فایل کامل <code class="docutils literal notranslate"><span class="pre">save_attributes.py</span></code> به عنوان مرجع است.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">/***************************************************************************</span>
<span class="sd"> SaveAttributes</span>
<span class="sd">                                 A QGIS plugin</span>
<span class="sd"> This plugin saves the attributes of the selected vector layer as a CSV file.</span>
<span class="sd"> Generated by Plugin Builder: http://g-sherman.github.io/Qgis-Plugin-Builder/</span>
<span class="sd">                              -------------------</span>
<span class="sd">        begin                : 2019-03-28</span>
<span class="sd">        git sha              : $Format:%H$</span>
<span class="sd">        copyright            : (C) 2019 by Ujaval Gandhi</span>
<span class="sd">        email                : ujaval@spatialthoughts.com</span>
<span class="sd"> ***************************************************************************/</span>

<span class="sd">/***************************************************************************</span>
<span class="sd"> *                                                                         *</span>
<span class="sd"> *   This program is free software; you can redistribute it and/or modify  *</span>
<span class="sd"> *   it under the terms of the GNU General Public License as published by  *</span>
<span class="sd"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
<span class="sd"> *   (at your option) any later version.                                   *</span>
<span class="sd"> *                                                                         *</span>
<span class="sd"> ***************************************************************************/</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">QSettings</span><span class="p">,</span> <span class="n">QTranslator</span><span class="p">,</span> <span class="n">qVersion</span><span class="p">,</span> <span class="n">QCoreApplication</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QIcon</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QAction</span><span class="p">,</span> <span class="n">QFileDialog</span>
<span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="n">QgsProject</span><span class="p">,</span> <span class="n">Qgis</span>

<span class="c1"># Initialize Qt resources from file resources.py</span>
<span class="kn">from</span> <span class="nn">.resources</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># Import the code for the dialog</span>
<span class="kn">from</span> <span class="nn">.save_attributes_dialog</span> <span class="kn">import</span> <span class="n">SaveAttributesDialog</span>
<span class="kn">import</span> <span class="nn">os.path</span>


<span class="k">class</span> <span class="nc">SaveAttributes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;QGIS Plugin Implementation.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iface</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        :param iface: An interface instance that will be passed to this class</span>
<span class="sd">            which provides the hook by which you can manipulate the QGIS</span>
<span class="sd">            application at run time.</span>
<span class="sd">        :type iface: QgsInterface</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Save reference to the QGIS interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iface</span> <span class="o">=</span> <span class="n">iface</span>
        <span class="c1"># initialize plugin directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
        <span class="c1"># initialize locale</span>
        <span class="n">locale</span> <span class="o">=</span> <span class="n">QSettings</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;locale/userLocale&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">locale_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span><span class="p">,</span>
            <span class="s1">&#39;i18n&#39;</span><span class="p">,</span>
            <span class="s1">&#39;SaveAttributes_</span><span class="si">{}</span><span class="s1">.qm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">locale</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">locale_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">translator</span> <span class="o">=</span> <span class="n">QTranslator</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">locale_path</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">qVersion</span><span class="p">()</span> <span class="o">&gt;</span> <span class="s1">&#39;4.3.3&#39;</span><span class="p">:</span>
                <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">installTranslator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="p">)</span>

        <span class="c1"># Declare instance attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;&amp;Save Attributes&#39;</span><span class="p">)</span>

        <span class="c1"># Check if plugin was started the first time in current QGIS session</span>
        <span class="c1"># Must be set in initGui() to survive plugin reloads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_start</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># noinspection PyMethodMayBeStatic</span>
    <span class="k">def</span> <span class="nf">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the translation for a string using Qt translation API.</span>

<span class="sd">        We implement this ourselves since we do not inherit QObject.</span>

<span class="sd">        :param message: String for translation.</span>
<span class="sd">        :type message: str, QString</span>

<span class="sd">        :returns: Translated version of message.</span>
<span class="sd">        :rtype: QString</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># noinspection PyTypeChecker,PyArgumentList,PyCallByClass</span>
        <span class="k">return</span> <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s1">&#39;SaveAttributes&#39;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">add_action</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">icon_path</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">,</span>
        <span class="n">enabled_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">add_to_menu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">add_to_toolbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">status_tip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">whats_this</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a toolbar icon to the toolbar.</span>

<span class="sd">        :param icon_path: Path to the icon for this action. Can be a resource</span>
<span class="sd">            path (e.g. &#39;:/plugins/foo/bar.png&#39;) or a normal file system path.</span>
<span class="sd">        :type icon_path: str</span>

<span class="sd">        :param text: Text that should be shown in menu items for this action.</span>
<span class="sd">        :type text: str</span>

<span class="sd">        :param callback: Function to be called when the action is triggered.</span>
<span class="sd">        :type callback: function</span>

<span class="sd">        :param enabled_flag: A flag indicating if the action should be enabled</span>
<span class="sd">            by default. Defaults to True.</span>
<span class="sd">        :type enabled_flag: bool</span>

<span class="sd">        :param add_to_menu: Flag indicating whether the action should also</span>
<span class="sd">            be added to the menu. Defaults to True.</span>
<span class="sd">        :type add_to_menu: bool</span>

<span class="sd">        :param add_to_toolbar: Flag indicating whether the action should also</span>
<span class="sd">            be added to the toolbar. Defaults to True.</span>
<span class="sd">        :type add_to_toolbar: bool</span>

<span class="sd">        :param status_tip: Optional text to show in a popup when mouse pointer</span>
<span class="sd">            hovers over the action.</span>
<span class="sd">        :type status_tip: str</span>

<span class="sd">        :param parent: Parent widget for the new action. Defaults None.</span>
<span class="sd">        :type parent: QWidget</span>

<span class="sd">        :param whats_this: Optional text to show in the status bar when the</span>
<span class="sd">            mouse pointer hovers over the action.</span>

<span class="sd">        :returns: The action that was created. Note that the action is also</span>
<span class="sd">            added to self.actions list.</span>
<span class="sd">        :rtype: QAction</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="n">icon_path</span><span class="p">)</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled_flag</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">status_tip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">action</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="n">status_tip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">whats_this</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">action</span><span class="o">.</span><span class="n">setWhatsThis</span><span class="p">(</span><span class="n">whats_this</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">add_to_toolbar</span><span class="p">:</span>
            <span class="c1"># Adds plugin icon to Plugins toolbar</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">addToolBarIcon</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">add_to_menu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">addPluginToVectorMenu</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">,</span>
                <span class="n">action</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">action</span>

    <span class="k">def</span> <span class="nf">initGui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the menu entries and toolbar icons inside the QGIS GUI.&quot;&quot;&quot;</span>

        <span class="n">icon_path</span> <span class="o">=</span> <span class="s1">&#39;:/plugins/save_attributes/icon.png&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_action</span><span class="p">(</span>
            <span class="n">icon_path</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Save Attributes as CSV&#39;</span><span class="p">),</span>
            <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">())</span>

        <span class="c1"># will be set False in run()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_start</span> <span class="o">=</span> <span class="kc">True</span>


    <span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes the plugin menu item and icon from QGIS GUI.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">removePluginVectorMenu</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;&amp;Save Attributes&#39;</span><span class="p">),</span>
                <span class="n">action</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">removeToolBarIcon</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">select_output_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="n">filename</span><span class="p">,</span> <span class="n">_filter</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="p">,</span> <span class="s2">&quot;Select   output file &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;*.csv&#39;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
      
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run method that performs all the real work&quot;&quot;&quot;</span>

        <span class="c1"># Create the dialog with elements (after translation) and keep reference</span>
        <span class="c1"># Only create GUI ONCE in callback, so that it will only load when the plugin is started</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_start</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">first_start</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="o">=</span> <span class="n">SaveAttributesDialog</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_output_file</span><span class="p">)</span>

        
        <span class="c1"># Fetch the currently loaded layers</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="n">QgsProject</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">layerTreeRoot</span><span class="p">()</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
        <span class="c1"># Clear the contents of the comboBox and lineEdit from previous runs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># Populate the comboBox with names of all the loaded layers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">])</span>
        
        <span class="c1"># show the dialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c1"># Run the dialog event loop</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
        <span class="c1"># See if OK was pressed</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
          <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
          <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
            <span class="n">selectedLayerIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
            <span class="n">selectedLayer</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="n">selectedLayerIndex</span><span class="p">]</span><span class="o">.</span><span class="n">layer</span><span class="p">()</span>
            <span class="n">fieldnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">fields</span><span class="p">()]</span>
            <span class="c1"># write header</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fieldnames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="c1"># write feature attributes</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
              <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fieldnames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span>
            <span class="s2">&quot;Success&quot;</span><span class="p">,</span> <span class="s2">&quot;Output file written at &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="n">Qgis</span><span class="o">.</span><span class="n">Success</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>





  <!-- Comment Section Powered by utterances -->
<div id="comments">
  <hr />
  <p>If you want to give feedback or share your experience with this tutorial, please comment below. (requires GitHub account)</p>
<script src="https://utteranc.es/client.js"
        repo="spatialthoughts/qgis-tutorials"
        issue-term="title"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2023, Ujaval Gandhi.<br/>
      آخرین بروز رسانی در اکتبر 13, 2024 .<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/3/building_a_python_plugin.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>