<!DOCTYPE html>

<html lang="zh_TW">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>資料表連接 (QGIS3) &#8212; QGIS Tutorials and Tips</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/translations.js"></script>
    <link rel="search" title="搜尋" href="../../search.html" />
    <link rel="next" title="空間連接 (QGIS3)" href="performing_spatial_joins.html" />
    <link rel="prev" title="Digitizing Map Data (QGIS3)" href="digitizing_basics.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>


<!-- Cookie Notice -->
<!-- Script from https://github.com/AOEpeople/cookie-notice -->
<script type="text/javascript" src="../../_static/cookie.notice.min.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1WQ7B80XJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B1WQ7B80XJ');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/logo.png"></span>
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">簡介</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">製作地圖 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Working with Attributes (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">匯入工作表或 CSV 檔 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">Basic Vector Styling (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">Calculating Line Lengths and Statistics (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">Basic Raster Styling and Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Raster Mosaicing and Clipping (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Working with Terrain Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Working with WMS Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">Working with Projections (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">為紙本地圖進行空間對位 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">為空照圖進行空間對位 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">Digitizing Map Data (QGIS3)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">資料表連接 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">空間連接 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">Performing Spatial Queries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Nearest Neighbor Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Sampling Raster Data using Points or Polygons (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_raster_area.html">Calculating Raster Area (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">製作熱區圖 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="animating_time_series.html">Animating Time Series Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="handling_invalid_geometries.html">Handling Invalid Geometries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_raster_analysis.html">Advanced Raster Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">Interpolating Point Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_intersection_density.html">Calculating Street Intersection Density (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">使用處理框架進行批次處理 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">利用處理建模自動執行複雜的工作流程 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">Automating Map Creation with Print Layout Atlas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_criteria_overlay.html">Multi Criteria Overlay Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_network_analysis.html">Basic Network Visualization and Routing (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="origin_destination_matrix.html">Locating Nearest Facility with Origin-Destination Matrix (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="service_area_analysis.html">Service Area Analysis using Openrouteservice (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="travel_time_analysis.html">Travel Time Analysis with Uber Movement (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="areal_mean_rainfall.html">Calculating Areal Mean Rainfall (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Python 程式設計的初步上手 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_algorithms_pyqgis.html">Running Processing Algorithms via Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">使用自訂的 Python 表達式函數 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">撰寫 Python 腳本並在處理框架下執行（QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_a_python_plugin.html">以 Python 製作附加元件 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_plugin.html">Building a Processing Plugin (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_qgis_jobs.html">執行 QGIS 工作排程</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">Web Mapping with QGIS2Web (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_basemaps_with_qtiles.html">用 QTiles 製作底圖</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Using Plugins (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloading_osm_data.html">搜尋和下載開放街圖資料</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning_resources.html">QGIS 學習資源</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">資料來源</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_processing.html">使用處理框架進行批次處理 (QGIS2)</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="digitizing_basics.html" title="Previous Chapter: Digitizing Map Data (QGIS3)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Digitizing Ma...</span>
    </a>
  </li>
  <li>
    <a href="performing_spatial_joins.html" title="Next Chapter: 空間連接 (QGIS3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">空間連接 (QGIS3) &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>
<hr>
<p>Want to learn QGIS in a structured way? Check out <a href="https://spatialthoughts.com/" target="_blank">Spatial Thoughts</a> for more learning materials and instructor-led online programs with QGIS.org certification.</p>


<h4>Change Language</h4>
<form role="form" class="sidebar-form sidebar-left">
<select id="languages" class="form-control select-mini">
  <option value="en">English</option>
  <option value="zh_TW">Chinese (Taiwan)</option>
  <option value="nl">Dutch</option>
  <option value="fi_FI">Finnish</option>
  <option value="fr">French</option>
  <option value="de">German</option>
  <option value="el">Greek</option>
  <option value="id">Indonesian</option>
  <option value="it">Italian</option>
  <option value="ko">Korean</option>
  <option value="fa">Persian</option>
  <option value="pt_BR">Portuguese</option>
  <option value="ro">Romanian</option>
  <option value="ru">Russian</option>
  <option value="sl">Slovenian</option>
  <option value="es">Spanish</option>
  <option value="th">Thai</option>
  <option value="tr">Turkish</option>
  <option value="uk">Ukrainian</option>
  <option value="vi">Vietnamese</option>
</select>
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      

  <section id="performing-table-joins-qgis3">
<h1>資料表連接 (QGIS3)<a class="headerlink" href="#performing-table-joins-qgis3" title="本標題的永久連結">¶</a></h1>
<p>Not every dataset you want to use comes in a spatial format, and often the data would come as tabular data like CSV, TSV, or spreadsheet. You need to link it with the existing spatial data for use in your analysis. This operation is known as the <strong>Table Join</strong> and is done using the <code class="docutils literal notranslate"><span class="pre">Join</span> <span class="pre">attributes</span> <span class="pre">by</span> <span class="pre">field</span> <span class="pre">value</span></code> from the Processing algorithm Toolbox.</p>
<section id="overview-of-the-task">
<h2>內容說明<a class="headerlink" href="#overview-of-the-task" title="本標題的永久連結">¶</a></h2>
<p>We will use a shapefile of census tracts for California and a population data table from US Census Bureau to create a population density map for California.</p>
<section id="other-skills-you-will-learn">
<h3>你還會學到這些<a class="headerlink" href="#other-skills-you-will-learn" title="本標題的永久連結">¶</a></h3>
<ul class="simple">
<li><p>Loading a CSV files that do not contain any geometry in QGIS.</p></li>
<li><p>Eliminate additional headers in CSV.</p></li>
<li><p>Add an additional column to a layer.</p></li>
<li><p>Style an layer with transparent stroke.</p></li>
</ul>
</section>
</section>
<section id="get-the-data">
<h2>取得資料<a class="headerlink" href="#get-the-data" title="本標題的永久連結">¶</a></h2>
<p>We want to prepare a population density map for the state of California, USA. We will first get a table with population counts for each census tract in the state.</p>
<section id="download-census-table">
<h3>Download Census Table<a class="headerlink" href="#download-census-table" title="本標題的永久連結">¶</a></h3>
<ol class="arabic simple">
<li><p>Visit <a class="reference external" href="https://data.census.gov/cedsci/">US Census Bureau</a>  and click <span class="guilabel">VIEW TABLES</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data012.png" class="align-center" src="../../_images/data012.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Click on the <span class="guilabel">Filters</span> icon in top-left.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data022.png" class="align-center" src="../../_images/data022.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Let’s first filter to California. Click on <span class="guilabel">Geography</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data031.png" class="align-center" src="../../_images/data031.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Click on <span class="guilabel">Tract</span>, which can provide the census tract information.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data041.png" class="align-center" src="../../_images/data041.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Choose <span class="guilabel">California</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data05.png" class="align-center" src="../../_images/data05.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>Check <span class="guilabel">All Census Tracts within California</span>. This allows us to download all information as a single file instead of downloading it separately for each tract. Now that we have set the geography, click on <span class="guilabel">Topics</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data06.png" class="align-center" src="../../_images/data06.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>Under <span class="guilabel">Select Topics</span>, choose <span class="guilabel">Population and People</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data07.png" class="align-center" src="../../_images/data07.png" />
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>Check the <span class="guilabel">Population and People</span>. Now we have selected all the necessary filters. Close the filter window.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data08.png" class="align-center" src="../../_images/data08.png" />
</div></blockquote>
<ol class="arabic simple" start="9">
<li><p>In the <span class="guilabel">Download tables</span> pane scroll down to find <span class="guilabel">S0101 | AGE AND SEX</span></p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data09.png" class="align-center" src="../../_images/data09.png" />
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>This will open a detailed view of the data. We are concerned with only the population hence un-select the <span class="guilabel">Margin of Error</span> so we can get the necessary information only and save on file storage space.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data101.png" class="align-center" src="../../_images/data101.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>Click on the <span class="guilabel">Download</span> button.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data113.png" class="align-center" src="../../_images/data113.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>The selected data is available for multiple years and using different estimation techniques. The <span class="guilabel">ACS 5-Year Estimate Subject Tables</span> is recommended as multi-year estimates increases the reliability of the data. It also has no data gaps and contains information for all tracts. Select the year <code class="docutils literal notranslate"><span class="pre">2019</span></code>. and click <span class="guilabel">Download</span>. This will download a zip file. Once it finishes, unzip it on your local disk.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data122.png" class="align-center" src="../../_images/data122.png" />
</div></blockquote>
</section>
<section id="download-census-tract-boundaries">
<h3>Download Census Tract Boundaries<a class="headerlink" href="#download-census-tract-boundaries" title="本標題的永久連結">¶</a></h3>
<p>To create a map from the census table, we also need the boundaries representing each census tract in the state of California.</p>
<ol class="arabic simple">
<li><p>Visit <a class="reference external" href="https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2019.html">TIGER Line Shapefiles</a>  and click <span class="guilabel">Web Interface</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data131.png" class="align-center" src="../../_images/data131.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Under <span class="guilabel">Select year</span> choose <code class="docutils literal notranslate"><span class="pre">2019</span></code>, in <span class="guilabel">Select a layer type</span> <code class="docutils literal notranslate"><span class="pre">Census</span> <span class="pre">Tracts</span></code> and click <span class="guilabel">Submit</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data141.png" class="align-center" src="../../_images/data141.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Select <code class="docutils literal notranslate"><span class="pre">California</span></code> in <span class="guilabel">Select a State</span> and click <span class="guilabel">Download</span>. This will download a zip file containing the vector files.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data151.png" class="align-center" src="../../_images/data151.png" />
</div></blockquote>
<p>為了方便起見，你也可以直接用下面的連結下載這兩份資料集：</p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/tl_2019_06_tract.zip">tl_2019_06_tract.zip</a></p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/ACST5Y2019_S0101.zip">ACST5Y2019_S0101.zip</a></p>
<p>資料來源 <a class="reference internal" href="../credits.html#tiger" id="id1"><span>[TIGER]</span></a> <a class="reference internal" href="../credits.html#uscensus" id="id2"><span>[USCENSUS]</span></a></p>
</section>
</section>
<section id="procedure">
<h2>操作流程<a class="headerlink" href="#procedure" title="本標題的永久連結">¶</a></h2>
<ol class="arabic simple">
<li><p>Locate the <code class="docutils literal notranslate"><span class="pre">tl_2019_06_tract.zip</span></code> file in the QGIS Browser and expand it. Select the <code class="docutils literal notranslate"><span class="pre">tl_2019_06_tract.shp</span></code> file and drag it to the canvas.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/018.png" class="align-center" src="../../_images/018.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>The <span class="guilabel">Select Transformation</span> dialog will prompt to convert from <em>EPSG:4269</em> to <em>EPSG:4326</em>.  This dialog presents several transformations to convert between the coordinates between these projections. Leave the selection to the default choice and click <span class="guilabel">OK</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/028.png" class="align-center" src="../../_images/028.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>You will see the layer <code class="docutils literal notranslate"><span class="pre">tl_2019_06_tract</span></code> loaded in the <span class="guilabel">Layers</span> panel. This layer contains the boundaries of census tracts in California. Right-click on the <code class="docutils literal notranslate"><span class="pre">tl_2019_06_tract</span></code> layer and select <span class="guilabel">Open Attribute Table</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/038.png" class="align-center" src="../../_images/038.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Examine the attributes of the layer. To join a table with this layer, we need each feature’s unique and common attribute. In this case, there are 8057 individual tract records with the <code class="docutils literal notranslate"><span class="pre">GEOID</span></code> field. This column can link this layer with any other layer or table containing the same ID.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/048.png" class="align-center" src="../../_images/048.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>To load the tabular data, click on <span class="guilabel">Open Data Source Manager</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/058.png" class="align-center" src="../../_images/058.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>In the <span class="guilabel">Data Source Manager</span> dialog, choose <span class="guilabel">Delimited Text</span>. Then in the right, click on the <code class="docutils literal notranslate"><span class="pre">...</span></code> next to <span class="guilabel">File name</span> and browse to the unzipped folder with the California population CSV.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/068.png" class="align-center" src="../../_images/068.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>Now under <span class="guilabel">Sample Data</span>, we can inspect the data even before loading it as a layer. The representation shows that the data table contains  2 header rows.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/078.png" class="align-center" src="../../_images/078.png" />
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>To eliminate the additional header row, under <span class="guilabel">Record and Fields Options</span> set the <span class="guilabel">Number of header line to discard</span> to <code class="docutils literal notranslate"><span class="pre">1</span></code>. Now the table will contain proper column headers. Since this layer contains only tabular data, select <code class="docutils literal notranslate"><span class="pre">No</span> <span class="pre">geometry</span> <span class="pre">(attribute</span> <span class="pre">only</span> <span class="pre">table)</span></code> under <span class="guilabel">Geometry Definition</span>. Click <span class="guilabel">Add</span> to add it as a layer and then click <span class="guilabel">Close</span> to close this dialog box.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/087.png" class="align-center" src="../../_images/087.png" />
</div></blockquote>
<ol class="arabic simple" start="9">
<li><p>The CSV will now be imported as a table to QGIS and appear as <code class="docutils literal notranslate"><span class="pre">ACST5Y2019.S0101</span></code> in the <span class="guilabel">Layers</span> panel. Now right-click on the layer and select <span class="guilabel">Open Attribute Table</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/097.png" class="align-center" src="../../_images/097.png" />
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>The <code class="docutils literal notranslate"><span class="pre">ID</span></code> column contains the unique id for each record, which can be used to join this table with the <code class="docutils literal notranslate"><span class="pre">tl_2019_06_tract</span></code> layer. If you compare the values of the <code class="docutils literal notranslate"><span class="pre">ID</span></code> with the <code class="docutils literal notranslate"><span class="pre">GEOID</span></code> column from the  <code class="docutils literal notranslate"><span class="pre">tl_2019_06_tract</span></code>. you will notice that it is prefixed with <em>1400000US</em>. To merge these two tables successfully, the values must match exactly. Let’s remove this prefix and add a new column with the last 11 characters which contain the value that is an exact match.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1024.png" class="align-center" src="../../_images/1024.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>To create a new column with the last 11 digits, open the Processing Toolbox by going to <span class="menuselection">Processing ‣ Toolbox</span>, and search and locate the <span class="menuselection">Vector table ‣ Field calculator</span> algorithm.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1127.png" class="align-center" src="../../_images/1127.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>In the <span class="guilabel">Field calculator</span> dialog, select <code class="docutils literal notranslate"><span class="pre">ACST5Y2019.S0101</span></code> as the <span class="guilabel">Input layer</span>, enter <code class="docutils literal notranslate"><span class="pre">geoid</span></code> in <span class="guilabel">Field name</span>, and select <code class="docutils literal notranslate"><span class="pre">string</span></code> in <span class="guilabel">Result Field type</span>. Now search for <code class="docutils literal notranslate"><span class="pre">substr</span></code> in expressions. We can use this function to extract the required part from the id field.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1225.png" class="align-center" src="../../_images/1225.png" />
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>Enter the below expression. We use the <cite>substr</cite> function and extract the value from position <em>-11</em> (negative value is counted from the end). The final result can be viewed in the <span class="guilabel">Preview</span> section. Click <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">substr</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/1323.png" class="align-center" src="../../_images/1323.png" />
</div></blockquote>
<ol class="arabic simple" start="14">
<li><p>Now a new layer <code class="docutils literal notranslate"><span class="pre">Calculated</span></code> will be loaded in the canvas, lets inspect the attribute table. A new column <code class="docutils literal notranslate"><span class="pre">geoid</span></code> with the value that can be matched with the cencus tract will be present.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1421.png" class="align-center" src="../../_images/1421.png" />
</div></blockquote>
<ol class="arabic simple" start="15">
<li><p>To create a table join, open the Processing Toolbox by going to <span class="menuselection">Processing ‣ Toolbox</span>, and search and locate the <span class="menuselection">Vector general ‣ Join attributes by field value</span> algorithm.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1519.png" class="align-center" src="../../_images/1519.png" />
</div></blockquote>
<ol class="arabic simple" start="16">
<li><p>In the <span class="guilabel">Join attributes by field value</span> dialog, select <code class="docutils literal notranslate"><span class="pre">tl_2019_06_tract</span></code> as the <span class="guilabel">Input layer</span> and <code class="docutils literal notranslate"><span class="pre">GEOID</span></code> as the <span class="guilabel">Table field</span>. Select <code class="docutils literal notranslate"><span class="pre">Calculated</span></code> as the <span class="guilabel">Input layer 2</span> and <code class="docutils literal notranslate"><span class="pre">geoid</span></code> as the <span class="guilabel">Table field 2</span>. Under <span class="guilabel">Layer2 fields to copy</span>, click on the <code class="docutils literal notranslate"><span class="pre">...</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1618.png" class="align-center" src="../../_images/1618.png" />
</div></blockquote>
<ol class="arabic simple" start="17">
<li><p>Check <code class="docutils literal notranslate"><span class="pre">Geographic</span> <span class="pre">Area</span> <span class="pre">Name</span></code>, <code class="docutils literal notranslate"><span class="pre">Estimate!!Total!!Total</span> <span class="pre">population</span></code> and <code class="docutils literal notranslate"><span class="pre">geoid</span></code>. Click <span class="guilabel">OK</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1719.png" class="align-center" src="../../_images/1719.png" />
</div></blockquote>
<ol class="arabic simple" start="18">
<li><p>Check the <span class="guilabel">Discard records which could not be joined</span>. This will eliminate any extra records in the population table. Click the <span class="guilabel">…</span> button under <span class="guilabel">joined layer</span> to select the output file location and select <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">to</span> <span class="pre">File...</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1817.png" class="align-center" src="../../_images/1817.png" />
</div></blockquote>
<ol class="arabic simple" start="19">
<li><p>Name the output geopackage as <code class="docutils literal notranslate"><span class="pre">california_total_population.gpkg</span></code> . Click <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1914.png" class="align-center" src="../../_images/1914.png" />
</div></blockquote>
<ol class="arabic simple" start="20">
<li><p>Once the processing finishes, verify that the algorithm was successful if all 8057 feature(s) are joined. Click <span class="guilabel">Close</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2013.png" class="align-center" src="../../_images/2013.png" />
</div></blockquote>
<ol class="arabic simple" start="21">
<li><p>You will see a new layer <code class="docutils literal notranslate"><span class="pre">california_total_population</span></code> loaded in the <span class="guilabel">Layers</span> panel. At this point, the fields from the CSV file are joined with the census tracts layer. Now that we have the population data in the census tracts layer, we can style it to create a visualization of population density distribution. Click the <span class="guilabel">Open the Layer Styling Panel</span> button.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2116.png" class="align-center" src="../../_images/2116.png" />
</div></blockquote>
<ol class="arabic simple" start="22">
<li><p>In the <span class="guilabel">Layer Styling</span> panel, select <code class="docutils literal notranslate"><span class="pre">Graduated</span></code> from the drop-down menu. As we are looking to create a population density map, we want to assign different color to each census tract feature based on the population density. We have the population in the <strong>Estimate!!Total!!Total population</strong> field, and the area field in <strong>ALAND</strong>. Click <span class="guilabel">Expression</span> button, to compute the percentage of total population in each cencus tract.</p></li>
</ol>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">備註</p>
<p>When creating a thematic (choropleth) map such as this, it is important to normalize the values you are mapping. Mapping total counts per polygon is not correct. It is important to normalize the values dividing by the area. If you are displaying totals such as crime, you can normalize them by dividing by total population, thus mapping crime rate and not crime. <a class="reference external" href="https://en.wikipedia.org/wiki/Choropleth_map#Normalization">Learn more</a></p>
</div>
<img alt="../../_images/2215.png" class="align-center" src="../../_images/2215.png" />
</div></blockquote>
<ol class="arabic simple" start="23">
<li><p>Enter the following expression to calculate the population density. The area of the feature is given in square kilometers. We then convert it to square meters by multiplying with <code class="docutils literal notranslate"><span class="pre">1000000</span></code> and calculating the population density with the formula <em>Population/Area</em>. Preview the result and click <span class="guilabel">OK</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1000000</span> <span class="o">*</span> <span class="p">(</span><span class="s2">&quot;Estimate!!Total!!Total population&quot;</span><span class="o">/</span><span class="s2">&quot;ALAND&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/2314.png" class="align-center" src="../../_images/2314.png" />
</div></blockquote>
<ol class="arabic simple" start="24">
<li><p>In the <span class="guilabel">Layer Styling Panel</span>, click <span class="guilabel">classify</span> and enter the classes as <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2413.png" class="align-center" src="../../_images/2413.png" />
</div></blockquote>
<ol class="arabic simple" start="25">
<li><p>Click on the color ramp to choose the color ramp <code class="docutils literal notranslate"><span class="pre">RdYlGn</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2511.png" class="align-center" src="../../_images/2511.png" />
</div></blockquote>
<ol class="arabic simple" start="26">
<li><p>The higher density concerns more so, let’s assign green to lower density and red to high-density areas. Click on the color ramp and choose <span class="guilabel">Invert Color Ramp</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2610.png" class="align-center" src="../../_images/2610.png" />
</div></blockquote>
<ol class="arabic simple" start="27">
<li><p>Now we have an excellent looking information visualization of population density in California. To make it better, let’s make the border of each census tract transparent. Click on the Symbol tab.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2711.png" class="align-center" src="../../_images/2711.png" />
</div></blockquote>
<ol class="arabic simple" start="28">
<li><p>Click on <span class="guilabel">Stroke color</span> and click <code class="docutils literal notranslate"><span class="pre">Transparent</span> <span class="pre">stroke</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2810.png" class="align-center" src="../../_images/2810.png" />
</div></blockquote>
<ol class="arabic simple" start="29">
<li><p>The bins can be adjusted, click on the <span class="guilabel">Values</span> this will popup a dialog to enter the upper and lower bound value.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/299.png" class="align-center" src="../../_images/299.png" />
</div></blockquote>
<ol class="arabic simple" start="30">
<li><p>Once your satisfied close the Layer styling panel. We now have a nice looking information visualization of population density in California.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/308.png" class="align-center" src="../../_images/308.png" />
</div></blockquote>
</section>
</section>





  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, Ujaval Gandhi.<br/>
      最後更新於 11月 04, 2022。<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.1.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/3/performing_table_joins.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>