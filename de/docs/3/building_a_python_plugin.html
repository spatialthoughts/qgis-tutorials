<!DOCTYPE html>

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Ein Python Plugin erstellen (QGIS3) &#8212; QGIS Tutorials and Tips</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/translations.js"></script>
    <link rel="search" title="Suche" href="../../search.html" />
    <link rel="next" title="Ein Verarbeitungsplugin erstellen (QGIS3)" href="processing_python_plugin.html" />
    <link rel="prev" title="Pythonscripts für die Verarbeitungswerkzeuge schreiben (QGIS3)" href="processing_python_scripts.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>


<!-- Cookie Notice -->
<!-- Script from https://github.com/AOEpeople/cookie-notice -->
<script type="text/javascript" src="../../_static/cookie.notice.min.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1WQ7B80XJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B1WQ7B80XJ');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/logo.png"></span>
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Einleitung</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">Erstellung einer Karte (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Arbeit mit Attributen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">Import von Tabellenblättern oder CSV-Dateien (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">Einfache Vektor Gestaltung (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">Berechnung der Länge von Linien und Statistiken (QGSI3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">Einfache Visualisierung und Analyse von Rasterdaten (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Erstellen und Zuschneiden eines Raster-Mosaiks (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Working with Terrain Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Working with WMS Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">Working with Projections (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">Georeferenzierung von Kartenblättern und eingescannten Karten (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">Georeferenzierung von Luftbildern (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">Digitizing Map Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins.html">Tabellen verbinden (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">Räumliche Verbindungen erstellen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">Räumliche Abfragen ausführen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Nächster Nachbar Analyse (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Stichproben aus Rasterdaten mit Hilfe von Punkten und Polygonen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_raster_area.html">Calculating Raster Area (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">Heatmaps erstellen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="animating_time_series.html">Animating Time Series Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="handling_invalid_geometries.html">Handling Invalid Geometries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_raster_analysis.html">Advanced Raster Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">Interpolating Point Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_intersection_density.html">Calculating Street Intersection Density (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">Stapelverarbeitung mit dem Processing Framework (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">Komplexe Arbeitsabläufe mit Hilfe der Verarbeitungsmodellierung (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">Automatisierung der Kartenerstellung mit dem Drucklayout Atlas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_criteria_overlay.html">Multi Criteria Overlay Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_network_analysis.html">Einfache Netzwerkvisualisierung und Routing (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="origin_destination_matrix.html">Lokalisierung der am nächsten gelegenen Einrichtung mit einer Quelle-Ziel-Matrix (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="service_area_analysis.html">Einzugsgebietsanalyse mit dem Openrouteservice (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="travel_time_analysis.html">Travel Time Analysis with Uber Movement (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="areal_mean_rainfall.html">Calculating Areal Mean Rainfall (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Mit der Pythonprogrammierung loslegen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_algorithms_pyqgis.html">Verarbeitungsroutinen mit Python ausführen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">Angepasste Python Funktionsausdrücke verwenden (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">Pythonscripts für die Verarbeitungswerkzeuge schreiben (QGIS3)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Ein Python Plugin erstellen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_plugin.html">Ein Verarbeitungsplugin erstellen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_qgis_jobs.html">Running and Scheduling QGIS Processing Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">Web Mapping with QGIS2Web (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_basemaps_with_qtiles.html">Creating Basemaps with QTiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Using Plugins (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloading_osm_data.html">Suchen und Laden von OpenStreetMap Daten</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning_resources.html">QGIS Learning Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Data Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_processing.html">Batch Processing using Processing Framework (QGIS2)</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="processing_python_scripts.html" title="Previous Chapter: Pythonscripts für die Verarbeitungswerkzeuge schreiben (QGIS3)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Pythonscripts...</span>
    </a>
  </li>
  <li>
    <a href="processing_python_plugin.html" title="Next Chapter: Ein Verarbeitungsplugin erstellen (QGIS3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Ein Verarbeit... &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>
<hr>
<p>Want to learn QGIS in a structured way? Check out <a href="https://spatialthoughts.com/" target="_blank">Spatial Thoughts</a> for more learning materials and instructor-led online programs with QGIS.org certification.</p>


<h4>Change Language</h4>
<form role="form" class="sidebar-form sidebar-left">
<select id="languages" class="form-control select-mini">
  <option value="en">English</option>
  <option value="zh_TW">Chinese (Taiwan)</option>
  <option value="nl">Dutch</option>
  <option value="fi_FI">Finnish</option>
  <option value="fr">French</option>
  <option value="de">German</option>
  <option value="el">Greek</option>
  <option value="id">Indonesian</option>
  <option value="it">Italian</option>
  <option value="ko">Korean</option>
  <option value="fa">Persian</option>
  <option value="pt_BR">Portuguese</option>
  <option value="ro">Romanian</option>
  <option value="ru">Russian</option>
  <option value="sl">Slovenian</option>
  <option value="es">Spanish</option>
  <option value="th">Thai</option>
  <option value="tr">Turkish</option>
  <option value="uk">Ukrainian</option>
  <option value="vi">Vietnamese</option>
</select>
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      

  <section id="building-a-python-plugin-qgis3">
<h1>Ein Python Plugin erstellen (QGIS3)<a class="headerlink" href="#building-a-python-plugin-qgis3" title="Link zu dieser Überschrift">¶</a></h1>
<p>Erweiterungen sind ein großartiger Weg, um die Funktionalität von QGIS zu erweitern. Man kann mit Python Erweiterungen schreiben, die einen einfachen Knopf hinzufügen oder auch ausgefeilte Werkzeuge erstellen. Diese Anleitung umreißt den Ablauf zum Aufsetzen der Entwicklungsumgebung, zum Entwurf einer Benutzeroberfläche der Erweiterung und zum Schreiben von Programmcode zur Interaktion mit QGIS. Um sich mit den Grundlagen vertraut zu machen, ist es sinnvoll sich noch einmal folgende Anleitung anzusehen: <a class="reference internal" href="getting_started_with_pyqgis.html"><span class="doc">Mit der Pythonprogrammierung loslegen (QGIS3)</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>If you are building a new plugin, I strongly recommend building a Processing Plugin instead of the GUI plugin described in this tutorial. See  <a class="reference internal" href="processing_python_plugin.html"><span class="doc">Ein Verarbeitungsplugin erstellen (QGIS3)</span></a> for details.</p>
</div>
<section id="overview-of-the-task">
<h2>Überblick über die Aufgabe<a class="headerlink" href="#overview-of-the-task" title="Link zu dieser Überschrift">¶</a></h2>
<p>Wir werden ein einfaches Plugin mit dem Namen <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Attributes</span></code> erstellen, das es dem Nutzer erlaubt, einen Vektor-Layer auszuwählen und seine Attribute in einer CSV-Datei zu sichern.</p>
</section>
<section id="get-the-tools">
<h2>Die Werkzeuge beschaffen<a class="headerlink" href="#get-the-tools" title="Link zu dieser Überschrift">¶</a></h2>
<section id="qt-creator">
<h3>Qt Creator<a class="headerlink" href="#qt-creator" title="Link zu dieser Überschrift">¶</a></h3>
<p><a class="reference external" href="http://www.qt.io/">Qt</a> ist ein Anwendungsframework, das zur Entwicklung von Anwendungen unter Windows, Mac, Linux und verschiedenen mobilen Betriebssystemen genutzt wird. QGIS selbst wird unter Nutzung des Qt-Frameworks entwickelt. Bei der Entwicklung unserer Erweiterung werden wir zur Gestaltung der Benutzerschnittstelle eine Anwendung mit dem Namen <a class="reference external" href="https://doc.qt.io/qt-5/qtdesigner-manual.html">Qt Creator</a> verwenden.</p>
<p>Lade Qt Creator von folgender Adresse herunter <a class="reference external" href="https://www.qt.io/offline-installers">Qt Offline Installers</a> und installiere es. Denke daran <strong>Qt Creator</strong> unter download auszuwählen. Beachte, dass du ein freies Qt Konto vor der Installation erstellen musst.</p>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Die Installationsverwaltung für Windows OSGeo4w enthält eine Kopie von  <strong>Qt Designer</strong>, einer vereinfachten Version von <strong>Qt Creator</strong>, die perfekt zur Erstellung von Erweiterungen geeignet ist. Wenn man QT Designer von <span class="menuselection">C:\OSGeo4W64\bin\qgis-designer</span> verwendet, muss man Qt Creator nicht herunterladen.</p>
</div>
<img alt="../../_images/setup1.png" class="align-center" src="../../_images/setup1.png" />
</section>
<section id="python-bindings-for-qt">
<h3>Python Bindings für Qt<a class="headerlink" href="#python-bindings-for-qt" title="Link zu dieser Überschrift">¶</a></h3>
<p>Da wir die Erweiterung in Python entwickeln, benötigen wir die Python Bindings für Qt. Das Verfahren zur Installation der Bindings hängt von der verwendeten Plattform ab. Um Erweiterungen zu erstellen, benötigen wir das Kommandozeilentool <code class="docutils literal notranslate"><span class="pre">pyrcc5</span></code>.</p>
<p><strong>Windows</strong></p>
<p>Relevant python bindings are included in the QGIS install on Windows. But to use them from the plugin folder, we need to indicate the path to the QGIS install.</p>
<p>Erstelle eine Windows-Batch Datei (.bat Erweiterung) mit folgendem Inhalt und speichere sie auf dem Rechner als <code class="docutils literal notranslate"><span class="pre">compile.bat</span></code> ab. Wir werden die Datei später in den plugin Ordner kopieren. Wenn QGIS in einem anderen Verzeichnis installiert ist, muss der Pfad <code class="docutils literal notranslate"><span class="pre">C:\OSGeo4W64\bin\</span></code> entsprechend angepasst werden.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@echo off
call &quot;C:\OSGeo4W64\bin\o4w_env.bat&quot;
call &quot;C:\OSGeo4W64\bin\qt5_env.bat&quot;
call &quot;C:\OSGeo4W64\bin\py3_env.bat&quot;

@echo on
pyrcc5 -o resources.py resources.qrc
</pre></div>
</div>
<img alt="../../_images/setup2.png" class="align-center" src="../../_images/setup2.png" />
<p><strong>Mac</strong></p>
<p>Installiere den Packetmanager <a class="reference external" href="http://brew.sh">Homebrew</a>. Installiere das Packet <code class="docutils literal notranslate"><span class="pre">PyQt</span></code> durch Ausführen des folgenden Kommandos:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>brew install pyqt
</pre></div>
</div>
<dl class="simple">
<dt><strong>Linux</strong></dt><dd><p>In Abhängigkeit von der Distribution muss folgendes Paket gesucht und installiert werden: <code class="docutils literal notranslate"><span class="pre">python-qt5</span></code>. Für Ubuntu and Debian-basierte Distributionen, kann folgendes Kommando verwendet werden:</p>
</dd>
</dl>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo apt-get install python-qt5
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Unter Umständen wurde das Paket schon vorher mit QGIS installiert.</p>
</div>
</section>
<section id="a-text-editor-or-a-python-ide">
<h3>Ein Texteditor oder eine Python IDE<a class="headerlink" href="#a-text-editor-or-a-python-ide" title="Link zu dieser Überschrift">¶</a></h3>
<p>Jede Art von Softwareentwicklung erfordert einen guten Texteditor. Wenn man schon einen Lieblingstexteditor oder eine IDE (Integrated Development Environment - Softwareentwicklungsumgebung) hat, kann man sie hier verwenden. Ansonsten bieten alle Plattformen eine Vielzahl  an freien oder kommerziellen Möglichkeiten für einen Texteditor. Wähle den Editor entsprechend deiner Erfordernisse aus.</p>
<p>In dieser Anleitung wird der Editor Notepad++ für Windows verwendet.</p>
<p><strong>Windows</strong></p>
<p><a class="reference external" href="http://notepad-plus-plus.org/">Notepad++</a> ist ein guter und freier Editor für Windows. Lade den Editor unter &lt;<a class="reference external" href="https://notepad-plus-plus.org/download/">https://notepad-plus-plus.org/download/</a>&gt;`_ herunter und installiere ihn.</p>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Wenn man Notepad++ verwendet, muss man darauf achten, dass unter <span class="menuselection">Einstellungen ‣ Optionen ‣ Tabulator Einstellungen</span> die Einstellung <span class="guilabel">Durch Leerzeichen ersetzen</span> gewählt ist. Python ist sehr  empfindlich bezüglich Leerzeichen und diese Einstellung stellt sicher, dass Tabulator und Leerzeichen richtig ausgewertet werden.</p>
</div>
</section>
<section id="plugin-builder-plugin">
<h3>Plugin Builder Erweiterung<a class="headerlink" href="#plugin-builder-plugin" title="Link zu dieser Überschrift">¶</a></h3>
<p>Es gibt eine nützliche QGIS Erweiterung <code class="docutils literal notranslate"><span class="pre">Plugin</span> <span class="pre">Builder</span></code>, die alle notwendigen Dateien und  eine Vorlage des Programmcodes für die Erweiterung erstellt. Finde und installiere die Erweiterung <code class="docutils literal notranslate"><span class="pre">Plugin</span> <span class="pre">Builder</span></code>. Unter <a class="reference internal" href="../using_plugins.html"><span class="doc">Verwenden von Erweiterungen</span></a> findet man weitere Details zur Installation von Erweiterungen.</p>
</section>
<section id="plugins-reloader-plugin">
<h3>Plugins Reloader Erweiterung<a class="headerlink" href="#plugins-reloader-plugin" title="Link zu dieser Überschrift">¶</a></h3>
<p>Dies ist eine andere Erweiterung, die die schrittweise Entwicklung von Erweiterungen ermöglicht. Mit Hilfe dieser Erweiterung kann man den Programmcode der Erweiterung ändern und die Auswirkung in QGIS sehen, ohne QGIS jedes Mal neu starten zu müssen. Finde und installiere die Erweiterung <code class="docutils literal notranslate"><span class="pre">Plugin</span> <span class="pre">Reloader</span></code>. Unter <a class="reference internal" href="../using_plugins.html"><span class="doc">Verwenden von Erweiterungen</span></a> findet man weitere Details zur Installation von Erweiterungen.</p>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Plugin Reloader ist eine experimentelle Erweiterung. Man muss die Einstellung <span class="guilabel">Auch experimentelle Erweiterungen anzeigen</span> unter <span class="guilabel">Erweiterungen</span> zu aktivieren.</p>
</div>
</section>
</section>
<section id="procedure">
<h2>Arbeitsablauf<a class="headerlink" href="#procedure" title="Link zu dieser Überschrift">¶</a></h2>
<ol class="arabic simple">
<li><p>Öffne QGIS. Gehe zu <span class="menuselection">Erweiterungen ‣ Plugin Builder ‣ Plugin Builder</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/120.png" class="align-center" src="../../_images/120.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Wir sehen nun das Fenster <span class="guilabel">QGIS Plugin Builder</span> mit einem Formular. Wir füllen das Formular mit Details zu unserer Erweiterung. Das Feld <span class="guilabel">Class name</span> enthält den Namen der Python Klasse mit der Funktionalität der Erweiterung. Dieser Name wird auch dem Ordnernamen entsprechen, der alle zur Erweiterung gehörenden Dateien enthält. Wir verwenden <code class="docutils literal notranslate"><span class="pre">SaveAttributes</span></code> als Class name. Das Feld <span class="guilabel">Plugin name</span> ist der Name unter dem die Erweiterung im <span class="guilabel">Plugin Manager</span> erscheinen wird. Wir geben hier <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Attributes</span></code> ein. Im Feld <span class="guilabel">Description</span> fügen wir eine Beschreibung hinzu. Das Feld <span class="guilabel">Module name</span> enthält den Namen der Python Hauptdatei der Erweiterung. Wir geben hier <code class="docutils literal notranslate"><span class="pre">save_attributes</span></code> ein. Wir lassen die Versionsnummer unverändert und geben unseren Namen und E-mail Adresse in die entsprechenden Felder ein. Klicke auf <span class="guilabel">Next</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/218.png" class="align-center" src="../../_images/218.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Gebe eine kurze Beschreibung der Erweiterung im Eingabefenster <span class="guilabel">About</span> ein und klicke auf <span class="guilabel">Next</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/316.png" class="align-center" src="../../_images/316.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Wähle <code class="docutils literal notranslate"><span class="pre">Tool</span> <span class="pre">button</span> <span class="pre">with</span> <span class="pre">dialog</span></code> im Auswahlfeld <span class="guilabel">Template</span> selector`. Im Feld <span class="guilabel">Text for menu item</span> enthält die Bezeichnung der Erweiterung im QGIS Menü, die der Nutzer vorfindet. Wir geben <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Attributes</span> <span class="pre">as</span> <span class="pre">CSV</span></code> ein. Das <span class="guilabel">Menu</span> Feld legt fest, an welcher Stelle die Erweiterung in QGIS eingefügt wird. Da unsere Erweiterung für Vektordaten gedacht ist, wählen wir <code class="docutils literal notranslate"><span class="pre">Vektor</span></code>. Klicke auf <span class="guilabel">Next</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/45.png" class="align-center" src="../../_images/45.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Der Plugin Builder fragt nun nach den zu generierenden Dateitypen, Wir belassen die Standardeinstellung und klicken auf <span class="guilabel">Next</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/55.png" class="align-center" src="../../_images/55.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>Da wir die Erweiterung nicht veröffentlichen wollen, können wir die Einträge <span class="guilabel">Bug tracker</span>, <span class="guilabel">Repository</span> und <span class="guilabel">Home page</span> unverändert lassen. Wir setzen den Haken bei <span class="guilabel">Flag the plugin as experimental</span> und kicken auf <span class="guilabel">Next</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/65.png" class="align-center" src="../../_images/65.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>Wir werden als Nächstes aufgefordert, ein Verzeichnis für die Erweiterung zu vergeben. Fürs Erste geben wir zum Speichern ein lokales Verzeichnis an, das wir leicht erreichen und klicken auf <span class="guilabel">Generate</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/75.png" class="align-center" src="../../_images/75.png" />
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>Drücke jetzt auf den <span class="guilabel">generate</span> Knopf. Wir erhalten ein Bestätigung, sobald die Vorlage der Erweiterung erstellt wurde.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/85.png" class="align-center" src="../../_images/85.png" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Unter Umständen erhalten wir eine Meldung, dass pyrcc5 nicht im Pfad gefunden wurde. Wir können die Meldung ignorieren.</p>
</div>
<ol class="arabic simple" start="9">
<li><p>Bevor wir die neu erstellte Erweiterung nutzen können, müssen wir die Datei <code class="docutils literal notranslate"><span class="pre">resources.qrc</span></code> kompilieren, die vom Plugin Builder erstellt wurde. Diese Datei gehört zum <a class="reference external" href="https://doc.qt.io/qt-5/resources.html">Qt Resource System</a>, das den Bezug zu allen in der Erweiterung genutzten Binärdateien herstellt. Bei dieser Erweiterung ist das nur das Icon der Erweiterung. Beim Kompilieren entsteht Programmcode, der von der Erweiterung unabhängig von der genutzten Plattform verwendet werden kann. Folge im nächsten Schrit den plattformabhängigen Hinweisen.</p></li>
</ol>
<p><strong>Windows</strong></p>
<p>Wir können nun die Datei <code class="docutils literal notranslate"><span class="pre">compile.bat</span></code> (erstellt im Abschnitt <em>Python Bindings für Qt</em> am Beginn) in den Ordner der Erweiterung kopieren. Klicke nachdem die Datei kopiert wurde doppelt darauf, um sie auszuführen. Wenn der Start erfolgreich war, sehen wir eine neue Datei <code class="docutils literal notranslate"><span class="pre">resources.py</span></code> im Ordner.</p>
<blockquote>
<div><img alt="../../_images/95.png" class="align-center" src="../../_images/95.png" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Wenn dieser Schritt fehlschlägt, können wir <code class="docutils literal notranslate"><span class="pre">cmd.exe</span></code> starten und mit Hilfe des Kommandos <code class="docutils literal notranslate"><span class="pre">cd</span></code> zum Verzeichnis der Erweiterung wechseln. Um die Fehlermeldung zu erhalten, starte die Batch-Datei durch Ausführen von <code class="docutils literal notranslate"><span class="pre">compile.bat</span></code>.</p>
</div>
<p><strong>Mac und Linux</strong></p>
<p>Wir müssen zuerst <code class="docutils literal notranslate"><span class="pre">pb_tool</span></code> installieren. Öffne ein Terminal und installiere es mit Hilfe von pip.</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo pip3 install pb_tool
</pre></div>
</div>
</div></blockquote>
<p>Öffne ein Terminal, gehe zum Verzeichnis der Erweiterung und gebe <code class="docutils literal notranslate"><span class="pre">pb_tool</span> <span class="pre">compile</span></code> ein. Damit wird das Kommando <code class="docutils literal notranslate"><span class="pre">pyrcc5</span></code> aufgerufen, das wir im Abschnitt <em>Python Bindings für Qt</em> installiert hatten.</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pb_tool compile
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>QGIS Erweiterungen werden in einem besonderen Ordner gespeichert. Wir müssen das Verzeichnis unserer Erweiterung in diesen Ordner kopieren, bevor wir die Erweiterung benutzen können. Den aktuellen Profilordner finden wir in QGIS unter <span class="menuselection">Einstellungen ‣ Benutzerprofile ‣ Aktuelles Profilverzeichnis öffnen</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/108.png" class="align-center" src="../../_images/108.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>Kopiere den Ordner der Erweiterung in folgenden Ordner <span class="menuselection">python ‣ plugins</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1111.png" class="align-center" src="../../_images/1111.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>Jetzt können wir einen ersten Blick auf die brandneu erstellte Erweiterung werfen. Schließe QGIS und starte es erneut. Gehe zu <span class="menuselection">Erweiterungen ‣ Erweiterungen verwalten und installieren</span> und schalte die Erweiterung <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Attributes</span></code> im Bereich <span class="guilabel">Installiert</span> ein.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/128.png" class="align-center" src="../../_images/128.png" />
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>Wir bemerken ein neues Icon in der Erweiterungen Toolleiste und einen neuen Menüeintrag unter <span class="menuselection">Vektor ‣ Save Attributes ‣ Save Attributes as CSV`</span>. Wähle ihn aus, um die Dialogbox der Erweiterung zu starten.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/137.png" class="align-center" src="../../_images/137.png" />
</div></blockquote>
<ol class="arabic simple" start="14">
<li><p>Wir sehen eine neue leere Dialogbox mit der Bezeichnung <span class="guilabel">Save Attributes</span>. Schließe die Dialogbox.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/147.png" class="align-center" src="../../_images/147.png" />
</div></blockquote>
<ol class="arabic simple" start="15">
<li><p>Wir werden nun die Dialogbox gestalten und einige Elemente der Benutzerschnittstelle hinzufügen. Öffne das Programm <code class="docutils literal notranslate"><span class="pre">Qt</span> <span class="pre">Creator</span></code> und wähle <span class="menuselection">File ‣ Open File or Project</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/157.png" class="align-center" src="../../_images/157.png" />
</div></blockquote>
<ol class="arabic simple" start="16">
<li><p>Gehe zum Verzeichnis der Erweiterung und markiere die Datei <code class="docutils literal notranslate"><span class="pre">save_attributes_dialog_base.ui</span></code>. Klicke auf <span class="guilabel">Open</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/16.gif" class="align-center" src="../../_images/16.gif" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Windows versteckt das Verzeichnis <code class="docutils literal notranslate"><span class="pre">AppData</span></code>, so dass es vielleicht nicht  im Auswahlfenster angezeigt wird. Wir können <code class="docutils literal notranslate"><span class="pre">AppData</span></code> im Feld <span class="guilabel">Dateiname</span> auf einer Verzeichnisebene höher eingeben, um das Verzeichnis zu öffnen.</p>
</div>
<ol class="arabic simple" start="17">
<li><p>Die Erweiterung ist eine leere Dialogbox. Wir können mittels drag-and-drop Elemente von der linken Fensterseite in die Dialogbox ziehen. Wir fügen eine <span class="guilabel">Combo Box</span> aus <span class="guilabel">Input Widgets</span> hinzu. Ziehe das Element in die Dialogbox.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/177.png" class="align-center" src="../../_images/177.png" />
</div></blockquote>
<ol class="arabic simple" start="18">
<li><p>Passe die Größe der Dialogbox an. Ziehe jetzt ein <span class="guilabel">Label</span> Element aus <span class="guilabel">Display Widget</span> in die Dialogbox.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/185.png" class="align-center" src="../../_images/185.png" />
</div></blockquote>
<ol class="arabic simple" start="19">
<li><p>Klicke auf den Text des Labels und gebe ein: <code class="docutils literal notranslate"><span class="pre">Einen</span> <span class="pre">Layer</span> <span class="pre">auswählen</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/195.png" class="align-center" src="../../_images/195.png" />
</div></blockquote>
<ol class="arabic simple" start="20">
<li><p>Wir speichern die Datei indem wir zu <span class="menuselection">File ‣ Save save_attributes_dialog_base.ui</span> gehen. Beachte, dass der Name des Auswahlfeldes <code class="docutils literal notranslate"><span class="pre">comboBox</span></code> lautet. Um mit dem Objekt mittels Pythonprogrammcode zu kommunizieren, muss der Bezug über den Namen des Objekts hergestellt werden.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/205.png" class="align-center" src="../../_images/205.png" />
</div></blockquote>
<ol class="arabic simple" start="21">
<li><p>Wir laden die Erweiterung jetzt neu, um die Veränderungen des Dialogfensters zu sehen. Gehe zu <span class="menuselection">Plugin ‣ Plugin Reloader ‣ Choose a plugin to be reloaded</span>. Wähle <code class="docutils literal notranslate"><span class="pre">SaveAttributes</span></code> in der Dialogbox <span class="guilabel">Configure Plugin reloader</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/219.png" class="align-center" src="../../_images/219.png" />
</div></blockquote>
<ol class="arabic simple" start="22">
<li><p>Klicke auf den Knopf <span class="guilabel">Reload plugin</span>, um den aktuellen Stand der Erweiterung zu laden. Klicke auf den Knopf <span class="guilabel">Save Attributes as CSV</span>, um die neu gestaltete Dialogbox anzuzeigen.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/225.png" class="align-center" src="../../_images/225.png" />
</div></blockquote>
<ol class="arabic" start="23">
<li><p>Wir werden jetzt einige Funktionen zur Erweiterung hinzufügen, die die Auswahlbox mit den in QGIS geladenen Layern füllt. Gehe zum Verzeichnis der Erweiterung und lade die Datei <code class="docutils literal notranslate"><span class="pre">save_attributes.py</span></code> in einen Texteditor. Füge als Erstes am Anfang der Datei bei den anderen Importen ein:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="n">QgsProject</span>
</pre></div>
</div>
<p>Scrolle nun nach unten und finde die Methode <code class="docutils literal notranslate"><span class="pre">run(self)</span></code>. Diese Methode wird aufgerufen, wenn man den Knopf in der Toolbar drückt oder die Erweiterung vom Menü aus aufruft. Gebe den folgenden Programmcode am Beginn der Methode ein. Der Programmcode ermittelt die in QGIS geladenen Layer und fügt sie dem <code class="docutils literal notranslate"><span class="pre">comboBox</span></code> Objekt in der Dialogbox der Erweiterung hinzu.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fetch the currently loaded layers</span>
<span class="n">layers</span> <span class="o">=</span> <span class="n">QgsProject</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">layerTreeRoot</span><span class="p">()</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
<span class="c1"># Clear the contents of the comboBox from previous runs</span>
<span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="c1"># Populate the comboBox with names of all the loaded layers</span>
<span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">])</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><img alt="../../_images/23a.png" class="align-center" src="../../_images/23a.png" />
<img alt="../../_images/23b.png" class="align-center" src="../../_images/23b.png" />
</div></blockquote>
<ol class="arabic simple" start="24">
<li><p>Zurück im QGIS Fenster laden wir die Erweiterung durch Klick auf <span class="guilabel">Reload plugin</span> neu. Um die neue Funktionalität zu testen, müssen wir einige Layer in QGIS laden. Wir starten nach dem Laden der Layer die Erweiterung durch <span class="menuselection">Vektor ‣ Save Attributes ‣ Save Attributes as CSV</span>. Wir sehen, dass unser Auswahlfeld jetzt die Namen der in QGIS geladenen Layer enthält.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/245.png" class="align-center" src="../../_images/245.png" />
</div></blockquote>
<ol class="arabic simple" start="25">
<li><p>Wir fügen nun die verbleibenden Elemente der Benutzerschnittstelle hinzu. Gehe zurück zum Qt Creator und lade die Datei <code class="docutils literal notranslate"><span class="pre">save_attributes_dialog_base.ui</span></code>. Füge ein <code class="docutils literal notranslate"><span class="pre">Label</span></code> <span class="guilabel">Display Widget</span> hinzu und ändere den Text zu <code class="docutils literal notranslate"><span class="pre">Wähle</span> <span class="pre">eine</span> <span class="pre">Ausgabedatei</span></code>. Füge ein <span class="guilabel">Input Widget</span> vom Typ <code class="docutils literal notranslate"><span class="pre">LineEdit</span></code> hinzu, das den Ausgabepfad anzeigt, den der Nutzer gewählt hat. Füge als Nächstes einen <span class="guilabel">Button</span> vom Typ <code class="docutils literal notranslate"><span class="pre">Push</span> <span class="pre">Button</span></code> hinzu und ändere die Bezeichnung des Knopfes zu <code class="docutils literal notranslate"><span class="pre">...</span></code>. Denke an die Objektnamen der Widgets, die wir zur Interaktion mit ihnen verwenden müssen. Sichere die Datei.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/255.png" class="align-center" src="../../_images/255.png" />
</div></blockquote>
<ol class="arabic simple" start="26">
<li><p>Wir werden jetzt Python Programmcode einfügen, der den Dateimanager öffnet und die Pfadauswahl anzeigt, sobald der Nutzer den <code class="docutils literal notranslate"><span class="pre">...</span></code> Knopf drückt.  Öffne die Datei <code class="docutils literal notranslate"><span class="pre">save_attributes.py</span></code> in einem Texteditor. Füge <code class="docutils literal notranslate"><span class="pre">QFileDialog</span></code> zur <code class="docutils literal notranslate"><span class="pre">QtWidgets</span></code> Liste der Importe am Beginn der Datei hinzu.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/264.png" class="align-center" src="../../_images/264.png" />
</div></blockquote>
<ol class="arabic simple" start="27">
<li><p>Füge eine neue Methode <code class="docutils literal notranslate"><span class="pre">select_output_file</span></code> mit dem folgenden Programmcode hinzu. Der Programmcode führt zum Öffnen des Dateimanagers und füllt das Eingabefeld mit dem Dateipfad, den der Nutzer auswählt. Beachte wie <code class="docutils literal notranslate"><span class="pre">getSaveFileName</span></code> ein Tupel des Dateinamens und des Dateifilters zurückgibt.</p></li>
</ol>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">select_output_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">filename</span><span class="p">,</span> <span class="n">_filter</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="p">,</span> <span class="s2">&quot;Select   output file &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;*.csv&#39;</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/275.png" class="align-center" src="../../_images/275.png" />
</div></blockquote>
<ol class="arabic simple" start="28">
<li><p>Wir müssen nun Programmcode hinzufügen, der dafür sorgt, dass die Methode <code class="docutils literal notranslate"><span class="pre">select_output_file</span></code> aufgerufen wird, wenn der Knopf <cite>…</cite> gedrückt wird. Wir scrollen bis zur Methode <code class="docutils literal notranslate"><span class="pre">run</span></code> nach unten und fügen die folgende Zeile in den Initialisierungsblock der Dialogbox ein. Dieser Programmcode verbindet die Methode <code class="docutils literal notranslate"><span class="pre">select_output_file</span></code> mit dem <code class="docutils literal notranslate"><span class="pre">clicked</span></code> Signal des push button widgets.</p></li>
</ol>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_output_file</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/285.png" class="align-center" src="../../_images/285.png" />
</div></blockquote>
<ol class="arabic simple" start="29">
<li><p>Zurück in QGIS laden wir die Erweiterung neu und starten sie. Wenn alles klappt, können wir den <code class="docutils literal notranslate"><span class="pre">...</span></code> Knopf drücken und eine lokale Ausgabe-Textdatei auswählen.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/294.png" class="align-center" src="../../_images/294.png" />
</div></blockquote>
<ol class="arabic" start="30">
<li><p>Wenn man auf <span class="guilabel">OK</span> in der Dialogbox der Erweiterung klickt, passiert gar nichts. Das ist so, weil wir noch keine Funktion implementiert haben, die die Attributinformationen vom Layer extrahiert und in eine Textdatei speichert. Es sind jetzt alle Voraussetzungen vorhanden, um dies zu tun. Wir suchen die Stelle innerhalb der <code class="docutils literal notranslate"><span class="pre">run</span></code> Methode an der <code class="docutils literal notranslate"><span class="pre">pass</span></code> steht. Wir ersetzen es mit dem Programmcode unten. Die Erklärung für diesen Programmcode finden wir unter <a class="reference internal" href="getting_started_with_pyqgis.html"><span class="doc">Mit der Pythonprogrammierung loslegen (QGIS3)</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
  <span class="n">selectedLayerIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
  <span class="n">selectedLayer</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="n">selectedLayerIndex</span><span class="p">]</span><span class="o">.</span><span class="n">layer</span><span class="p">()</span>
  <span class="n">fieldnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">fields</span><span class="p">()]</span>
  <span class="c1"># write header</span>
  <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fieldnames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
  <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
  <span class="c1"># write feature attributes</span>
  <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
    <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fieldnames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/304.png" class="align-center" src="../../_images/304.png" />
</li>
<li><p>Wir müssen noch eine letzte Sache hinzufügen. Wenn die Funktion erfolgreich abgeschlossen wurde, sollte das dem Nutzer mitgeteilt werden. Der bevorzugte Weg in QGIS Informationen an den Nutzer weiterzugeben ist die Methode <code class="docutils literal notranslate"><span class="pre">self.iface.messageBar().pushMessage()</span></code>. Füge <code class="docutils literal notranslate"><span class="pre">Qgis</span></code> zur <code class="docutils literal notranslate"><span class="pre">qgis.core</span></code> Liste der Importe am Beginn der Datei hinzu und gebe folgenden Programmcode am Ende der <code class="docutils literal notranslate"><span class="pre">run</span></code> Methode ein.</p></li>
</ol>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span>
  <span class="s2">&quot;Success&quot;</span><span class="p">,</span> <span class="s2">&quot;Output file written at &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span>
  <span class="n">level</span><span class="o">=</span><span class="n">Qgis</span><span class="o">.</span><span class="n">Success</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/31a.png" class="align-center" src="../../_images/31a.png" />
<img alt="../../_images/31b.png" class="align-center" src="../../_images/31b.png" />
</div></blockquote>
<ol class="arabic simple" start="32">
<li><p>Jetzt ist unsere Erweiterung fertig. Lade die Erweiterung neu und probiere sie aus. Wir stellen fest, dass die gewählte Ausgabetextdatei die Attribute des Vektorlayers enthält.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/323.png" class="align-center" src="../../_images/323.png" />
</div></blockquote>
<ol class="arabic simple" start="33">
<li><p>Wir können den Ordner der Erweiterung zippen und ihn mit anderen Nutzern teilen. Der Nutzer muss dazu die zip-Datei in sein Verzeichnis für Erweiterungen entpacken und kann die Erweiterung dann ausprobieren. Wenn es sich um eine echte Erweiterung handelt, würde man sie nach <a class="reference external" href="https://plugins.qgis.org/">QGIS Plugin Repository</a> hochladen, so dass alle QGIS Nutzer die Erweiterung finden und nutzen können.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>Diese Erweiterung wurde nur zu Demonstrationszwecken erstellt. Veröffentliche die Erweiterung nicht und stelle sie nicht im QGIS plugin repository bereit.</p>
</div>
<p>Es folgt die vollständige Datei <code class="docutils literal notranslate"><span class="pre">save_attributes.py</span></code> als Referenz.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">/***************************************************************************</span>
<span class="sd"> SaveAttributes</span>
<span class="sd">                                 A QGIS plugin</span>
<span class="sd"> This plugin saves the attributes of the selected vector layer as a CSV file.</span>
<span class="sd"> Generated by Plugin Builder: http://g-sherman.github.io/Qgis-Plugin-Builder/</span>
<span class="sd">                              -------------------</span>
<span class="sd">        begin                : 2019-03-28</span>
<span class="sd">        git sha              : $Format:%H$</span>
<span class="sd">        copyright            : (C) 2019 by Ujaval Gandhi</span>
<span class="sd">        email                : ujaval@spatialthoughts.com</span>
<span class="sd"> ***************************************************************************/</span>

<span class="sd">/***************************************************************************</span>
<span class="sd"> *                                                                         *</span>
<span class="sd"> *   This program is free software; you can redistribute it and/or modify  *</span>
<span class="sd"> *   it under the terms of the GNU General Public License as published by  *</span>
<span class="sd"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
<span class="sd"> *   (at your option) any later version.                                   *</span>
<span class="sd"> *                                                                         *</span>
<span class="sd"> ***************************************************************************/</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">QSettings</span><span class="p">,</span> <span class="n">QTranslator</span><span class="p">,</span> <span class="n">qVersion</span><span class="p">,</span> <span class="n">QCoreApplication</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QIcon</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QAction</span><span class="p">,</span> <span class="n">QFileDialog</span>
<span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="n">QgsProject</span><span class="p">,</span> <span class="n">Qgis</span>

<span class="c1"># Initialize Qt resources from file resources.py</span>
<span class="kn">from</span> <span class="nn">.resources</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># Import the code for the dialog</span>
<span class="kn">from</span> <span class="nn">.save_attributes_dialog</span> <span class="kn">import</span> <span class="n">SaveAttributesDialog</span>
<span class="kn">import</span> <span class="nn">os.path</span>


<span class="k">class</span> <span class="nc">SaveAttributes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;QGIS Plugin Implementation.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iface</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        :param iface: An interface instance that will be passed to this class</span>
<span class="sd">            which provides the hook by which you can manipulate the QGIS</span>
<span class="sd">            application at run time.</span>
<span class="sd">        :type iface: QgsInterface</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Save reference to the QGIS interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iface</span> <span class="o">=</span> <span class="n">iface</span>
        <span class="c1"># initialize plugin directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
        <span class="c1"># initialize locale</span>
        <span class="n">locale</span> <span class="o">=</span> <span class="n">QSettings</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;locale/userLocale&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">locale_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span><span class="p">,</span>
            <span class="s1">&#39;i18n&#39;</span><span class="p">,</span>
            <span class="s1">&#39;SaveAttributes_</span><span class="si">{}</span><span class="s1">.qm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">locale</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">locale_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">translator</span> <span class="o">=</span> <span class="n">QTranslator</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">locale_path</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">qVersion</span><span class="p">()</span> <span class="o">&gt;</span> <span class="s1">&#39;4.3.3&#39;</span><span class="p">:</span>
                <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">installTranslator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="p">)</span>

        <span class="c1"># Declare instance attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;&amp;Save Attributes&#39;</span><span class="p">)</span>

        <span class="c1"># Check if plugin was started the first time in current QGIS session</span>
        <span class="c1"># Must be set in initGui() to survive plugin reloads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_start</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># noinspection PyMethodMayBeStatic</span>
    <span class="k">def</span> <span class="nf">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the translation for a string using Qt translation API.</span>

<span class="sd">        We implement this ourselves since we do not inherit QObject.</span>

<span class="sd">        :param message: String for translation.</span>
<span class="sd">        :type message: str, QString</span>

<span class="sd">        :returns: Translated version of message.</span>
<span class="sd">        :rtype: QString</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># noinspection PyTypeChecker,PyArgumentList,PyCallByClass</span>
        <span class="k">return</span> <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s1">&#39;SaveAttributes&#39;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">add_action</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">icon_path</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">,</span>
        <span class="n">enabled_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">add_to_menu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">add_to_toolbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">status_tip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">whats_this</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a toolbar icon to the toolbar.</span>

<span class="sd">        :param icon_path: Path to the icon for this action. Can be a resource</span>
<span class="sd">            path (e.g. &#39;:/plugins/foo/bar.png&#39;) or a normal file system path.</span>
<span class="sd">        :type icon_path: str</span>

<span class="sd">        :param text: Text that should be shown in menu items for this action.</span>
<span class="sd">        :type text: str</span>

<span class="sd">        :param callback: Function to be called when the action is triggered.</span>
<span class="sd">        :type callback: function</span>

<span class="sd">        :param enabled_flag: A flag indicating if the action should be enabled</span>
<span class="sd">            by default. Defaults to True.</span>
<span class="sd">        :type enabled_flag: bool</span>

<span class="sd">        :param add_to_menu: Flag indicating whether the action should also</span>
<span class="sd">            be added to the menu. Defaults to True.</span>
<span class="sd">        :type add_to_menu: bool</span>

<span class="sd">        :param add_to_toolbar: Flag indicating whether the action should also</span>
<span class="sd">            be added to the toolbar. Defaults to True.</span>
<span class="sd">        :type add_to_toolbar: bool</span>

<span class="sd">        :param status_tip: Optional text to show in a popup when mouse pointer</span>
<span class="sd">            hovers over the action.</span>
<span class="sd">        :type status_tip: str</span>

<span class="sd">        :param parent: Parent widget for the new action. Defaults None.</span>
<span class="sd">        :type parent: QWidget</span>

<span class="sd">        :param whats_this: Optional text to show in the status bar when the</span>
<span class="sd">            mouse pointer hovers over the action.</span>

<span class="sd">        :returns: The action that was created. Note that the action is also</span>
<span class="sd">            added to self.actions list.</span>
<span class="sd">        :rtype: QAction</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="n">icon_path</span><span class="p">)</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled_flag</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">status_tip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">action</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="n">status_tip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">whats_this</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">action</span><span class="o">.</span><span class="n">setWhatsThis</span><span class="p">(</span><span class="n">whats_this</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">add_to_toolbar</span><span class="p">:</span>
            <span class="c1"># Adds plugin icon to Plugins toolbar</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">addToolBarIcon</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">add_to_menu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">addPluginToVectorMenu</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">,</span>
                <span class="n">action</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">action</span>

    <span class="k">def</span> <span class="nf">initGui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create the menu entries and toolbar icons inside the QGIS GUI.&quot;&quot;&quot;</span>

        <span class="n">icon_path</span> <span class="o">=</span> <span class="s1">&#39;:/plugins/save_attributes/icon.png&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_action</span><span class="p">(</span>
            <span class="n">icon_path</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;Save Attributes as CSV&#39;</span><span class="p">),</span>
            <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">())</span>

        <span class="c1"># will be set False in run()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_start</span> <span class="o">=</span> <span class="kc">True</span>


    <span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes the plugin menu item and icon from QGIS GUI.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">removePluginVectorMenu</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;&amp;Save Attributes&#39;</span><span class="p">),</span>
                <span class="n">action</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">removeToolBarIcon</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">select_output_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="n">filename</span><span class="p">,</span> <span class="n">_filter</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="p">,</span> <span class="s2">&quot;Select   output file &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;*.csv&#39;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
      
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run method that performs all the real work&quot;&quot;&quot;</span>

        <span class="c1"># Create the dialog with elements (after translation) and keep reference</span>
        <span class="c1"># Only create GUI ONCE in callback, so that it will only load when the plugin is started</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_start</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">first_start</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="o">=</span> <span class="n">SaveAttributesDialog</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_output_file</span><span class="p">)</span>

        
        <span class="c1"># Fetch the currently loaded layers</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="n">QgsProject</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">layerTreeRoot</span><span class="p">()</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
        <span class="c1"># Clear the contents of the comboBox and lineEdit from previous runs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># Populate the comboBox with names of all the loaded layers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">])</span>
        
        <span class="c1"># show the dialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c1"># Run the dialog event loop</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
        <span class="c1"># See if OK was pressed</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
          <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
          <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
            <span class="n">selectedLayerIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
            <span class="n">selectedLayer</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="n">selectedLayerIndex</span><span class="p">]</span><span class="o">.</span><span class="n">layer</span><span class="p">()</span>
            <span class="n">fieldnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">fields</span><span class="p">()]</span>
            <span class="c1"># write header</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fieldnames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="c1"># write feature attributes</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">selectedLayer</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
              <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fieldnames</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span>
            <span class="s2">&quot;Success&quot;</span><span class="p">,</span> <span class="s2">&quot;Output file written at &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="n">Qgis</span><span class="o">.</span><span class="n">Success</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>





  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, Ujaval Gandhi.<br/>
      Zuletzt aktualisiert am Nov. 04, 2022.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.1.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/3/building_a_python_plugin.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>