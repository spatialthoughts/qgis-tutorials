<!DOCTYPE html>

<html lang="ko" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>가장 가까운 기-종점 매트릭스 위치 (QGIS3) &#8212; QGIS Tutorials and Tips</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=0bf093e7" />
    <script src="../../_static/documentation_options.js?v=fefd262b"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=b5f768d8"></script>
    <link rel="search" title="검색" href="../../search.html" />
    <link rel="next" title="Openrouteservice를 이용한 서비스 영역 분석(QGIS3)" href="service_area_analysis.html" />
    <link rel="prev" title="Basic Network Visualization and Routing (QGIS3)" href="basic_network_analysis.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>


<!-- Cookie Notice -->
<!-- Script from https://github.com/AOEpeople/cookie-notice -->
<script type="text/javascript" src="../../_static/cookie.notice.min.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1WQ7B80XJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B1WQ7B80XJ');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">들어가는 말</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">지도 만들기 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">속성 작업 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">스프레드시트 및 CSV 파일 불러오기 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">기본 벡터 스타일링 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">선의 길이계산과 통계(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">기본 래스터 스타일링 및 분석(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">래스터 붙이기 및 자르기 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Working with Terrain Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Working with WMS Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">Working with Projections (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">Georeferencing Topo Sheets and Scanned Maps (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">항공사진 지오레퍼런싱 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">Digitizing Map Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins.html">테이블 결합 작업(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">공간 결합 수행 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">공간 조회 실행(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">최근린 분석(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">점 또는 다각형을 이용한 래스터 데이터 표본 추출 작업(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_raster_area.html">Calculating Raster Area (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">열지도 만들기 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="animating_time_series.html">Animating Time Series Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="handling_invalid_geometries.html">Handling Invalid Geometries (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_raster_analysis.html">Advanced Raster Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">Interpolating Point Data (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">프로세싱 프레임을 이용한 일괄처리과정</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">프로세싱 모델러를 사용하여 복잡한 작업흐름 자동화하기(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">Automating Map Creation with Print Layout Atlas (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_criteria_overlay.html">Multi Criteria Overlay Analysis (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector_styling_expressions.html">Basic Filtering and Styling with Expressions (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="block_world_styling.html">Creating a Block World Map (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="river_styling_expressions.html">Styling a River Network with Expressions (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="contour_3d_styling.html">Styling Contours in 3D (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="isometric_buildings.html">Creating Isometric Buildings (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_canvas_maps.html">Making Interactive Canvas Maps (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_reveal_maps.html">Making Interactive Reveal Maps (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="cartogram_animation.html">Creating an Animated Cartogram (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_network_analysis.html">Basic Network Visualization and Routing (QGIS3)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">가장 가까운 기-종점 매트릭스 위치 (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="service_area_analysis.html">Openrouteservice를 이용한 서비스 영역 분석(QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="travel_time_analysis.html">Travel Time Analysis with Uber Movement (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="areal_mean_rainfall.html">Calculating Areal Mean Rainfall (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="colorized_river_basin_map.html">Creating a Colorized River Basin Map (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_landuse_map.html">Creating a Landuse Map (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_intersection_density.html">Calculating Street Intersection Density (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="landuse_buffer.html">Determining Landuse Buffer Zones (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="solidwaste_mapping.html">Mapping Waste Disposal Volumes (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Getting Started With Python Programming (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_algorithms_pyqgis.html">Running Processing Algorithms via Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">Using Custom Python Expression Functions (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">Writing Python Scripts for Processing Framework (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_a_python_plugin.html">Building a Python Plugin (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_plugin.html">Building a Processing Plugin (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_qgis_jobs.html">Running and Scheduling QGIS Processing Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">Web Mapping with QGIS2Web (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_basemaps_with_qtiles.html">QTiles로 베이스 맵 만들기</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Using Plugins (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloading_osm_data.html">오픈스트리트맵 데이터의 검색과 다운로드</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning_resources.html">QGIS 수업 자원</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">데이터 크레딧</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_processing.html">프로세싱 프레임을 이용한 일괄처리과정</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="basic_network_analysis.html" title="Previous Chapter: Basic Network Visualization and Routing (QGIS3)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Basic Network...</span>
    </a>
  </li>
  <li>
    <a href="service_area_analysis.html" title="Next Chapter: Openrouteservice를 이용한 서비스 영역 분석(QGIS3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Openrouteserv... &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p><a href="https://www.linkedin.com/in/spatialthoughts/"><img src="../../_static/ujaval.png">Ujaval Gandhi</a></p>

<hr>
<p>Want to learn QGIS in a structured way? Check out <a href="https://spatialthoughts.com/" target="_blank">Spatial Thoughts</a> for more learning materials and instructor-led online programs with QGIS.org certification.</p>

<hr>
<p>These tutorials are also available in many other languages. Please see <a href="https://www.qgistutorials.com/en/docs/introduction.html#translations" target="_blank">translations</a> page.
</p>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      

  <section id="locating-nearest-facility-with-origin-destination-matrix-qgis3">
<h1>가장 가까운 기-종점 매트릭스 위치 (QGIS3)<a class="headerlink" href="#locating-nearest-facility-with-origin-destination-matrix-qgis3" title="Link to this heading">¶</a></h1>
<p>In the previous tutorial, <a class="reference internal" href="basic_network_analysis.html"><span class="doc">Basic Network Visualization and Routing (QGIS3)</span></a>, we learned how to build a network and calculate the shortest path between 2 points. We can apply that technique to many different types of network-based analysis. One such application is to compute <strong>Origin-Destination Matrix</strong> or <strong>OD Matrix</strong>. Given a set of origin points and another set of destination points, we can calculate the shortest path between each origin-destination pairs and find out the travel distance/time between them. Such analysis is useful to locate the closest facility to any given point. For example, a logistics company may use this analysis to find the closest warehouse to their customers to optimize delivery routes. Here we use the Distance Matrix algorithm from <strong>QGIS Network Analysis Toolbox (QNEAT3)</strong> plugin to find the nearest health facility to each address in the city.</p>
<div class="admonition note">
<p class="admonition-title">참고</p>
<p>This tutorial shows how to use your own network data to compute an origin-destination matrix. If you do not have your own network data, you can use <strong>ORS Tools Plugin</strong> and algorithm <span class="menuselection">ORS Tools ‣ Matrix ‣  Matrix from Layers</span> to do a similar analysis using OpenStreetMap data. See <a class="reference internal" href="service_area_analysis.html"><span class="doc">Openrouteservice를 이용한 서비스 영역 분석(QGIS3)</span></a> to learn how to use ORS Tools plugin.</p>
</div>
<section id="overview-of-the-task">
<h2>개요<a class="headerlink" href="#overview-of-the-task" title="Link to this heading">¶</a></h2>
<p>워싱턴 DC의 레이어 2개를 사용합니다 - 점 데이터는 주소 정보이고 다른 점 데이터는 정신의료시설을 표시하는 정보입니다 - 각 지점에서 가장 짧은 노선으로 갈 수 있는 최적 경로를 찾아봅시다.</p>
<section id="other-skills-you-will-learn">
<h3>이 예제에서 필요한 다른 기술<a class="headerlink" href="#other-skills-you-will-learn" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Extract a random sample from a point layer.</p></li>
<li><p>QGIS 레이어에서 SQL 쿼리를 이용하여 가상레이어 사용하기</p></li>
</ul>
</section>
</section>
<section id="get-the-data">
<h2>데이터 획득<a class="headerlink" href="#get-the-data" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://opendata.dc.gov/">Open Data Catalog</a>. 이곳에서 콜롬비아 정부가 무료로 제공하는 다양한 데이터를 만나보실 수 있습니다.</p>
<p>다음의 쉐이프파일을 내려받기해주세요.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://opendata.dc.gov/datasets/roadway-block">Roadway Block</a></p></li>
<li><p><a class="reference external" href="https://opendata.dc.gov/datasets/address-points">Address Points</a></p></li>
<li><p><a class="reference external" href="https://opendata.dc.gov/datasets/DCGIS::community-based-service-providers">Community Based Service Provider</a></p></li>
</ul>
<p>아래 링크에서 이번예제에 사용되는 샘플파일을 쉽게 내려받을 수 있습니다:</p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/Roadway_Block-shp.zip">Roadway_Block-shp.zip</a></p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/Address_Points.zip">Address_Points.zip</a></p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/Community_Based_Service_Providers.zip">Community Based Service Provider.zip</a></p>
<p>데이터 출처: <a class="reference internal" href="../credits.html#dcopendata" id="id1"><span>[DCOPENDATA]</span></a></p>
</section>
<section id="setup">
<h2>설정<a class="headerlink" href="#setup" title="Link to this heading">¶</a></h2>
<p>Visit <span class="menuselection">Plugins ‣ Manage and Install plugins</span>. Select :guilabel:` All` Search for <strong>QNEAT3</strong> plugin and install it. Click <span class="guilabel">Close</span>.</p>
<img alt="../../_images/setup11.png" class="align-center" src="../../_images/setup11.png" />
</section>
<section id="procedure">
<h2>과정<a class="headerlink" href="#procedure" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Locate the <code class="docutils literal notranslate"><span class="pre">Community_Based_Service_Providers.zip</span></code> file, expand it and add <code class="docutils literal notranslate"><span class="pre">Community_Based_Service_Providers.shp</span></code> to the canvas. We will select only those centres providing facilities to adults. Right-click on the <code class="docutils literal notranslate"><span class="pre">Community_Based_Service_Providers.shp</span></code> layer and select <span class="guilabel">Filter</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1133.png" class="align-center" src="../../_images/1133.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>It will open a <span class="guilabel">Query Builder</span> dialog box. Enter the following query in the :guilabel:` Filter Expression`  Click <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;PROVIDER_T&quot;  IN (&#39;Adult&#39;,&#39;Adult &amp; Child&#39;)
</pre></div>
</div>
<img alt="../../_images/2106.png" class="align-center" src="../../_images/2106.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Next, locate the <code class="docutils literal notranslate"><span class="pre">Roadway_Block.zip</span></code> file, expand it and add the <code class="docutils literal notranslate"><span class="pre">Roadway_Block.shp</span></code>. Similarly, locate the <code class="docutils literal notranslate"><span class="pre">Address_Points.zip</span></code> file, expand it and add the <code class="docutils literal notranslate"><span class="pre">Address_Points.shp</span></code>. You will see a lot of points around the city. Each point represents a valid address. We will select 1000 points randomly. This technique is called random sampling. Go to <span class="menuselection">Processing ‣ Toolbox</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/349.png" class="align-center" src="../../_images/349.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Search for and locate the <span class="menuselection">Vector Selection ‣ Random extract</span> algorithm.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/349.png" class="align-center" src="../../_images/349.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Address_Points</span></code> as the <span class="guilabel">Input layer</span>, <code class="docutils literal notranslate"><span class="pre">Number</span> <span class="pre">of</span> <span class="pre">feature</span></code> as the <span class="guilabel">Method</span> and, enter <code class="docutils literal notranslate"><span class="pre">1000</span></code> in the <span class="guilabel">Number/percentage of features</span>. In the <span class="guilabel">Extracted (random)</span> choose the <code class="docutils literal notranslate"><span class="pre">...</span></code>  and click <span class="guilabel">Save to a file</span>. Now choose the directory and enter the name as <code class="docutils literal notranslate"><span class="pre">address_point_subset.shp</span></code> and click <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/524.png" class="align-center" src="../../_images/524.png" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">참고</p>
<p>As the algorithm will extract 1000 random points from the given data set, to replicate the exact points used in this exercise you can download the subset file which we got during the execution of the algorithm here <a class="reference external" href="https://www.qgistutorials.com/downloads/address_point_subset.zip">address_point_subset.zip</a> . After downloading load <code class="docutils literal notranslate"><span class="pre">address_point_subset.shp</span></code> layer into QGIS.</p>
</div>
<ol class="arabic simple" start="6">
<li><p>A new layer <code class="docutils literal notranslate"><span class="pre">address_point_subset</span></code> will be added to the <span class="guilabel">Layers</span> panel, you can turn off the visibility of <code class="docutils literal notranslate"><span class="pre">Address_Points</span></code> address points layer. Let’s rename this layer as <code class="docutils literal notranslate"><span class="pre">origin_points</span></code>. Right-click on the <code class="docutils literal notranslate"><span class="pre">address_point_subset</span></code> layer and select <span class="guilabel">Rename layer</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/624.png" class="align-center" src="../../_images/624.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>Similarly, rename the <code class="docutils literal notranslate"><span class="pre">Community_Based_Service_Provider</span></code> layers representing the health facilities as <code class="docutils literal notranslate"><span class="pre">destination_points</span></code>. Naming the layers this way makes it easy to identify them in subsequent processing. Further we will open processing toolbox to create the distance matrix using origin and destination layers.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/723.png" class="align-center" src="../../_images/723.png" />
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>Locate the <span class="menuselection">QNEAT3 ‣ Distance matrices ‣ OD Matrix from Layers as Line (m:n)</span> algorithm. If you do not see this algorithm in the toolbox, make sure you have installed the <strong>QNEAT3</strong> plugin.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/823.png" class="align-center" src="../../_images/823.png" />
</div></blockquote>
<ol class="arabic simple" start="9">
<li><p>This algorithm helps find the distances along with the network between selected origin and destination layers. Select <code class="docutils literal notranslate"><span class="pre">Roadway_Block</span></code> as the <span class="guilabel">Network layer</span>. Select <code class="docutils literal notranslate"><span class="pre">origin_points</span></code> as the <span class="guilabel">From-Points layer</span> and <code class="docutils literal notranslate"><span class="pre">OBJECTID</span></code> as the <span class="guilabel">Unique Point ID field</span>. Similarly, set <code class="docutils literal notranslate"><span class="pre">destination_points</span></code> as the <span class="guilabel">To-Points Layer</span> and <code class="docutils literal notranslate"><span class="pre">OBJECTID</span></code> as  the <span class="guilabel">Unique Point ID field</span>. Set the <span class="guilabel">Optimization Criterion</span> as <code class="docutils literal notranslate"><span class="pre">Shortest</span> <span class="pre">Path</span> <span class="pre">(distance</span> <span class="pre">optimization)</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/923.png" class="align-center" src="../../_images/923.png" />
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>As many streets in the network are one-way, we need to set the <span class="guilabel">Advanced parameters</span> to specify the direction. See <a class="reference internal" href="basic_network_analysis.html"><span class="doc">Basic Network Visualization and Routing (QGIS3)</span></a> for more details on how these attributes are structured. We also have an option to select geometry style of the generated matrix. We are having a road network with direction information so we can generate matrix by folling the route. Choose <code class="docutils literal notranslate"><span class="pre">Matrix</span> <span class="pre">geometry</span> <span class="pre">follows</span> <span class="pre">routes</span></code>. Choose <code class="docutils literal notranslate"><span class="pre">SUMMARYDIR</span></code> as the <span class="guilabel">Direction field</span>. Enter <code class="docutils literal notranslate"><span class="pre">OB</span></code> as the <span class="guilabel">Value for the forward direction</span>, <code class="docutils literal notranslate"><span class="pre">IB</span></code> as the <span class="guilabel">Value for backward direction</span>, and <code class="docutils literal notranslate"><span class="pre">BD</span></code> as the <span class="guilabel">Value for the both direction</span>. Set the <span class="guilabel">Topology tolerance</span> as <code class="docutils literal notranslate"><span class="pre">0.000150</span></code>. Keep other options to their default values and click <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1030.png" class="align-center" src="../../_images/1030.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>A new table layer called <code class="docutils literal notranslate"><span class="pre">Output</span> <span class="pre">OD</span> <span class="pre">Matrix</span></code> will be added to the <span class="guilabel">Layers</span> panel. Right-click and select <span class="guilabel">Open Attributes Table</span>. You will see that the table contains <em>67000</em> rows. We had 67 origin points and 1000 destination points - so the output contains <em>67x1000 = 67000</em> pairs of origins and destination. The <code class="docutils literal notranslate"><span class="pre">total_cost</span></code> column contains distance in meters between each origin point to every destination point.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1134.png" class="align-center" src="../../_images/1134.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>For this tutorial, we are interested in only the destination point with the shortest distance. We can create a SQL query to pick the destination with the least <code class="docutils literal notranslate"><span class="pre">total_cost</span></code> among all destinations. Go to <span class="menuselection">Processing ‣ Toolbox</span>.Search for and locate the <span class="menuselection">Vector general ‣ Execute SQL</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1231.png" class="align-center" src="../../_images/1231.png" />
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>In <span class="guilabel">Additional input data sources</span> select <code class="docutils literal notranslate"><span class="pre">...</span></code> and check the <span class="guilabel">Output OD Matrix</span> and, click <span class="guilabel">OK</span>. Now click the <span class="guilabel">Summation</span> under <span class="guilabel">SQL query</span>. Enter the following query in <span class="guilabel">SQL query</span> dialog box. Enter <code class="docutils literal notranslate"><span class="pre">geometry</span></code> as the <span class="guilabel">Geometry field</span> and, select <code class="docutils literal notranslate"><span class="pre">LineString</span></code> as the <span class="guilabel">Geometry type</span>. Click <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>select origin_id, destination_id, min(total_cost) as shortest_distance, geometry
from input1 group by origin_id
</pre></div>
</div>
<img alt="../../_images/1329.png" class="align-center" src="../../_images/1329.png" />
</div></blockquote>
<ol class="arabic simple" start="14">
<li><p>A new virtual layer <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Output</span></code> will be added to the <span class="guilabel">Layers</span> panel. This Layer has the result of our analysis. Nearest service provider for each of the 1000 origin points.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1427.png" class="align-center" src="../../_images/1427.png" />
</div></blockquote>
</section>
</section>





  <!-- Comment Section Powered by utterances -->
<div id="comments">
  <hr />
  <p>If you want to give feedback or share your experience with this tutorial, please comment below. (requires GitHub account)</p>
<script src="https://utteranc.es/client.js"
        repo="spatialthoughts/qgis-tutorials"
        issue-term="title"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2023, Ujaval Gandhi.<br/>
      최종 업데이트: 4월 01, 2025<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/3/origin_destination_matrix.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>