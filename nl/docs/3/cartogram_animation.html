<!DOCTYPE html>

<html lang="nl" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Een geanimeerd cartogram maken (QGIS3) &#8212; QGIS Tutorials and Tips</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=0bf093e7" />
    <script src="../../_static/documentation_options.js?v=abdfb6f9"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=83e0b41b"></script>
    <link rel="search" title="Zoeken" href="../../search.html" />
    <link rel="next" title="Basis netwerk visualisatie en routeren (QGIS3)" href="basic_network_analysis.html" />
    <link rel="prev" title="Making Interactive Canvas Maps (QGIS3)" href="interactive_canvas_maps.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>


<!-- Cookie Notice -->
<!-- Script from https://github.com/AOEpeople/cookie-notice -->
<script type="text/javascript" src="../../_static/cookie.notice.min.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1WQ7B80XJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B1WQ7B80XJ');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          QGIS Tutorials and Tips</a>
        <span class="navbar-text navbar-version pull-left"><b>v1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Tutorials List <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introductie</a></li>
<li class="toctree-l1"><a class="reference internal" href="making_a_map.html">Een kaart maken (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_attributes.html">Werken met attributen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_spreadsheets_csv.html">Werkbladen of CSV-bestanden importeren (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_vector_styling.html">Basis opmaken van vectoren (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_line_lengths.html">Lengten van lijnen en statistieken berekenen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_styling_and_analysis.html">Basis opmaken en analyses van rasters (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="raster_mosaicing_and_clipping.html">Rasters mozaïeken en clippen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_terrain.html">Werken met gegevens over het terrein (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_wms.html">Werken met gegevens van WMS (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_projections.html">Werken met projecties (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="georeferencing_basics.html">Topobladen en gescande kaarten voorzien van geoverwijzingen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_georeferencing.html">Geo-verwijzingen voor satellietbeelden (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitizing_basics.html">Kaartgegevens digitaliseren</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_table_joins.html">Samenvoegen van tabellen uitvoeren (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_joins.html">Ruimtelijke samenvoegingen uitvoeren (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="performing_spatial_queries.html">Ruimtelijke query’s uitvoeren (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest_neighbor_analysis.html">Analyse Nearest Neighbor (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling_raster_data.html">Monsters nemen van rastergegevens met behulp van punten of polygonen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_raster_area.html">Rastergebied berekenen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_heatmaps.html">Heatmaps maken (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="animating_time_series.html">Geanimeerde gegevens tijdreeks (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="handling_invalid_geometries.html">Ongeldige geometrieën afhandelen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_raster_analysis.html">Gevorderde rasteranalyses (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolating_point_data.html">Interpoleren van puntgegevens</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_processing.html">Massa verwerken met behulp van Framework Processing (QGIS 3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_graphical_modeler.html">Complexe werkstromen automatiseren met behulp van Grafische modellen bouwen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="automating_map_creation.html">Maken van kaarten automatiseren met Atlas van afdruklay-out (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_criteria_overlay.html">Multi Criteria Overlay Analyse (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector_styling_expressions.html">Basis filteren en opmaken met expressies (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="block_world_styling.html">Een geblokte kaart van de wereld maken (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="river_styling_expressions.html">Een netwerk van rivieren opmaken met expressies (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="contour_3d_styling.html">Contouren opmaken in 3D (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_canvas_maps.html">Making Interactive Canvas Maps (QGIS3)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Een geanimeerd cartogram maken (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_network_analysis.html">Basis netwerk visualisatie en routeren (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="origin_destination_matrix.html">Dichtstbijzijnde faciliteit zoeken met Origin-Destination Matrix (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="service_area_analysis.html">Analyse Servicegebied met Openrouteservice (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="travel_time_analysis.html">Reistijd-analyse met Uber Movement (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="areal_mean_rainfall.html">Berekenen gemiddelde regenval voor gebied (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="colorized_river_basin_map.html">Een gekleurde rivierbekken-kaart maken (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_landuse_map.html">Een kaart voor gebruik van land maken (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculating_intersection_density.html">Dichtheid van straatkruisingen berekenen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="landuse_buffer.html">Bufferzones voor landgebruik bepalen  (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="solidwaste_mapping.html">In kaart brengen volumes afvalverwerking (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_pyqgis.html">Beginnen met programmeren in Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_algorithms_pyqgis.html">Algoritmes van Processing uitvoeren via Python (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_python_functions.html">Aangepaste Python expressie-functies gebruiken (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_scripts.html">Python-scripts schrijven voor framework Processing (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_a_python_plugin.html">Een plug-in in Python bouwen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_python_plugin.html">Een plug-in voor Processing bouwen (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_qgis_jobs.html">Taken voor QGIS uitvoeren en in schema zetten</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_mapping_with_qgis2web.html">In kaart brengen op het web met QGIS2Web (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_basemaps_with_qtiles.html">Basiskaarten maken met QTiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_plugins.html">Plug-ins gebruiken (QGIS3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloading_osm_data.html">Zoeken en downloaden van gegevens van OpenStreetMap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning_resources.html">QGIS bronnen om te leren</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Gebruik van gegevens</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_processing.html">Massa verwerken met behulp van Framework Processing (QGIS2)</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="interactive_canvas_maps.html" title="Previous Chapter: Making Interactive Canvas Maps (QGIS3)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Making Intera...</span>
    </a>
  </li>
  <li>
    <a href="basic_network_analysis.html" title="Next Chapter: Basis netwerk visualisatie en routeren (QGIS3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Basis netwerk... &raquo;</span>
    </a>
  </li>
              
            
            

            

            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><h4>Author</h4>
<p>Ujaval Gandhi</p>
<a href="https://twitter.com/intent/follow?screen_name=spatialthoughts" class="twitter-follow-button" data-show-count="false">Follow @spatialthoughts</a>
<hr>
<p>Want to learn QGIS in a structured way? Check out <a href="https://spatialthoughts.com/" target="_blank">Spatial Thoughts</a> for more learning materials and instructor-led online programs with QGIS.org certification.</p>

<hr>
<p>These tutorials are also available in many other languages. Please see <a href="https://www.qgistutorials.com/en/docs/introduction.html#translations" target="_blank">translations</a> page.
</p>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      

  <section id="creating-an-animated-cartogram-qgis3">
<h1>Een geanimeerd cartogram maken (QGIS3)<a class="headerlink" href="#creating-an-animated-cartogram-qgis3" title="Link to this heading">¶</a></h1>
<p>Een cartogram is een type kaartvisualisatie waarin de vorm van elk object in verhouding is vervormd tot een variabele. Cartogrammen maken het gemakkelijk grote variaties in de gegevens te zien. De eenvoudigste methode om een cartogram te maken is door de grootte van elke regio op schaal te brengen, overeenkomstig een variabele. Deze methode behoudt de originele vorm van de polygoon en wijzigt alleen de grootte. Deze staan bekend als <a class="reference external" href="https://en.wikipedia.org/wiki/Cartogram#Non-contiguous_isomorphic_cartograms">Niet-aaneensluitende isomorfische cartogrammen</a>. In deze handleiding zullen we leren hoe expressies van QGIS te gebruiken om een cartogram te maken en Tijdbeheer te gebruiken om een animatie te maken die de objecten gradueel vervormt tot de doelgrootte.</p>
<p>This tutorial is inspired by <a class="reference external" href="https://x.com/kgjenkins/status/1495986986250813442?cxt=HHwWhICygZ2P6MIpAAAA">Keith Jenkins’s Demo</a> and builds on <a class="reference external" href="https://www.youtube.com/watch?v=qxKD6wcFUcE">Hans van der Kwast’s excellent cartogram tutorial</a>. The formula for scale factor used here is from the original paper <a class="reference external" href="https://doi.org/10.1111/j.0033-0124.1976.00371.x">Noncontiguous Area Cartograms</a> by Judy M Olson.</p>
<section id="overview-of-the-task">
<h2>Overzicht van de taak<a class="headerlink" href="#overview-of-the-task" title="Link to this heading">¶</a></h2>
<p>We will take a layer of states in the US and create an animated cartogram by scaling each state by population. The resulting map will have each state’s area proportional its population.</p>
<blockquote>
<div><img alt="../../_images/output.gif" class="align-center" src="../../_images/output.gif" />
</div></blockquote>
</section>
<section id="get-the-data">
<h2>De gegevens ophalen<a class="headerlink" href="#get-the-data" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://www.census.gov/">United States Census Bureau</a> verschaft cartografische bestanden met grenzen, naast demografische gegevenssets. We zullen de gegevens downloaden en ze verwerken om een gegevenslaag te maken die geschikt is voor onze taak.</p>
<ol class="arabic simple">
<li><p>Bezoek de pagina met gegevens <a class="reference external" href="https://www.census.gov/geographies/mapping-files/time-series/geo/carto-boundary-file.html">Cartographic Boundary Files - Shapefile</a>. Download het bestand <code class="docutils literal notranslate"><span class="pre">cb_2018_us_state_20m.zip</span></code>.  Dat heeft de polygonen die we nodig hebben voor de visualisatie.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data19.png" class="align-center" src="../../_images/data19.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>De polygonen van de staten hebben geen demografische gegevens. Deze gegevens moeten afzonderlijk worden gedownload en afzonderlijk worden samengevoegd met de Shapefile om in een GIS te kunnen gebruiken. Bezoek de pagina <a class="reference external" href="https://www.census.gov/data/tables/time-series/demo/popest/2020s-state-total.html">State Population Totals and Components of Change: 2020-2023</a> en download de gegevensset <em>Annual Population Estimates, Estimated Components of Resident Population Change, and Rates of the Components of Resident Population Change for the United States, States, District of Columbia, and Puerto Rico: April 1, 2020 to July 1, 2023</em> , die zal worden gedownload als <code class="docutils literal notranslate"><span class="pre">NST-EST2023-ALLDATA.csv</span></code>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data23.png" class="align-center" src="../../_images/data23.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Open QGIS. Zoek naar het bestand <code class="docutils literal notranslate"><span class="pre">cb_2018_us_state_20m.zip</span></code> in de QGIS Browser en vergroot het. Sleep het bestand <code class="docutils literal notranslate"><span class="pre">cb_2018_us_state_20m.shp</span></code> naar het kaartvenster en zet het daar neer.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data33.png" class="align-center" src="../../_images/data33.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Een nieuwe laag <code class="docutils literal notranslate"><span class="pre">cb_2018_us_state_20m</span></code> zal worden toegevoegd aan het paneel <span class="guilabel">Lagen</span>. Vervolgens zullen we het CSV-bestand laden. Klik op de knop <span class="guilabel">Databronnen beheren openen</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data43.png" class="align-center" src="../../_images/data43.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Schakel naar de tab <span class="guilabel">Tekengescheiden tekst</span>. Klik op de knop <span class="guilabel">…</span> naast <span class="guilabel">Bestandsnaam</span> en blader naar het gedownloade bestand <code class="docutils literal notranslate"><span class="pre">NST-EST2023-ALLDATA.csv</span></code>. Vergroot het gedeelte <span class="guilabel">Geometrie definitie</span> en selecteer <code class="docutils literal notranslate"><span class="pre">Geen</span> <span class="pre">geometrie</span> <span class="pre">(alleen</span> <span class="pre">attributentabel)</span></code>. Klik op <span class="guilabel">Toevoegen</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data53.png" class="align-center" src="../../_images/data53.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>A new layer <code class="docutils literal notranslate"><span class="pre">NST-EST2023-ALLDATA</span></code> will be added to the <span class="guilabel">Layers</span> panel. Right-click and select <span class="guilabel">Open Attribute Table</span>. This table has the population counts in the <code class="docutils literal notranslate"><span class="pre">POPESTIMATE2023</span></code> column. Each state has a unique id in the <code class="docutils literal notranslate"><span class="pre">STATE</span></code> column that we will use to join this table with the polygon layer.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data63.png" class="align-center" src="../../_images/data63.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>Right-click the <code class="docutils literal notranslate"><span class="pre">cb_2018_us_state_20m</span></code> layer and select <span class="guilabel">Open Attribute Table</span>. The state ids are contained in the <code class="docutils literal notranslate"><span class="pre">GEOID</span></code> column. While the numbers are the same, they are formatted as a 2-digit 0-padded number. To match these with the <code class="docutils literal notranslate"><span class="pre">STATE</span></code> column from our population table, we need similarly formatted numbers. Select the <code class="docutils literal notranslate"><span class="pre">NST-EST2023-ALLDATA</span></code>. Go to <span class="menuselection">Processing ‣ Toolbox</span>. Search and locate the <span class="menuselection">Vector table ‣ Field calculator</span> algorithm. Double-click to open it.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data73.png" class="align-center" src="../../_images/data73.png" />
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>In het dialoogvenster <span class="guilabel">Veld calculator</span>, selecteer <code class="docutils literal notranslate"><span class="pre">NST-EST2023-ALLDATA</span></code> als de <span class="guilabel">Invoerlaag</span>, voer <code class="docutils literal notranslate"><span class="pre">GEOID</span></code> in als de <span class="guilabel">Veldnaam</span>, en stel <span class="guilabel">Type resultaatveld ` in als ``Tekst (string)`</span>. We zullen nu de getallen uit het veld <code class="docutils literal notranslate"><span class="pre">STATE</span></code> nemen en de functie <code class="docutils literal notranslate"><span class="pre">lpad()</span></code> gebruiken om een 2-cijferige tekenreeks, aangevuld met voorloopnullen te maken. Voer de volgende expressie in en klik op <span class="guilabel">Uitvoeren</span></p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lpad(&quot;STATE&quot;, 2, &#39;0&#39;)
</pre></div>
</div>
<img alt="../../_images/data82.png" class="align-center" src="../../_images/data82.png" />
</div></blockquote>
<ol class="arabic simple" start="9">
<li><p>Een nieuwe laag <code class="docutils literal notranslate"><span class="pre">Berekend</span></code> zal worden toegevoegd aan het paneel <span class="guilabel">Lagen</span>. Klik met rechts en selecteer <span class="guilabel">Attributentabel openen</span>. Merk op dat de nieuw gemaakte kolom <code class="docutils literal notranslate"><span class="pre">GEOID</span></code> de correct opgemaakte identificaties heeft. We kunnen nu dat veld gebruiken om deze tabel samen te voegen met de laag van de staten. Zoek en lokaliseer het algoritme <span class="menuselection">Vector algemeen ‣ Attributen koppelen op veldwaarde</span>. Dubbelklik erop om het te openen.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data92.png" class="align-center" src="../../_images/data92.png" />
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>In het dialoogvenster <span class="guilabel">Attributen koppelen op veldwaarde</span>, selecteer <code class="docutils literal notranslate"><span class="pre">cb_2018_us_state_20m</span></code> als de <span class="guilabel">Invoerlaag</span>. Selecteer <code class="docutils literal notranslate"><span class="pre">GEOID</span></code> als het <span class="guilabel">Tabelveld</span>. Voor <span class="guilabel">Invoerlaag 2</span>, selecteer onze tabel <code class="docutils literal notranslate"><span class="pre">Berekend</span></code> en voor <span class="guilabel">Tabelveld 2</span>, selecteer <code class="docutils literal notranslate"><span class="pre">GEOID</span></code>. De tabel heeft heel veel kolommen, maar we hebben alleen het aantal inwoners van het laatste jaar nodig. Klik op de knop <span class="guilabel">…</span> voor <span class="guilabel">Velden van laag 2 om te kopiëren</span> en selecteer alleen het veld <code class="docutils literal notranslate"><span class="pre">POPESTIMATE2023</span></code>. Laat alle andere opties op hun standaardwaarde en klik op <span class="guilabel">Uitvoeren</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data102.png" class="align-center" src="../../_images/data102.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>Een nieuwe laag <code class="docutils literal notranslate"><span class="pre">Samengevoegde</span> <span class="pre">laag</span></code> zal worden toegevoegd aan het paneel <span class="guilabel">Lagen</span>. Laten we, voordat we deze laag gebruiken voor ons cartogram, die opnieuw projecteren naar een geprojecteerd CRS. Zoek en lokaliseer het algoritme <span class="menuselection">Vector algemeen ‣ Laag opnieuw projecteren</span>. Dubbelklik erop om het te openen.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data114.png" class="align-center" src="../../_images/data114.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>In the <span class="guilabel">Reproject layer</span> dialog, select <code class="docutils literal notranslate"><span class="pre">Joined</span> <span class="pre">layer</span></code> as the <span class="guilabel">Input layer</span>. For the <span class="guilabel">Target CRS</span>, click the <span class="guilabel">Select CRS</span> button. Search for the <code class="docutils literal notranslate"><span class="pre">North_America_Albers_Equal_Area_Conic</span></code> CRS and select it. This is our final layer so we will save it to disk. Click the <span class="guilabel">…</span> button next to <span class="guilabel">Reprojected</span> and select <span class="guilabel">Save to File…</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data123.png" class="align-center" src="../../_images/data123.png" />
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>Voer als naam voor de laag in <code class="docutils literal notranslate"><span class="pre">us_states_with_population.gpkg</span></code> en selecteer <span class="guilabel">Opslaan</span>. Klik op <span class="guilabel">Uitvoeren</span> om het bestand GeoPackage met de opnieuw geprojecteerde gegevens te maken.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/data132.png" class="align-center" src="../../_images/data132.png" />
</div></blockquote>
<p>We zullen deze laag gebruiken in het volgende gedeelte. Voor het gemak kunt u direct een kopie van bovenstaande laag downloaden vanaf hieronder:</p>
<p><a class="reference external" href="https://www.qgistutorials.com/downloads/us_states_with_population.gpkg">us_states_with_population.gpkg</a></p>
<p>Gegevensbron <a class="reference internal" href="../credits.html#uscensus" id="id1"><span>[USCENSUS]</span></a></p>
</section>
<section id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Begin een nieuw project in QGIS. Lokaliseer het bestand <code class="docutils literal notranslate"><span class="pre">us_states_with_population.gpkg</span></code> in de <span class="guilabel">Browser</span> en vergroot het. Sleep de laag <code class="docutils literal notranslate"><span class="pre">us_states_with_population</span></code> in het lege kaartvenster en zet hem daar neer.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/140.png" class="align-center" src="../../_images/140.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>A new layer <code class="docutils literal notranslate"><span class="pre">us_states_with_population</span></code> will be added to the <span class="guilabel">Layers</span> panel. Right-click and select <span class="guilabel">Open Attribute Table</span>. For our cartogram, we need to use the population density as the variable. We will use the population values in the <code class="docutils literal notranslate"><span class="pre">POPESTIMATE2023</span></code> field. Close the attribute table.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/227.png" class="align-center" src="../../_images/227.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Search and locate the <span class="menuselection">Vector table ‣ Field calculator</span> algorithm from the Processing Toolbox. Double-click to open it.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/319.png" class="align-center" src="../../_images/319.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>In the <span class="guilabel">Field calculator</span> dialog, select <code class="docutils literal notranslate"><span class="pre">us_states_with_population</span></code> as the <span class="guilabel">Input layer</span>. Enter <code class="docutils literal notranslate"><span class="pre">density</span></code> as the <span class="guilabel">Field name</span>. Enter the following expression to compute the density. As the function <code class="docutils literal notranslate"><span class="pre">area(&#64;geometry)</span></code> calculates the area in the unit of the CRS (which is in meters), we apply the conversion factor to convert it to square kilometers. Click <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1000*1000* &quot;POPESTIMATE2023&quot; /
area(@geometry)
</pre></div>
</div>
<img alt="../../_images/48.png" class="align-center" src="../../_images/48.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Click the <span class="guilabel">…</span> button next to <span class="guilabel">Calculated</span> and select <span class="guilabel">Save to File…</span>. Enter the name of the layer as <code class="docutils literal notranslate"><span class="pre">us_states_population_density.gpkg</span></code> and select <span class="guilabel">Save</span>. Click <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/58.png" class="align-center" src="../../_images/58.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>A new layer <code class="docutils literal notranslate"><span class="pre">us_states_population_density</span></code> will be added to the <span class="guilabel">Layers</span> panel. Right-click and select <span class="guilabel">Open Attribute Table</span>. We need to pick an <strong>Anchor</strong> feature against which all other features will be scaled. Ideally you would pick the feature with the highest value of the variable you want to use for the cartogram. This will ensure there are no overlapping areas. Double-click the <span class="guilabel">density</span> column header to sort the table by density. You will notice that the highest density value in our dataset is quite large compared to other values and it belongs to a fairly small state. This will result all the features being scaled to very small sizes. We can pick the feature the second highest density which has a relatively large area and its density is comparable to other features.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/68.png" class="align-center" src="../../_images/68.png" />
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>In Area cartograms, the scale factor determines how much the feature’s area is reduced. We must reduce each feature’s area so that the population density of the feature is the same as the population density of the anchor feature. The formula for scale factor is the ratio of the square-root of the feature’s value against the square-root of the value of the anchor feature. Open the <span class="menuselection">Vector table ‣ Field calculator</span> algorithm from the Processing Toolbox. In the <span class="guilabel">Field calculator</span> dialog, select <code class="docutils literal notranslate"><span class="pre">us_states_population_density</span></code> as the <span class="guilabel">Input layer</span>. Enter <code class="docutils literal notranslate"><span class="pre">scale_factor</span></code> as the <span class="guilabel">Field name</span>. Enter the following expression to compute the scale factor. The expression calculates the ratio of the square root of the feature’s density against the square root of the density of the second largest density value. Click the <span class="guilabel">…</span> button next to <span class="guilabel">Calculated</span> and select <span class="guilabel">Save to File…</span>. Enter the name of the layer as <code class="docutils literal notranslate"><span class="pre">us_states_scale_factor.gpkg</span></code> and select <span class="guilabel">Save</span>. Click <span class="guilabel">Run</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sqrt(&quot;density&quot;)/array_get(array_agg(
   expression:=sqrt(&quot;density&quot;),
   order_by:=sqrt(&quot;density&quot;)), -2)
</pre></div>
</div>
<img alt="../../_images/78.png" class="align-center" src="../../_images/78.png" />
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>A new layer <code class="docutils literal notranslate"><span class="pre">us_states_scale_factor</span></code> will be added to the <span class="guilabel">Layers</span> panel. Right-click and select <span class="guilabel">Open Attribute Table</span>. The <code class="docutils literal notranslate"><span class="pre">scale_factor</span></code> field now contains the ratio by which each feature must be scaled to have the same population density as the anchor feature.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/88.png" class="align-center" src="../../_images/88.png" />
</div></blockquote>
<ol class="arabic simple" start="9">
<li><p>We only need the <code class="docutils literal notranslate"><span class="pre">us_states_scale_factor</span></code> layer for the final visualization. Select the remaining layers, right-click and select <span class="guilabel">Remove Layer</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/98.png" class="align-center" src="../../_images/98.png" />
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>Select the <code class="docutils literal notranslate"><span class="pre">us_states_scale_factor</span></code> layer and click the <span class="guilabel">Open the layer styling panel</span> button in the <span class="guilabel">Layers</span> panel. Select <span class="guilabel">Simple Fill</span> and open the drop-down selector for <span class="guilabel">Symbol layer type</span>. Set the <span class="guilabel">Symbol layer type</span> to <code class="docutils literal notranslate"><span class="pre">Outline:</span> <span class="pre">Simple</span> <span class="pre">Line</span></code> and select a <span class="guilabel">Color</span> of your choice. This symbol layer will be a reference for our map when we resize the polygons.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1012.png" class="align-center" src="../../_images/1012.png" />
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>Click the <span class="guilabel">Add Symbol layer (+)</span> button. A new symbol layer <span class="guilabel">Simple Fill</span> will be added. Set the <span class="guilabel">Fill color</span> to the same color as the lines and the <span class="guilabel">Stroke color</span> to be a slightly darker color.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1115.png" class="align-center" src="../../_images/1115.png" />
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>Next, open the drop-down selector for <span class="guilabel">Symbol layer type</span> and select <code class="docutils literal notranslate"><span class="pre">Geometry</span> <span class="pre">Generator</span></code> as the <span class="guilabel">Symbol layer type</span>. Geometry generator allows us to modify the geometry for rendering using expressions. Click the <span class="guilabel">Expression Builder</span> button.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1213.png" class="align-center" src="../../_images/1213.png" />
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>We will use the <cite>scale()</cite> function which resizes the given geometry by X- and Y-scaling factors. For our cartogram, we want to resize each polygon by the ratio of its population to the highest population. Enter the following expression to apply this scaling and click <span class="guilabel">OK</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>scale(
   @geometry,
   &quot;scale_factor&quot;,
   &quot;scale_factor&quot;,
   centroid(@geometry)
)
</pre></div>
</div>
<img alt="../../_images/1311.png" class="align-center" src="../../_images/1311.png" />
</div></blockquote>
<ol class="arabic simple" start="14">
<li><p>You will see the state polygons are now sized by the proportion of each state’s population to the highest population. Many large states with low population densities are now much smaller than their original size. You will notice that polygons with irregular shapes are off-center after being scaled. This is because the anchor point of the scaling is the centroid of the geometry which is often the representative point for the polygon. Let’s update our expression to fix this. Click the <span class="guilabel">Expression Builder</span> button.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/1410.png" class="align-center" src="../../_images/1410.png" />
</div></blockquote>
<ol class="arabic simple" start="15">
<li><p>De functie <cite>scale()</cite> kan een optionele parameter bevatten om het middelpunt van het op schaal brengen te specificeren. We zullen de functie <cite>pole_of_inaccessibility()</cite> gebruiken om een representatief ankerpunt te zoeken voor elke polygoon. Dat is soortgelijk aan een zwaartepunt, maar het ligt gegarandeerd binnen de polygoon, terwijl een zwaartepunt er buiten kan vallen voor bepaalde vormen. Werk de expressie bij zoals hieronder en klik op <span class="guilabel">OK</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>scale(
    @geometry,
    &quot;scale_factor&quot;,
    &quot;scale_factor&quot;,
    pole_of_inaccessibility(@geometry)
)
</pre></div>
</div>
<img alt="../../_images/1510.png" class="align-center" src="../../_images/1510.png" />
</div></blockquote>
<ol class="arabic simple" start="16">
<li><p>Nu zullen de op schaal gebrachte polygonen een veel betere plaatsing hebben. We zien echter ene ander probleem. Veel objecten op de laag zijn <strong>Multipolygonen</strong>, d.i. zij hebben meer dan een deel. Dergelijke objecten hebben 2 of meer delen die deel uitmaken van dezelfde geometrie. Met onze huidige expressie, worden beide op schaal gebracht met hetzelfde ankerpunt, dat wordt berekend uit de gecombineerde geometrie. Dit is niet ideaal. Bijvoorbeeld een groot object met meerdere eilanden zou zo op schaal moeten worden gebracht dat elk eiland op schaal wordt gebracht met zijn  eigen middelpunt. We werken, om dit op te lossen, onze expressie door over elk deel van de geometrie te lopen en het op schaal te brengen met zijn eigen middelpunt. Klik op de knop <span class="guilabel">Expressiebouwer</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/169.png" class="align-center" src="../../_images/169.png" />
</div></blockquote>
<ol class="arabic simple" start="17">
<li><p>Hier gebruiken we de functie <cite>array_foreach()</cite> om over elk deel van de geometrie te lopen en er op schaal gebrachte versies van te maken. Tenslotte combineert de functie <cite>collect_geometries()</cite> elk op schaal gebracht deel naar een enkele geometrie multipolygoon. Werk de expressie bij, zoals hieronder weergegeven, en klik op <span class="guilabel">OK</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>collect_geometries(
    array_foreach(generate_series(1, @geometry_part_count),
            scale(geometry_n(@geometry,@element),
                    &quot;scale_factor&quot;,
                    &quot;scale_factor&quot;,
pole_of_inaccessibility(geometry_n(@geometry,@element), 100)
            )
    )
)
</pre></div>
</div>
<img alt="../../_images/1710.png" class="align-center" src="../../_images/1710.png" />
</div></blockquote>
<ol class="arabic simple" start="18">
<li><p>The result is much better scaling for multi-part features.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/188.png" class="align-center" src="../../_images/188.png" />
</div></blockquote>
<ol class="arabic simple" start="19">
<li><p>Our cartogram is ready. This map shows concentration of the population on the eastern half of the US and a striking absence of population in states west of the Mississippi river.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/197.png" class="align-center" src="../../_images/197.png" />
</div></blockquote>
<ol class="arabic simple" start="20">
<li><p>We can make an improved visualization by creating an animation that slowly transforms the original rendering to the final size. Click the <span class="guilabel">Temporal Control Panel</span> button with the Clock icon in the <span class="guilabel">Map Navigation Toolbar</span>.  Select the <span class="guilabel">Animated temporal navigation</span> button.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/207.png" class="align-center" src="../../_images/207.png" />
</div></blockquote>
<ol class="arabic simple" start="21">
<li><p>The default <span class="guilabel">Animation range</span> will be populated with a 24-hour window in the increment of 1-hour. This is fine for our use case as we will get 24-frames of animation. You can adjust this if you want a slower/faster animation. Right-click the <code class="docutils literal notranslate"><span class="pre">us_states_with_population</span></code> layer and select <span class="guilabel">Properties</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/2112.png" class="align-center" src="../../_images/2112.png" />
</div></blockquote>
<ol class="arabic simple" start="22">
<li><p>Selecteer de tab <span class="guilabel">Tijdbeheer</span> en  schakel <span class="guilabel">Dynamisch Tijdbeheer</span> in. Deze laag zal worden bijgewerkt met een expressie dus dat hoeven we hier niet te configureren. Selecteer eenvoudigweg <code class="docutils literal notranslate"><span class="pre">Alleen</span> <span class="pre">laag</span> <span class="pre">opnieuw</span> <span class="pre">tekenen</span></code> zodat de laag wordt vernieuwd na elke tijdstap en gerenderd met de bijgewerkte waarden uit de expressie.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/228.png" class="align-center" src="../../_images/228.png" />
</div></blockquote>
<ol class="arabic simple" start="23">
<li><p>Laten we onze expressie van de Geometrie-generator bijwerken om de tijdstappen voor de animatie te gebruiken en gradueel de geometrie op schaal te brengen. Klik op de knop <span class="guilabel">Paneel Laag opmaken openen</span> in het paneel <span class="guilabel">Lagen</span>. Selecteer <span class="guilabel">Geometrie-generator</span>, gevolgd door de knop <span class="guilabel">Expressiebouwer</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/236.png" class="align-center" src="../../_images/236.png" />
</div></blockquote>
<ol class="arabic simple" start="24">
<li><p>Here we want to start with a scale factor of 1 and end up with the final scale factor value for the feature in the field <code class="docutils literal notranslate"><span class="pre">scale_factor</span></code>. We use the <cite>scale_linear()</cite> function which takes the time of the current time-step and calculates the scale factor using the start and end times. Update the expression as shown below and click <span class="guilabel">OK</span>.</p></li>
</ol>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>collect_geometries(
    array_foreach(generate_series(1, @geometry_part_count),
            scale(geometry_n(@geometry,@element),
                    scale_linear(
                            epoch(@map_start_time),
                            epoch(@animation_start_time),
                            epoch(@animation_end_time),
                            1,
                            &quot;scale_factor&quot;),
                    scale_linear(
                            epoch(@map_start_time),
                            epoch(@animation_start_time),
                            epoch(@animation_end_time),
                            1,
                            &quot;scale_factor&quot;),
pole_of_inaccessibility(geometry_n(@geometry,@element), 100)
            )
    )
)
</pre></div>
</div>
<img alt="../../_images/247.png" class="align-center" src="../../_images/247.png" />
</div></blockquote>
<ol class="arabic simple" start="25">
<li><p>Back in the <span class="guilabel">Temporal Controller</span> panel, click the <span class="guilabel">Play</span> button to see the animation. You should see the shape of each polygon gradually scaled after each frame.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/257.png" class="align-center" src="../../_images/257.png" />
</div></blockquote>
<ol class="arabic simple" start="26">
<li><p>Als u tevreden bent met de configuratie, kunnen we de animatie exporteren. Klik op de knop <span class="guilabel">Animatie exporteren</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/266.png" class="align-center" src="../../_images/266.png" />
</div></blockquote>
<ol class="arabic simple" start="27">
<li><p>In het dialoogvenster <span class="guilabel">Animatie van kaart exporteren</span>, klik op <span class="guilabel">…</span> naast <span class="guilabel">Map voor uitvoer</span> en blader naar een map op uw computer. Behoud alle andere opties op hun standaard waarden en klik op <span class="guilabel">Opslaan</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/277.png" class="align-center" src="../../_images/277.png" />
</div></blockquote>
<ol class="arabic simple" start="28">
<li><p>De individuele frames van de animatie zullen als afbeeldingen worden geëxporteerd. We kunnen een video of geanimeerde GIF maken met deze frames. Ik raad aan om de website ezgif.com te gebruiken die u in staat stelt gemakkelijk GIF’s te maken uit individuele afbeeldingen. Bezoek <a class="reference external" href="https://ezgif.com/maker">Ezgif Animated GIF Maker</a>. Blader naar de geëxporteerde frames van de animatie en klik op <span class="guilabel">Upload files!</span>.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/287.png" class="align-center" src="../../_images/287.png" />
</div></blockquote>
<ol class="arabic simple" start="29">
<li><p>Configureer de opties voor de GIF door <span class="guilabel">Delay time</span> in te stellen op <code class="docutils literal notranslate"><span class="pre">5</span></code>. Selecteer het effect <span class="guilabel">crossfade frames</span> en stel <span class="guilabel">Fader delay</span> en <span class="guilabel">Fader count</span> in op <code class="docutils literal notranslate"><span class="pre">2</span></code>. Klik op <span class="guilabel">Make a GIF!</span>/</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/296.png" class="align-center" src="../../_images/296.png" />
</div></blockquote>
<ol class="arabic simple" start="30">
<li><p>Klik op de knop <span class="guilabel">save</span> om de animatie als een GIF-bestand te downloaden.</p></li>
</ol>
<blockquote>
<div><img alt="../../_images/output.gif" class="align-center" src="../../_images/output.gif" />
<img alt="../../_images/hawaii.gif" class="align-center" src="../../_images/hawaii.gif" />
<img alt="../../_images/alaska.gif" class="align-center" src="../../_images/alaska.gif" />
</div></blockquote>
</section>
</section>





  <!-- Comment Section Powered by utterances -->
<div id="comments">
  <hr />
  <p>If you want to give feedback or share your experience with this tutorial, please comment below. (requires GitHub account)</p>
<script src="https://utteranc.es/client.js"
        repo="spatialthoughts/qgis-tutorials"
        issue-term="title"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2023, Ujaval Gandhi.<br/>
      Laatste aanpassing op aug 18, 2024.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6.<br/>
    </p>
  </div>
</footer>
<div class="container">
  <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/deed.en_US">Creative Commons Attribution 4.0 International License</a></p>
</div>
<!-- Twitter Button -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Disqus comments widget -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'qgistutorials'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

<script type="text/javascript">
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<!-- Script fpr language switching. Largely adapted from https://github.com/pcav/faunalia-website -->
<script>
    var currentPage = 'docs/3/cartogram_animation.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    $(document).ready(function(){

        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is a index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }

        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave 

        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('You hit an error, please report back to us.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>

  </body>
</html>